{
    "type": "bundle",
    "id": "bundle--f0a5635b-bbdf-476f-8540-12af43255b70",
    "spec_version": "2.0",
    "objects": [
        {   "primary_motivation": "dominance",
            "first_seen":"2015",
            "x_MISP-description": "Adversaries abusing ICS (based on Dragos Inc adversary list).\nThis threat actor targets industrial control systems in Turkey, Europe, and North America.\n    Believed to be linked to Crouching Yeti",
            "x_MISP-uuid": "a08ab076-33c1-4350-b021-650c34277f2d",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "intrusion-set",
            "name": "Dragonfly 2.0",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) is a suspected Russian group that has targeted government entities and multiple U.S. critical infrastructure sectors since at least December 2015. (Citation: US-CERT TA18-074A) (Citation: Symantec Dragonfly Sept 2017) There is debate over the extent of overlap between [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) and [Dragonfly](https://attack.mitre.org/groups/G0035), but there is sufficient evidence to lead to these being tracked as two separate groups. (Citation: Fortune Dragonfly 2.0 Sept 2017)(Citation: Dragos DYMALLOY )",
            "x_mitre_version": "2.1",
            "modified": "2022-06-11T20:10:32.917Z",
            "aliases": [
                "Dragonfly 2.0",
                "IRON LIBERTY",
                "Dragonfly2",
                "DYMALLOY",
                "Berserk Bear"
            ],
            "created": "2018-10-17T00:14:20.652Z",
           "created_by_ref": "identity--cb4d3609-6db8-40ec-817d-43d0982b9130",
            "id": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/groups/G0074",
                    "external_id": "G0074",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: US-CERT TA18-074A) (Citation: Symantec Dragonfly Sept 2017) (Citation: Fortune Dragonfly 2.0 Sept 2017)",
                    "source_name": "Dragonfly 2.0"
                },
                {
                    "description": "(Citation: Secureworks MCMD July 2019)(Citation: Secureworks IRON LIBERTY)",
                    "source_name": "IRON LIBERTY"
                },
                {
                    "description": "(Citation: Dragos DYMALLOY )",
                    "source_name": "DYMALLOY"
                },
                {
                    "description": "(Citation: Fortune Dragonfly 2.0 Sept 2017)",
                    "source_name": "Berserk Bear"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group",
                    "description": "Symantec Security Response. (2017, September 6). Dragonfly: Western energy sector targeted by sophisticated attack group. Retrieved September 9, 2017.",
                    "source_name": "Symantec Dragonfly Sept 2017"
                },
                {
                    "url": "http://fortune.com/2017/09/06/hack-energy-grid-symantec/",
                    "description": "Hackett, R. (2017, September 6). Hackers Have Penetrated Energy Grid, Symantec Warns. Retrieved June 6, 2018.",
                    "source_name": "Fortune Dragonfly 2.0 Sept 2017"
                },
                {
                    "url": "https://www.dragos.com/threat/dymalloy/",
                    "description": "Dragos. (n.d.). DYMALLOY. Retrieved August 20, 2020.",
                    "source_name": "Dragos DYMALLOY "
                },
                {
                    "url": "https://www.secureworks.com/research/mcmd-malware-analysis",
                    "description": "Secureworks. (2019, July 24). MCMD Malware Analysis. Retrieved August 13, 2020.",
                    "source_name": "Secureworks MCMD July 2019"
                },
                {
                    "url": "https://www.secureworks.com/research/threat-profiles/iron-liberty",
                    "description": "Secureworks. (n.d.). IRON LIBERTY. Retrieved October 15, 2020.",
                    "source_name": "Secureworks IRON LIBERTY"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--0bd48ff5-c1f7-48f4-8057-aad487b25575",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) accessed email accounts using Outlook Web Access.(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a",
            "modified": "2020-03-17T16:21:07.531Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--1da542f3-0003-4eb7-9bb6-1bd3cced9763",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with Microsoft Office attachments to target victims.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
            "modified": "2019-03-22T20:13:49.622Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--2d3fea03-c3a4-414c-8827-8f0416b1f88d",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb",
            "modified": "2020-01-10T15:10:25.182Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--3fffa7b5-6797-4d99-96e4-a50db0e8810c",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including batch scripts.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62",
            "modified": "2020-03-19T17:49:53.503Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--4c1e067a-0644-4142-8111-c1acdc8c1625",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) moved laterally via RDP.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf",
            "modified": "2019-03-22T20:13:49.615Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--6b6343a9-0679-4fa7-943f-c9a2b9df55e2",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compressed data into .zip files prior to exfiltrating it.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--53ac20cd-aca3-406e-9aa0-9fc7fdc60a5a",
            "modified": "2020-03-30T02:12:44.255Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--6db4aabc-a2ed-4db2-8ecb-c9ca11dc8f46",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--4ab929c6-ee2d-4fb5-aab4-b14be2ed7179",
            "modified": "2019-03-22T20:13:49.568Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--6e422de0-d8c4-41f8-acdd-d433e14e32a3",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created a directory named \"out\" in the user's %AppData% folder and copied files to it.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--1c34f7aa-9341-4a48-bfab-af22e51aca6c",
            "modified": "2020-03-16T23:41:13.382Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--7af4c9fb-72c2-437e-b0f2-caf3f07d493b",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB for C2.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6",
            "modified": "2019-03-22T20:13:49.303Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8e4dd84f-e96f-4f5c-81aa-9827fd5abb06",
            "description": "(Citation: US-CERT TA18-074A)",
            "target_ref": "tool--c4810609-7da6-48ec-8057-1b70a7814db0",
            "modified": "2020-07-29T20:19:10.618Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-07-29T20:19:10.618Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8f648221-38fe-4c81-b6d6-d41c398ff870",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
            "modified": "2020-03-28T21:26:06.859Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--28b125cf-ff1a-4798-8b8a-3724d052e848",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added the registry value ntdll to the Registry Run key to establish persistence.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279",
            "modified": "2019-03-22T20:13:49.627Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--35e47be3-2a31-401f-ad65-a2fa34f861f1",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) queried the Registry to identify victim information.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896",
            "modified": "2019-03-22T20:13:49.510Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--55da48f1-79ee-44b7-af90-175622c411a8",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) copied and installed tools for operations once in the victim environment.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add",
            "modified": "2019-03-22T20:13:49.572Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--61e11940-0a88-48c8-8532-e57b5bb6bdb6",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) likely obtained a list of hosts in the victim environment.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735",
            "modified": "2019-03-22T20:13:49.453Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--79eff26b-058c-4a5c-ac7a-f6e6c778d934",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used the command <code>query user</code> on victim hosts.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104",
            "modified": "2019-03-22T20:13:49.667Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--82e1ab81-89f9-4d96-87fd-69d04c6710f3",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used a batch script to gather folder and file names from victim hosts.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18",
            "modified": "2019-03-22T20:13:49.460Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--87f59d5f-cfda-4e5a-aa0d-6a7cb395528b",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open attachments.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e",
            "modified": "2020-03-17T14:14:37.025Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--120ab07d-b167-4548-9e02-d241ccea8f02",
            "description": "(Citation: US-CERT TA18-074A)",
            "target_ref": "tool--5a63f900-5e7e-4928-a746-dd4558e1df71",
            "modified": "2019-03-22T20:13:49.668Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--206a6a93-9858-4f0b-b389-af1c28502118",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--1644e709-12d2-41e5-a60f-3470991f5011",
            "modified": "2020-03-25T16:00:35.796Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "source_name": "US-CERT APT Energy Oct 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--497e4571-ac4f-4e6b-b303-e28be3b2e002",
            "description": "(Citation: Secureworks MCMD July 2019)",
            "target_ref": "tool--975737f1-b10d-476f-8bda-3ec26ea57172",
            "modified": "2020-08-20T14:54:30.537Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-08-20T14:54:30.537Z",
            "external_references": [
                {
                    "url": "https://www.secureworks.com/research/mcmd-malware-analysis",
                    "description": "Secureworks. (2019, July 24). MCMD Malware Analysis. Retrieved August 13, 2020.",
                    "source_name": "Secureworks MCMD July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--558d3835-3bcc-4c07-92b1-626a89d79e76",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts disguised as legitimate backup and service accounts as well as an email administration account.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0",
            "modified": "2019-03-22T20:13:49.252Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--632e3144-8785-41c4-a937-7e11139b2ae1",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--6495ae23-3ab4-43c5-a94f-5638a2c31fd2",
            "modified": "2020-03-28T20:12:45.077Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--731acc34-e9c3-4953-a743-7941bc73c0d2",
            "description": "(Citation: US-CERT TA18-074A)",
            "target_ref": "tool--03342581-f790-4f03-ba41-e82e67392e23",
            "modified": "2019-03-22T20:13:49.675Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--1873b22f-d779-490c-8dce-e5d5167da619",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open links.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9",
            "modified": "2020-03-17T14:14:36.933Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-17T14:14:36.933Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "source_name": "US-CERT APT Energy Oct 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--08319de4-6faa-4fb8-825e-0baee4a4b510",
            "description": "(Citation: US-CERT TA18-074A)",
            "target_ref": "tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f",
            "modified": "2019-03-22T20:13:49.676Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--9723e536-1491-45a4-8dc7-716e4d7df7dc",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) collected data from local victim systems.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5",
            "modified": "2019-03-22T20:13:49.515Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--41354e6e-8250-43f9-864a-80c05dfb4443",
            "description": "(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)",
            "target_ref": "tool--26c87906-d750-42c5-946c-d4162c73fc7b",
            "modified": "2019-03-22T20:13:49.665Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-01-31T01:41:58.450Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                },
                {
                    "url": "https://www.coresecurity.com/corelabs-research/open-source-tools/impacket",
                    "description": "Core Security. (n.d.). Impacket. Retrieved November 2, 2017.",
                    "source_name": "Core Security Impacket"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--41590e53-8d15-4924-bfd7-850f7b3f23ea",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added newly created accounts to the administrators group to maintain elevated access.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27",
            "modified": "2019-03-22T20:13:49.664Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--49455f19-b4da-401f-8f61-93965f5a1850",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to perform multiple techniques through the use of [Reg](https://attack.mitre.org/software/S0075).(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4",
            "modified": "2019-03-22T20:13:49.340Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--79672f1b-d7a9-494e-9c0b-82eadb88389a",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f",
            "modified": "2019-03-22T20:13:49.462Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--98159d54-7ae3-4426-b879-271fbb420b8e",
            "description": "(Citation: Symantec Dragonfly Sept 2017)(Citation: Secureworks Karagany July 2019)",
            "target_ref": "malware--82cb34ba-02b5-432b-b2d2-07f55cbf674d",
            "modified": "2020-08-20T14:41:26.722Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-08-20T14:41:26.722Z",
            "external_references": [
                {
                    "url": "https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group",
                    "description": "Symantec Security Response. (2017, September 6). Dragonfly: Western energy sector targeted by sophisticated attack group. Retrieved September 9, 2017.",
                    "source_name": "Symantec Dragonfly Sept 2017"
                },
                {
                    "url": "https://www.secureworks.com/research/updated-karagany-malware-targets-energy-sector",
                    "description": "Secureworks. (2019, July 24). Updated Karagany Malware Targets Energy Sector. Retrieved August 12, 2020.",
                    "source_name": "Secureworks Karagany July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--204159d6-7f4a-4e0f-b492-974a776af423",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used PowerShell scripts for execution.(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
            "modified": "2019-03-22T20:13:49.619Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group",
                    "description": "Symantec Security Response. (2017, September 6). Dragonfly: Western energy sector targeted by sophisticated attack group. Retrieved September 9, 2017.",
                    "source_name": "Symantec Dragonfly Sept 2017"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--319189e0-9db0-46f8-9386-0d909db94a46",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate network information, including information about trusts, zones, and the domain.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
            "modified": "2019-03-22T20:13:49.562Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--2344234d-d1e3-433f-a43b-0225b4e4889c",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--dc31fe1e-d722-49da-8f5f-92c7b5aff534",
            "modified": "2019-03-22T20:13:49.376Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a5dda6bc-4697-4e2e-8207-85e9f0d05d43",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e",
            "modified": "2019-03-22T20:13:49.670Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a581ef45-9363-4fdc-b0ff-20436eaffaab",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c",
            "modified": "2019-03-22T20:13:49.557Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b0bfd6bc-95fd-4587-8d2d-2d40c3c25ba0",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate users on a victim domain controller.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af",
            "modified": "2020-03-18T19:44:07.766Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b2f72ecc-7498-4b16-b674-65ecc9807e3f",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1",
            "modified": "2020-03-19T17:49:53.335Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T17:49:53.335Z",
            "external_references": [
                {
                    "source_name": "US-CERT TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "source_name": "US-CERT APT Energy Oct 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b5c97349-c288-43f8-9bcc-09491d0c66f5",
            "description": "(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)",
            "target_ref": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db",
            "modified": "2019-03-22T20:13:49.673Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group",
                    "description": "Symantec Security Response. (2017, September 6). Dragonfly: Western energy sector targeted by sophisticated attack group. Retrieved September 9, 2017.",
                    "source_name": "Symantec Dragonfly Sept 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b75c08e0-4d11-46dc-a582-ca496352bb1c",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed tools used for password cracking, including Hydra and [CrackMapExec](https://attack.mitre.org/software/S0488).(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Kali Hydra)",
            "target_ref": "attack-pattern--1d24cdee-9ea2-4189-b08e-af110bf2435d",
            "modified": "2020-07-29T20:31:24.104Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                },
                {
                    "url": "https://tools.kali.org/password-attacks/hydra",
                    "description": "Kali. (2014, February 18). THC-Hydra. Retrieved November 2, 2017.",
                    "source_name": "Kali Hydra"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--cb046be9-87c4-4dbd-b01f-9771aa4f2552",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--b77cf5f3-6060-475d-bd60-40ccbf28fdc2",
            "modified": "2019-03-22T20:13:49.516Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d1adaa26-90e3-4a7f-af07-577b3003be4c",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil).(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)",
            "target_ref": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688",
            "modified": "2019-03-22T20:13:49.518Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group",
                    "description": "Symantec Security Response. (2017, September 6). Dragonfly: Western energy sector targeted by sophisticated attack group. Retrieved September 9, 2017.",
                    "source_name": "Symantec Dragonfly Sept 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d164d443-6298-47eb-b767-8f1136f6b6b5",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used command line for execution.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830",
            "modified": "2019-03-22T20:13:49.301Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d848b82c-1b72-4054-b4c1-f31d6d09af6c",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate administrators and users in the domain.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c",
            "modified": "2020-03-18T20:00:35.578Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--dbbc2e8f-312f-4807-abe5-3c6858f9d0e2",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to hide create user accounts. (Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--8c4aef43-48d5-49aa-b2af-c0cd58d30c3d",
            "modified": "2021-10-14T20:07:02.731Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-10-01T19:13:05.847Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e9560ef6-7ed4-45bd-be7c-525f6708308e",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has disabled host-based firewalls. The group has also globally opened port 3389.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b",
            "modified": "2020-03-28T00:23:24.364Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--ec9f39cb-19a2-4134-a16a-ea263e958762",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)",
            "target_ref": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
            "modified": "2020-03-19T22:46:23.486Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T22:46:23.486Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "source_name": "US-CERT APT Energy Oct 2017"
                },
                {
                    "source_name": "Core Security Impacket",
                    "description": "Core Security. (n.d.). Impacket. Retrieved November 2, 2017.",
                    "url": "https://www.coresecurity.com/corelabs-research/open-source-tools/impacket"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--ee9d56a1-ec92-459c-bd3e-7fc9f52f628d",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d",
            "modified": "2019-03-22T20:13:49.629Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--f2d272fe-ee0e-44da-a658-83b970cde1d6",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes. They also obtained ntds.dit from domain controllers. (Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)",
            "target_ref": "attack-pattern--edf91964-b26e-4b4a-9600-ccacd7d7df24",
            "modified": "2020-03-25T15:23:50.051Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T22:46:23.468Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "source_name": "US-CERT APT Energy Oct 2017"
                },
                {
                    "source_name": "Core Security Impacket",
                    "description": "Core Security. (n.d.). Impacket. Retrieved November 2, 2017.",
                    "url": "https://www.coresecurity.com/corelabs-research/open-source-tools/impacket"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--f4ab77d2-1227-46ac-a4be-f8078072dac7",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised user credentials and used valid accounts for operations.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81",
            "modified": "2019-03-22T20:13:49.451Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--f67c1df3-9a03-456e-9de9-74a2ac3a2061",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)",
            "target_ref": "attack-pattern--635cbe30-392d-4e27-978e-66774357c762",
            "modified": "2020-02-11T15:53:07.865Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--f993e545-2d09-48c1-9b82-110ab798bdcf",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised legitimate organizations' websites to create watering holes to compromise victims.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6",
            "modified": "2019-03-22T20:13:49.413Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--f9906a11-8ac7-4bd4-9c28-c58834ff593b",
            "description": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites.(Citation: US-CERT TA18-074A)",
            "target_ref": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
            "modified": "2019-03-22T20:13:49.623Z",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Domain Account",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-10-13T14:05:14.784Z",
            "created": "2020-02-21T21:08:26.480Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af",
            "description": "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior.\n\nCommands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code>on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1087/002",
                    "external_id": "T1087.002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/575.html",
                    "external_id": "CAPEC-575",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Account Manipulation",
            "x_mitre_data_sources": [
                "File: File Modification",
                "Command: Command Execution",
                "Process: Process Creation",
                "Group: Group Modification",
                "User Account: User Account Modification",
                "Active Directory: Active Directory Object Modification"
            ],
            "x_mitre_version": "2.2",
            "modified": "2021-10-18T18:57:04.505Z",
            "created": "2017-05-31T21:31:12.196Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_platforms": [
                "Windows",
                "Azure AD",
                "Office 365",
                "IaaS",
                "Linux",
                "macOS",
                "Google Workspace"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27",
            "description": "Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.",
            "x_mitre_contributors": [
                "Jannie Li, Microsoft Threat Intelligence\u202fCenter\u202f(MSTIC)",
                "Praetorian",
                "Tim MalcomVetter"
            ],
            "x_mitre_detection": "Collect events that correlate with changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670.(Citation: Microsoft User Modified Event)(Citation: Microsoft Security Event 4670)(Citation: Microsoft Security Event 4670) Monitor for modification of accounts in correlation with other suspicious activity. Changes may occur at unusual times or from unusual systems. Especially flag events where the subject and target accounts differ(Citation: InsiderThreat ChangeNTLM July 2017) or that include additional flags such as changing a password without knowledge of the old password.(Citation: GitHub Mimikatz Issue 92 June 2017)\n\nMonitor for use of credentials at unusual times or to unusual systems or services. This may also correlate with other suspicious activity.\n\nMonitor for unusual permissions changes that may indicate excessively broad permissions being granted to compromised accounts.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1098",
                    "external_id": "T1098",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4738",
                    "description": "Lich, B., Miroshnikov, A. (2017, April 5). 4738(S): A user account was changed. Retrieved June 30, 2017.",
                    "source_name": "Microsoft User Modified Event"
                },
                {
                    "source_name": "Microsoft Security Event 4670",
                    "description": "Franklin Smith, R. (n.d.). Windows Security Log Event ID 4670. Retrieved November 4, 2019.",
                    "url": "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4670"
                },
                {
                    "source_name": "InsiderThreat ChangeNTLM July 2017",
                    "description": "Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017.",
                    "url": "https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM"
                },
                {
                    "source_name": "GitHub Mimikatz Issue 92 June 2017",
                    "description": "Warren, J. (2017, June 22). lsadump::changentlm and lsadump::setntlm work, but generate Windows events #92. Retrieved December 4, 2017.",
                    "url": "https://github.com/gentilkiwi/mimikatz/issues/92"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-10-21T16:35:45.986Z",
            "name": "Application Layer Protocol",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1071",
                    "external_id": "T1071",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ],
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "2.0",
            "created": "2017-05-31T21:30:56.776Z",
            "x_mitre_network_requirements": true,
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6",
            "description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nAdversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Archive Collected Data",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "File: File Creation",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-10-21T16:36:55.831Z",
            "created": "2020-02-20T20:53:45.725Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--53ac20cd-aca3-406e-9aa0-9fc7fdc60a5a",
            "description": "An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network. Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender.\n\nBoth compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Archival software and archived files can be detected in many ways. Common utilities that may be present on the system or brought in by an adversary may be detectable through process monitoring and monitoring for command-line arguments for known archival utilities. This may yield a significant number of benign events, depending on how systems in the environment are typically used.\n\nA process that loads the Windows DLL crypt32.dll may be used to perform encryption, decryption, or verification of file signatures.\n\nConsider detecting writing of files with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.(Citation: Wikipedia File Header Signatures)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1560",
                    "external_id": "T1560",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Wikipedia File Header Signatures",
                    "description": "Wikipedia. (2016, March 31). List of file signatures. Retrieved April 22, 2016.",
                    "url": "https://en.wikipedia.org/wiki/List_of_file_signatures"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-01-06T18:36:29.226Z",
            "name": "Registry Run Keys / Startup Folder",
            "x_mitre_data_sources": [
                "Windows Registry: Windows Registry Key Creation",
                "Windows Registry: Windows Registry Key Modification",
                "File: File Modification",
                "Command: Command Execution",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.1",
            "created": "2020-01-23T22:02:48.566Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_permissions_required": [
                "Administrator",
                "User"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--9efb1ea7-c37b-4595-9640-b7680cd84279",
            "description": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) These programs will be executed under the context of the user and will have the account's associated permissions level.\n\nPlacing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\\Users\\\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</code>. The startup folder path for all users is <code>C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp</code>.\n\nThe following run keys are created by default on Windows systems:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce</code>\n\nRun keys may exist under multiple hives.(Citation: Microsoft Wow6432Node 2018)(Citation: Malwarebytes Wow6432Node 2016) The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency. (Citation: Microsoft RunOnceEx APR 2018) For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: <code>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\"</code> (Citation: Oddvar Moe RunOnceEx Mar 2018)\n\nThe following Registry keys can be used to set startup folder items for persistence:\n\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders</code>\n* <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders</code>\n\nThe following Registry keys can control automatic startup of services during boot:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce</code>\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunServices</code>\n\nUsing policy settings to specify startup programs creates corresponding values in either of two Registry keys:\n\n* <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n* <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run</code>\n\nThe Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</code> and <code>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code> subkeys can automatically launch programs.\n\nPrograms listed in the load value of the registry key <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows</code> run when any user logs on.\n\nBy default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use [Masquerading](https://attack.mitre.org/techniques/T1036) to make the Registry entries look as if they are associated with legitimate programs.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Oddvar Moe, @oddvarmoe"
            ],
            "x_mitre_detection": "Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Monitor the start folder for additions or changes. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations and startup folders. (Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.\n\nChanges to these locations typically happen under normal conditions when legitimate software is installed. To increase confidence of malicious activity, data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1547/001",
                    "external_id": "T1547.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/270.html",
                    "external_id": "CAPEC-270",
                    "source_name": "capec"
                },
                {
                    "source_name": "Microsoft Run Key",
                    "description": "Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014.",
                    "url": "http://msdn.microsoft.com/en-us/library/aa376977"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/win32/sysinfo/32-bit-and-64-bit-application-data-in-the-registry",
                    "description": "Microsoft. (2018, May 31). 32-bit and 64-bit Application Data in the Registry. Retrieved August 3, 2020.",
                    "source_name": "Microsoft Wow6432Node 2018"
                },
                {
                    "url": "https://blog.malwarebytes.com/cybercrime/2013/10/hiding-in-plain-sight/",
                    "description": "Arntz, P. (2016, March 30). Hiding in Plain Sight. Retrieved August 3, 2020.",
                    "source_name": "Malwarebytes Wow6432Node 2016"
                },
                {
                    "source_name": "Microsoft RunOnceEx APR 2018",
                    "description": "Microsoft. (2018, August 20). Description of the RunOnceEx Registry Key. Retrieved June 29, 2018.",
                    "url": "https://support.microsoft.com/help/310593/description-of-the-runonceex-registry-key"
                },
                {
                    "source_name": "Oddvar Moe RunOnceEx Mar 2018",
                    "description": "Moe, O. (2018, March 21). Persistence using RunOnceEx - Hidden from Autoruns.exe. Retrieved June 29, 2018.",
                    "url": "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
                },
                {
                    "source_name": "TechNet Autoruns",
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Shortcut Modification",
            "x_mitre_data_sources": [
                "File: File Creation",
                "File: File Modification",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-04-13T21:30:24.555Z",
            "created": "2020-01-24T19:00:32.917Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                }
            ],
            "id": "attack-pattern--4ab929c6-ee2d-4fb5-aab4-b14be2ed7179",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator",
                "User"
            ],
            "description": "Adversaries may create or edit shortcuts to run a program during system boot or user login. Shortcuts or symbolic links are ways of referencing other files or programs that will be opened or executed when the shortcut is clicked or executed by a system startup process.\n\nAdversaries could use shortcuts to execute their tools for persistence. They may create a new shortcut as a means of indirection that may use [Masquerading](https://attack.mitre.org/techniques/T1036) to look like a legitimate program. Adversaries could also edit the target path or entirely replace an existing shortcut so their tools will be executed instead of the intended legitimate program.",
            "x_mitre_contributors": [
                "David French, Elastic",
                "Bobby, Filar, Elastic",
                "Travis Smith, Tripwire"
            ],
            "x_mitre_detection": "Since a shortcut's target path likely will not change, modifications to shortcut files that do not correlate with known software changes, patches, removal, etc., may be suspicious. Analysis should attempt to relate shortcut file change or creation events to other potentially suspicious events based on known adversary behavior such as process launches of unknown executables that make network connections.\n\nMonitor for LNK files created with a Zone Identifier value greater than 1, which may indicate that the LNK file originated from outside of the network.(Citation: BSidesSLC 2020 - LNK Elastic)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1547/009",
                    "external_id": "T1547.009",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/132.html",
                    "external_id": "CAPEC-132",
                    "source_name": "capec"
                },
                {
                    "url": "https://www.youtube.com/watch?v=nJ0UsyiUEqQ",
                    "description": "French, D., Filar, B.. (2020, March 21). A Chain Is No Stronger Than Its Weakest LNK. Retrieved November 30, 2020.",
                    "source_name": "BSidesSLC 2020 - LNK Elastic"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Password Cracking",
            "x_mitre_data_sources": [
                "User Account: User Account Authentication",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-09-16T15:39:59.041Z",
            "created": "2020-02-11T18:38:56.197Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Office 365",
                "Azure AD"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--1d24cdee-9ea2-4189-b08e-af110bf2435d",
            "description": "Adversaries may use password cracking to attempt to recover usable credentials, such as plaintext passwords, when credential material such as password hashes are obtained. [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) is used to obtain password hashes, this may only get an adversary so far when [Pass the Hash](https://attack.mitre.org/techniques/T1550/002) is not an option. Techniques to systematically guess the passwords used to compute hashes are available, or the adversary may use a pre-computed rainbow table to crack hashes. Cracking hashes is usually done on adversary-controlled systems outside of the target network.(Citation: Wikipedia Password cracking) The resulting plaintext password resulting from a successfully cracked hash may be used to log into systems, resources, and services in which the account has access.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_detection": "It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network. Consider focusing efforts on detecting other adversary behavior used to acquire credential materials, such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or [Kerberoasting](https://attack.mitre.org/techniques/T1558/003).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1110/002",
                    "external_id": "T1110.002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/55.html",
                    "external_id": "CAPEC-55",
                    "source_name": "capec"
                },
                {
                    "source_name": "Wikipedia Password cracking",
                    "description": "Wikipedia. (n.d.). Password cracking. Retrieved December 23, 2015.",
                    "url": "https://en.wikipedia.org/wiki/Password_cracking"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Command and Scripting Interpreter",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation",
                "Module: Module Load",
                "Script: Script Execution"
            ],
            "x_mitre_version": "2.2",
            "modified": "2021-08-16T21:03:21.700Z",
            "created": "2017-05-31T21:30:49.546Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "id": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830",
            "revoked": false,
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Network"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nThere are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).\n\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.\n\nIf scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059",
                    "external_id": "T1059",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.1",
                    "description": "Microsoft. (2020, August 21). Running Remote Commands. Retrieved July 26, 2021.",
                    "source_name": "Powershell Remote Commands"
                },
                {
                    "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#23",
                    "description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Command History. Retrieved October 21, 2020.",
                    "source_name": "Cisco IOS Software Integrity Assurance - Command History"
                },
                {
                    "url": "https://www.thepythoncode.com/article/executing-bash-commands-remotely-in-python",
                    "description": "Abdou Rockikz. (2020, July). How to Execute Shell Commands in a Remote Machine in Python. Retrieved July 26, 2021.",
                    "source_name": "Remote Shell Execution in Python"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-05-28T14:56:23.748Z",
            "name": "PowerShell",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Module: Module Load",
                "Process: Process Creation",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.1",
            "created": "2020-03-09T13:48:55.078Z",
            "x_mitre_contributors": [
                "Praetorian"
            ],
            "id": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).\n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features.(Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/001",
                    "external_id": "T1059.001",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "TechNet PowerShell",
                    "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016.",
                    "url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx"
                },
                {
                    "source_name": "Github PSAttack",
                    "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016.",
                    "url": "https://github.com/jaredhaight/PSAttack"
                },
                {
                    "url": "http://www.sixdub.net/?p=367",
                    "description": "Warner, J.. (2015, January 6). Inexorable PowerShell \u2013 A Red Teamer\u2019s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018.",
                    "source_name": "Sixdub PowerPick Jan 2016"
                },
                {
                    "url": "https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/",
                    "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018.",
                    "source_name": "SilentBreak Offensive PS Dec 2015"
                },
                {
                    "url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/",
                    "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019.",
                    "source_name": "Microsoft PSfromCsharp APR 2014"
                },
                {
                    "source_name": "Malware Archaeology PowerShell Cheat Sheet",
                    "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016.",
                    "url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf"
                },
                {
                    "source_name": "FireEye PowerShell Logging 2016",
                    "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016.",
                    "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-07-26T17:13:07.345Z",
            "name": "Windows Command Shell",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.2",
            "created": "2020-03-09T14:12:31.196Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62",
            "description": "Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows)\n\nBatch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.\n\nAdversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Usage of the Windows command shell may be common on administrator, developer, or power user systems depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/003",
                    "external_id": "T1059.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/terminal/tutorials/ssh",
                    "description": "Microsoft. (2020, May 19). Tutorial: SSH in Windows Terminal. Retrieved July 26, 2021.",
                    "source_name": "SSH in Windows"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Python",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/006",
                    "external_id": "T1059.006",
                    "source_name": "mitre-attack"
                }
            ],
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-07-26T22:49:23.094Z",
            "x_mitre_system_requirements": [
                "Python is installed."
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "id": "attack-pattern--cc3502b5-30cc-4473-ad48-42d51a6ef6d1",
            "x_mitre_platforms": [
                "Linux",
                "Windows",
                "macOS"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator",
                "SYSTEM",
                "root"
            ],
            "description": "Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables.\n\nPython comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.",
            "x_mitre_remote_support": false,
            "x_mitre_detection": "Monitor systems for abnormal Python usage and python.exe behavior, which could be an indicator of malicious activity. Understanding standard usage patterns is important to avoid a high number of false positives. If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
            "created": "2020-03-09T14:38:24.334Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Local Account",
            "x_mitre_data_sources": [
                "User Account: User Account Creation",
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-08-12T13:04:14.248Z",
            "created": "2020-01-28T13:50:22.506Z",
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--635cbe30-392d-4e27-978e-66774357c762",
            "description": "Adversaries may create a local account to maintain access to victim systems. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. With a sufficient level of access, the <code>net user /add</code> command can be used to create a local account. On macOS systems the <code>dscl -create</code> command can be used to create a local account.\n\nSuch accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_detection": "Monitor for processes and command-line parameters associated with local account creation, such as <code>net user /add</code> , <code>useradd</code> , and <code>dscl -create</code> . Collect data on account creation within a network. Event ID 4720 is generated when a user account is created on a Windows system. (Citation: Microsoft User Creation Event) Perform regular audits of local system accounts to detect suspicious accounts that may have been created by an adversary.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1136/001",
                    "external_id": "T1136.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4720",
                    "description": "Lich, B., Miroshnikov, A. (2017, April 5). 4720(S): A user account was created. Retrieved June 30, 2017.",
                    "source_name": "Microsoft User Creation Event"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Data from Local System",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1005",
                    "external_id": "T1005",
                    "source_name": "mitre-attack"
                }
            ],
            "x_mitre_data_sources": [
                "Script: Script Execution",
                "File: File Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.3",
            "modified": "2021-10-15T22:16:42.734Z",
            "x_mitre_system_requirements": [
                "Privileges to access certain files and directories"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5",
            "description": "Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.\n\nAdversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.\n",
            "x_mitre_contributors": [
                "William Cain"
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments for actions that could be taken to collect files from a system. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created": "2017-05-31T21:30:20.537Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Local Data Staging",
            "x_mitre_data_sources": [
                "File: File Access",
                "File: File Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-05-26T19:23:54.854Z",
            "created": "2020-03-13T21:13:10.467Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--1c34f7aa-9341-4a48-bfab-af22e51aca6c",
            "description": "Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as [Archive Collected Data](https://attack.mitre.org/techniques/T1560). Interactive command shells may be used, and common functionality within [cmd](https://attack.mitre.org/software/S0106) and bash may be used to copy data into a staging location.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files, such as 7zip, RAR, ZIP, or zlib. Monitor publicly writeable directories, central locations, and commonly used staging directories (recycle bin, temp folders, etc.) to regularly check for compressed or encrypted data that may be indicative of staging.\n\nMonitor processes and command-line arguments for actions that could be taken to collect and combine files. Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location. Data may also be acquired and staged through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1074/001",
                    "external_id": "T1074.001",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-07-28T01:37:46.704Z",
            "name": "Drive-by Compromise",
            "x_mitre_data_sources": [
                "File: File Creation",
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "1.3",
            "created": "2018-04-18T17:59:24.739Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Windows",
                "Linux",
                "macOS",
                "SaaS"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--d742a578-d70e-4d0e-96a6-02a9c30204e6",
            "description": "Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring [Application Access Token](https://attack.mitre.org/techniques/T1550/001).\n\nMultiple ways of delivering exploit code to a browser exist, including:\n\n* A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting.\n* Malicious ads are paid for and served through legitimate ad providers.\n* Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).\n\nOften the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Shadowserver Strategic Web Compromise)\n\nTypical drive-by compromise process:\n\n1. A user visits a website that is used to host the adversary controlled content.\n2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. \n    * The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.\n3. Upon finding a vulnerable version, exploit code is delivered to the browser.\n4. If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.\n    * In some cases a second visit to the website after the initial scan is required before exploit code is delivered.\n\nUnlike [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190), the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.\n\nAdversaries may also use compromised websites to deliver a user to a malicious application designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.(Citation: Volexity OceanLotus Nov 2017)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)",
                "Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)"
            ],
            "x_mitre_detection": "Firewalls and proxies can inspect URLs for potentially known-bad domains or parameters. They can also do reputation-based analytics on websites and their requested resources such as how old a domain is, who it's registered to, if it's on a known bad list, or how many other users have connected to it before.\n\nNetwork intrusion detection systems, sometimes with SSL/TLS inspection, can be used to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.\n\nDetecting compromise based on the drive-by exploit from a legitimate website may be difficult. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of browser processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1189",
                    "external_id": "T1189",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Shadowserver Strategic Web Compromise",
                    "description": "Adair, S., Moran, N. (2012, May 15). Cyber Espionage & Strategic Web Compromises \u2013 Trusted Websites Serving Dangerous Results. Retrieved March 13, 2018.",
                    "url": "http://blog.shadowserver.org/2012/05/15/cyber-espionage-strategic-web-compromises-trusted-websites-serving-dangerous-results/"
                },
                {
                    "url": "https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/",
                    "description": "Lassalle, D., et al. (2017, November 6). OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society. Retrieved November 6, 2017.",
                    "source_name": "Volexity OceanLotus Nov 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Remote Email Collection",
            "x_mitre_data_sources": [
                "Network Traffic: Network Connection Creation",
                "Logon Session: Logon Session Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-03-25T13:12:56.909Z",
            "created": "2020-02-19T18:52:24.547Z",
            "x_mitre_platforms": [
                "Office 365",
                "Windows",
                "Google Workspace"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--b4694861-542c-48ea-9eb1-10d356e7140a",
            "description": "Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [MailSniper](https://attack.mitre.org/software/S0413) can be used to automate searches for specific keywords.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Monitor for unusual login activity from unknown or abnormal locations, especially for privileged accounts (ex: Exchange administrator account).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1114/002",
                    "external_id": "T1114.002",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "External Remote Services",
            "x_mitre_data_sources": [
                "Application Log: Application Log Content",
                "Logon Session: Logon Session Metadata",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-08-19T16:57:27.209Z",
            "created": "2017-05-31T21:31:44.421Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "id": "attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d",
            "x_mitre_platforms": [
                "Windows",
                "Linux",
                "Containers",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) and [VNC](https://attack.mitre.org/techniques/T1021/005) can also be used externally.(Citation: MacOS VNC software for Remote Desktop)\n\nAccess to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.(Citation: Volexity Virtual Private Keylogging) Access to remote services may be used as a redundant or persistent access mechanism during an operation.\n\nAccess may also be gained through an exposed service that doesn\u2019t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware)",
            "x_mitre_contributors": [
                "ExtraHop",
                "David Fiser, @anu4is, Trend Micro",
                "Alfredo Oliveira, Trend Micro",
                "Idan Frimark, Cisco",
                "Rory McCune, Aqua Security",
                "Yuval Avrahami, Palo Alto Networks",
                "Jay Chen, Palo Alto Networks",
                "Brad Geesaman, @bradgeesaman",
                "Magno Logan, @magnologan, Trend Micro",
                "Ariel Shuper, Cisco",
                "Yossi Weizman, Azure Defender Research Team",
                "Vishwas Manral, McAfee",
                "Daniel Oakley",
                "Travis Smith, Tripwire"
            ],
            "x_mitre_detection": "Follow best practices for detecting adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078) for authenticating to remote services. Collect authentication logs and analyze for unusual access patterns, windows of activity, and access outside of normal business hours.\n\nWhen authentication is not required to access an exposed remote service, monitor for follow-on activities such as anomalous external use of the exposed API or application.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1133",
                    "external_id": "T1133",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/555.html",
                    "external_id": "CAPEC-555",
                    "source_name": "capec"
                },
                {
                    "url": "https://support.apple.com/guide/remote-desktop/set-up-a-computer-running-vnc-software-apdbed09830/mac",
                    "description": "Apple Support. (n.d.). Set up a computer running VNC software for Remote Desktop. Retrieved August 18, 2021.",
                    "source_name": "MacOS VNC software for Remote Desktop"
                },
                {
                    "source_name": "Volexity Virtual Private Keylogging",
                    "description": "Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017.",
                    "url": "https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/"
                },
                {
                    "url": "https://www.trendmicro.com/en_us/research/20/f/xorddos-kaiji-botnet-malware-variants-target-exposed-docker-servers.html",
                    "description": "Remillano II, A., et al. (2020, June 20). XORDDoS, Kaiji Variants Target Exposed Docker Servers. Retrieved April 5, 2021.",
                    "source_name": "Trend Micro Exposed Docker Server"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/",
                    "description": "Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.",
                    "source_name": "Unit 42 Hildegard Malware"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "File and Directory Discovery",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1083",
                    "external_id": "T1083",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/127.html",
                    "external_id": "CAPEC-127",
                    "source_name": "capec"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/497.html",
                    "external_id": "CAPEC-497",
                    "source_name": "capec"
                },
                {
                    "source_name": "Windows Commands JPCERT",
                    "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.",
                    "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"
                }
            ],
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.3",
            "modified": "2021-08-23T20:44:32.048Z",
            "x_mitre_system_requirements": [
                "Some folders may require Administrator, SYSTEM or specific user depending on permission levels and access controls"
            ],
            "id": "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "description": "Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nMany command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>.(Citation: Windows Commands JPCERT) Custom tools may also be used to gather file and directory information and interact with the [Native API](https://attack.mitre.org/techniques/T1106).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Collection and Exfiltration, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created": "2017-05-31T21:31:04.710Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "type": "attack-pattern",
            "modified": "2020-06-19T17:16:41.470Z",
            "name": "Forced Authentication",
            "x_mitre_data_sources": [
                "File: File Access",
                "File: File Creation",
                "File: File Modification",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "1.2",
            "created": "2018-01-16T16:13:52.465Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--b77cf5f3-6060-475d-bd60-40ccbf28fdc2",
            "description": "Adversaries may gather credential material by invoking or forcing a user to automatically provide authentication information through a mechanism in which they can intercept.\n\nThe Server Message Block (SMB) protocol is commonly used in Windows networks for authentication and communication between systems for access to resources and file sharing. When a Windows system attempts to connect to an SMB resource it will automatically attempt to authenticate and send credential information for the current user to the remote system. (Citation: Wikipedia Server Message Block) This behavior is typical in enterprise environments so that users do not need to enter credentials to access network resources.\n\nWeb Distributed Authoring and Versioning (WebDAV) is also typically used by Windows systems as a backup protocol when SMB is blocked or fails. WebDAV is an extension of HTTP and will typically operate over TCP ports 80 and 443. (Citation: Didier Stevens WebDAV Traffic) (Citation: Microsoft Managing WebDAV Security)\n\nAdversaries may take advantage of this behavior to gain access to user account hashes through forced SMB/WebDAV authentication. An adversary can send an attachment to a user through spearphishing that contains a resource link to an external server controlled by the adversary (i.e. [Template Injection](https://attack.mitre.org/techniques/T1221)), or place a specially crafted file on navigation path for privileged accounts (e.g. .SCF file placed on desktop) or on a publicly accessible share to be accessed by victim(s). When the user's system accesses the untrusted resource it will attempt authentication and send information, including the user's hashed credentials, over SMB to the adversary controlled server. (Citation: GitHub Hashjacking) With access to the credential hash, an adversary can perform off-line [Brute Force](https://attack.mitre.org/techniques/T1110) cracking to gain access to plaintext credentials. (Citation: Cylance Redirect to SMB)\n\nThere are several different ways this can occur. (Citation: Osanda Stealing NetNTLM Hashes) Some specifics from in-the-wild use include:\n\n* A spearphishing attachment containing a document with a resource that is automatically loaded when the document is opened (i.e. [Template Injection](https://attack.mitre.org/techniques/T1221)). The document can include, for example, a request similar to <code>file[:]//[remote address]/Normal.dotm</code> to trigger the SMB request. (Citation: US-CERT APT Energy Oct 2017)\n* A modified .LNK or .SCF file with the icon filename pointing to an external reference such as <code>\\\\[remote address]\\pic.png</code> that will force the system to load the resource when the icon is rendered to repeatedly gather credentials. (Citation: US-CERT APT Energy Oct 2017)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Teodor Cimpoesu",
                "Sudhanshu Chauhan, @Sudhanshu_C"
            ],
            "x_mitre_detection": "Monitor for SMB traffic on TCP ports 139, 445 and UDP port 137 and WebDAV traffic attempting to exit the network to unknown external systems. If attempts are detected, then investigate endpoint data sources to find the root cause. For internal traffic, monitor the workstation-to-workstation unusual (vs. baseline) SMB traffic. For many networks there should not be any, but it depends on how systems on the network are configured and where resources are located.\n\nMonitor creation and modification of .LNK, .SCF, or any other files on systems and within virtual environments that contain resources that point to external network resources as these could be used to gather credentials when the files are rendered. (Citation: US-CERT APT Energy Oct 2017)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1187",
                    "external_id": "T1187",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Wikipedia Server Message Block",
                    "description": "Wikipedia. (2017, December 16). Server Message Block. Retrieved December 21, 2017.",
                    "url": "https://en.wikipedia.org/wiki/Server_Message_Block"
                },
                {
                    "source_name": "Didier Stevens WebDAV Traffic",
                    "description": "Stevens, D. (2017, November 13). WebDAV Traffic To Malicious Sites. Retrieved December 21, 2017.",
                    "url": "https://blog.didierstevens.com/2017/11/13/webdav-traffic-to-malicious-sites/"
                },
                {
                    "source_name": "Microsoft Managing WebDAV Security",
                    "description": "Microsoft. (n.d.). Managing WebDAV Security (IIS 6.0). Retrieved December 21, 2017.",
                    "url": "https://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/4beddb35-0cba-424c-8b9b-a5832ad8e208.mspx"
                },
                {
                    "source_name": "GitHub Hashjacking",
                    "description": "Dunning, J. (2016, August 1). Hashjacking. Retrieved December 21, 2017.",
                    "url": "https://github.com/hob0/hashjacking"
                },
                {
                    "source_name": "Cylance Redirect to SMB",
                    "description": "Cylance. (2015, April 13). Redirect to SMB. Retrieved December 21, 2017.",
                    "url": "https://www.cylance.com/content/dam/cylance/pdfs/white_papers/RedirectToSMB.pdf"
                },
                {
                    "source_name": "Osanda Stealing NetNTLM Hashes",
                    "description": "Osanda Malith Jayathissa. (2017, March 24). Places of Interest in Stealing NetNTLM Hashes. Retrieved January 26, 2018.",
                    "url": "https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/"
                },
                {
                    "source_name": "US-CERT APT Energy Oct 2017",
                    "description": "US-CERT. (2017, October 20). Alert (TA17-293A): Advanced Persistent Threat Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved November 2, 2017.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA17-293A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Hidden Users",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Modification",
                "Process: Process Creation",
                "User Account: User Account Creation",
                "User Account: User Account Metadata",
                "File: File Modification"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-10-14T20:22:03.625Z",
            "created": "2020-03-13T20:12:40.876Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--8c4aef43-48d5-49aa-b2af-c0cd58d30c3d",
            "x_mitre_platforms": [
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "root",
                "Administrator"
            ],
            "description": "Adversaries may use hidden users to mask the presence of user accounts they create or modify. Normal users may want to hide users when there are many users accounts on a given system or want to keep an account hidden from the other users on the system.\n\nIn macOS, every user account has a userID associated with it. When creating a user, you can specify the userID for that account. There is a property value in <code>/Library/Preferences/com.apple.loginwindow</code> called <code>Hide500Users</code> that prevents users with userIDs 500 and lower from appearing at the login screen. When using the [Create Account](https://attack.mitre.org/techniques/T1136) technique with a userID under 500 (ex: <code>sudo dscl . -create /Users/username UniqueID 401</code>) and enabling this property (setting it to Yes), an adversary can conceal user accounts. (Citation: Cybereason OSX Pirrit)\n\nIn Windows, adversaries may hide user accounts via settings in the Registry. For example, an adversary may add a value to the Windows Registry (via [Reg](https://attack.mitre.org/software/S0075) or other means) that will hide the user \u201ctest\u201d from the Windows login screen: <code>reg.exe ADD 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccountsUserList' /v test /t REG_DWORD /d 0 /f</code>.(Citation: FireEye SMOKEDHAM June 2021)(Citation: US-CERT TA18-074A)",
            "x_mitre_contributors": [
                "Omkar Gudhate"
            ],
            "x_mitre_detection": "This technique prevents a user from showing up at the log in screen, but all of the other signs of the user may still exist. For example, \"hidden\" users may still get a home directory and will appear in the authentication logs.\n\nMonitor processes and command-line events for actions that could be taken to add a new user and subsequently hide it from login screens. Monitor Registry events for modifications to the <code>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccountsUserList</code> key.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1564/002",
                    "external_id": "T1564.002",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Cybereason OSX Pirrit",
                    "description": "Amit Serper. (2016). Cybereason Lab Analysis OSX.Pirrit. Retrieved July 31, 2020.",
                    "url": "http://go.cybereason.com/rs/996-YZT-709/images/Cybereason-Lab-Analysis-OSX-Pirrit-4-6-16.pdf"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2021/06/darkside-affiliate-supply-chain-software-compromise.html",
                    "description": "FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate\u2019s Supply Chain Software Compromise. Retrieved September 22, 2021.",
                    "source_name": "FireEye SMOKEDHAM June 2021"
                },
                {
                    "url": "https://www.us-cert.gov/ncas/alerts/TA18-074A",
                    "description": "US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.",
                    "source_name": "US-CERT TA18-074A"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Disable or Modify System Firewall",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Modification",
                "Firewall: Firewall Disable",
                "Firewall: Firewall Rule Modification"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-29T22:18:11.166Z",
            "created": "2020-02-21T21:00:48.814Z",
            "x_mitre_defense_bypassed": [
                "Firewall"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--5372c5fe-f424-4def-bcd5-d3a8e770f07b",
            "description": "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.\n\nModifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. ",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments to see if firewalls are disabled or modified. Monitor Registry edits to keys that manage firewalls.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1562/004",
                    "external_id": "T1562.004",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-29T21:17:03.732Z",
            "name": "Clear Windows Event Logs",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1070/001",
                    "external_id": "T1070.001",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Microsoft wevtutil Oct 2017",
                    "description": "Plett, C. et al.. (2017, October 16). wevtutil. Retrieved July 2, 2018.",
                    "url": "https://docs.microsoft.com/windows-server/administration/windows-commands/wevtutil"
                },
                {
                    "source_name": "Microsoft EventLog.Clear",
                    "description": "Microsoft. (n.d.). EventLog.Clear Method (). Retrieved July 2, 2018.",
                    "url": "https://msdn.microsoft.com/library/system.diagnostics.eventlog.clear.aspx"
                },
                {
                    "source_name": "Microsoft Clear-EventLog",
                    "description": "Microsoft. (n.d.). Clear-EventLog. Retrieved July 2, 2018.",
                    "url": "https://docs.microsoft.com/powershell/module/microsoft.powershell.management/clear-eventlog"
                }
            ],
            "x_mitre_data_sources": [
                "Process: OS API Execution",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "x_mitre_system_requirements": [
                "Clearing the Windows event logs requires Administrator permissions"
            ],
            "id": "attack-pattern--6495ae23-3ab4-43c5-a94f-5638a2c31fd2",
            "x_mitre_defense_bypassed": [
                "Anti Virus",
                "Host Intrusion Prevention Systems",
                "Log Analysis"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "description": "Adversaries may clear Windows Event Logs to hide the activity of an intrusion. Windows Event Logs are a record of a computer's alerts and notifications. There are three system-defined sources of events: System, Application, and Security, with five event types: Error, Warning, Information, Success Audit, and Failure Audit.\n\nThe event logs can be cleared with the following utility commands:\n\n* <code>wevtutil cl system</code>\n* <code>wevtutil cl application</code>\n* <code>wevtutil cl security</code>\n\nThese logs may also be cleared through other mechanisms, such as the event viewer GUI or [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "x_mitre_detection": "Deleting Windows event logs (via native binaries (Citation: Microsoft wevtutil Oct 2017), API functions (Citation: Microsoft EventLog.Clear), or [PowerShell](https://attack.mitre.org/techniques/T1059/001) (Citation: Microsoft Clear-EventLog)) may also generate an alterable event (Event ID 1102: \"The audit log was cleared\").",
            "created": "2020-01-28T17:05:14.707Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "File Deletion",
            "x_mitre_data_sources": [
                "File: File Deletion",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-29T21:34:16.209Z",
            "created": "2020-01-31T12:35:36.479Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c",
            "x_mitre_defense_bypassed": [
                "Host forensic analysis"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n\nThere are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)",
            "x_mitre_contributors": [
                "Walker Johnson"
            ],
            "x_mitre_detection": "It may be uncommon for events related to benign command-line functions such as DEL or third-party utilities or tools to be found in an environment, depending on the user base and how systems are typically used. Monitoring for command-line deletion functions to correlate with binaries or other files that an adversary may drop and remove may lead to detection of malicious activity. Another good practice is monitoring for known deletion and secure deletion tools that are not already on systems within an enterprise network that an adversary could introduce. Some monitoring tools may collect command-line arguments, but may not capture DEL commands since DEL is a native function within cmd.exe.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1070/004",
                    "external_id": "T1070.004",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Trend Micro APT Attack Tools",
                    "description": "Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015.",
                    "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-20T15:42:48.595Z",
            "name": "Ingress Tool Transfer",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content",
                "File: File Creation"
            ],
            "x_mitre_version": "2.0",
            "created": "2017-05-31T21:31:16.408Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add",
            "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as FTP, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1105",
                    "external_id": "T1105",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Masquerading",
            "x_mitre_data_sources": [
                "Image: Image Metadata",
                "Command: Command Execution",
                "Service: Service Metadata",
                "Service: Service Creation",
                "Scheduled Job: Scheduled Job Metadata",
                "Scheduled Job: Scheduled Job Modification",
                "File: File Metadata",
                "Process: Process Metadata",
                "File: File Modification"
            ],
            "x_mitre_version": "1.4",
            "modified": "2021-10-18T13:24:52.973Z",
            "created": "2017-05-31T21:30:38.511Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "x_mitre_defense_bypassed": [
                "Application control by file name or path"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0",
            "description": "Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.\n\nRenaming abusable system utilities to evade security monitoring is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site)",
            "x_mitre_contributors": [
                "Oleg Kolesnikov, Securonix",
                "Nick Carr, Mandiant",
                "David Lu, Tripwire",
                "Felipe Esp\u00f3sito, @Pr0teus",
                "Elastic",
                "Bartosz Jerzman"
            ],
            "x_mitre_detection": "Collect file hashes; file names that do not match their expected hash are suspect. Perform file monitoring; files with known names but in unusual locations are suspect. Likewise, files that are modified outside of an update or patch are suspect.\n\nIf file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)\n\nLook for indications of common characters that may indicate an attempt to trick users into misidentifying the file type, such as a space as the last character of a file name or the right-to-left override characters\"\\u202E\", \"[U+202E]\", and \"%E2%80%AE\u201d.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1036",
                    "external_id": "T1036",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/177.html",
                    "external_id": "CAPEC-177",
                    "source_name": "capec"
                },
                {
                    "url": "https://lolbas-project.github.io/",
                    "description": "LOLBAS. (n.d.). Living Off The Land Binaries and Scripts (and also Libraries). Retrieved February 10, 2020.",
                    "source_name": "LOLBAS Main Site"
                },
                {
                    "url": "http://pages.endgame.com/rs/627-YBU-612/images/EndgameJournal_The%20Masquerade%20Ball_Pages_R2.pdf",
                    "description": "Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.",
                    "source_name": "Elastic Masquerade Ball"
                },
                {
                    "url": "https://twitter.com/ItsReallyNick/status/1055321652777619457",
                    "description": "Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved April 22, 2019.",
                    "source_name": "Twitter ItsReallyNick Masquerading Update"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Modify Registry",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Process: OS API Execution",
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Creation",
                "Windows Registry: Windows Registry Key Modification",
                "Windows Registry: Windows Registry Key Deletion"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-08-13T20:02:49.641Z",
            "created": "2017-05-31T21:31:23.587Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4",
            "x_mitre_defense_bypassed": [
                "Host forensic analysis"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\n\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\n\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.",
            "x_mitre_contributors": [
                "Bartosz Jerzman",
                "Travis Smith, Tripwire",
                "David Lu, Tripwire"
            ],
            "x_mitre_detection": "Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1112",
                    "external_id": "T1112",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/203.html",
                    "external_id": "CAPEC-203",
                    "source_name": "capec"
                },
                {
                    "source_name": "Microsoft Reg",
                    "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.",
                    "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx"
                },
                {
                    "source_name": "Microsoft Reghide NOV 2006",
                    "description": "Russinovich, M. & Sharkey, K. (2006, January 10). Reghide. Retrieved August 9, 2018.",
                    "url": "https://docs.microsoft.com/sysinternals/downloads/reghide"
                },
                {
                    "source_name": "TrendMicro POWELIKS AUG 2014",
                    "description": "Santos, R. (2014, August 1). POWELIKS: Malware Hides In Windows Registry. Retrieved August 9, 2018.",
                    "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-malware-hides-in-windows-registry/"
                },
                {
                    "source_name": "SpectorOps Hiding Reg Jul 2017",
                    "description": "Reitz, B. (2017, July 14). Hiding Registry keys with PSReflect. Retrieved August 9, 2018.",
                    "url": "https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353"
                },
                {
                    "source_name": "Microsoft Remote",
                    "description": "Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015.",
                    "url": "https://technet.microsoft.com/en-us/library/cc754820.aspx"
                },
                {
                    "source_name": "Microsoft 4657 APR 2017",
                    "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018.",
                    "url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657"
                },
                {
                    "source_name": "Microsoft RegDelNull July 2016",
                    "description": "Russinovich, M. & Sharkey, K. (2016, July 4). RegDelNull v1.11. Retrieved August 10, 2018.",
                    "url": "https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Network Share Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "3.1",
            "modified": "2021-10-13T18:10:57.185Z",
            "created": "2017-12-14T16:46:06.044Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "id": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f",
            "x_mitre_platforms": [
                "macOS",
                "Windows",
                "Linux"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. \n\nFile sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\\\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.",
            "x_mitre_contributors": [
                "Praetorian"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1135",
                    "external_id": "T1135",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/643.html",
                    "external_id": "CAPEC-643",
                    "source_name": "capec"
                },
                {
                    "source_name": "Wikipedia Shared Resource",
                    "description": "Wikipedia. (2017, April 15). Shared resource. Retrieved June 30, 2017.",
                    "url": "https://en.wikipedia.org/wiki/Shared_resource"
                },
                {
                    "source_name": "TechNet Shared Folder",
                    "description": "Microsoft. (n.d.). Share a Folder or Drive. Retrieved June 30, 2017.",
                    "url": "https://technet.microsoft.com/library/cc770880.aspx"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Security Account Manager",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Access",
                "File: File Access"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-25T15:17:30.640Z",
            "created": "2020-02-11T18:42:07.281Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--1644e709-12d2-41e5-a60f-3470991f5011",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "SYSTEM"
            ],
            "description": "Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored. The SAM is a database file that contains local accounts for the host, typically those found with the <code>net user</code> command. Enumerating the SAM database requires SYSTEM level access.\n\nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe\n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with Reg:\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes.(Citation: GitHub Creddump7)\n\nNotes: \n* RID 500 account is the local, built-in administrator.\n* RID 501 is the guest account.\n* User accounts start with a RID of 1,000+.\n",
            "x_mitre_contributors": [
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Hash dumpers open the Security Accounts Manager (SAM) on the local file system (<code>%SystemRoot%/system32/config/SAM</code>) or create a dump of the Registry SAM key to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/002",
                    "external_id": "T1003.002",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "GitHub Creddump7",
                    "description": "Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018.",
                    "url": "https://github.com/Neohapsis/creddump7"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "NTDS",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/003",
                    "external_id": "T1003.003",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Wikipedia Active Directory",
                    "description": "Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018.",
                    "url": "https://en.wikipedia.org/wiki/Active_Directory"
                },
                {
                    "source_name": "Metcalf 2015",
                    "description": "Metcalf, S. (2015, January 19). Attackers Can Now Use Mimikatz to Implant Skeleton Key on Domain Controllers & BackDoor Your Active Directory Forest. Retrieved February 3, 2015.",
                    "url": "http://adsecurity.org/?p=1275"
                }
            ],
            "x_mitre_data_sources": [
                "File: File Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-12-14T23:08:02.782Z",
            "x_mitre_system_requirements": [
                "Access to Domain Controller or backup"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--edf91964-b26e-4b4a-9600-ccacd7d7df24",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "description": "Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights. By default, the NTDS file (NTDS.dit) is located in <code>%SystemRoot%\\NTDS\\Ntds.dit</code> of a domain controller.(Citation: Wikipedia Active Directory)\n\nIn addition to looking for NTDS files on active Domain Controllers, attackers may search for backups that contain the same or similar information.(Citation: Metcalf 2015)\n\nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n",
            "x_mitre_contributors": [
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping, especially attempts to access or copy the NTDS.dit.",
            "created": "2020-02-11T18:42:35.572Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "LSA Secrets",
            "x_mitre_data_sources": [
                "Windows Registry: Windows Registry Key Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-04-21T21:12:38.361Z",
            "created": "2020-02-21T16:22:09.493Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "SYSTEM"
            ],
            "description": "Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets)\n\n[Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)",
            "x_mitre_contributors": [
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/004",
                    "external_id": "T1003.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.passcape.com/index.php?section=docsys&cmd=details&id=23",
                    "description": "Passcape. (n.d.). Windows LSA secrets. Retrieved February 21, 2020.",
                    "source_name": "Passcape LSA Secrets"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material?redirectedfrom=MSDN",
                    "description": "Microsoft. (2019, February 14). Active Directory administrative tier model. Retrieved February 21, 2020.",
                    "source_name": "Microsoft AD Admin Tier Model"
                },
                {
                    "url": "https://www.first.org/resources/papers/conf2017/Windows-Credentials-Attacks-and-Mitigation-Techniques.pdf",
                    "description": "Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.",
                    "source_name": "Tilbury Windows Credentials"
                },
                {
                    "url": "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsa-secrets",
                    "description": "Mantvydas Baranauskas. (2019, November 16). Dumping LSA Secrets. Retrieved February 21, 2020.",
                    "source_name": "ired Dumping LSA Secrets"
                },
                {
                    "source_name": "Powersploit",
                    "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
                    "url": "https://github.com/mattifestation/PowerSploit"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-12T19:07:53.043Z",
            "name": "Domain Groups",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-02-21T21:15:06.561Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c",
            "description": "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1069/002",
                    "external_id": "T1069.002",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-10-18T17:39:12.452Z",
            "name": "Spearphishing Attachment",
            "x_mitre_data_sources": [
                "File: File Creation",
                "Application Log: Application Log Content",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.2",
            "created": "2020-03-02T19:05:18.137Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_platforms": [
                "macOS",
                "Windows",
                "Linux"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
            "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Philip Winther"
            ],
            "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nAnti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the attachment is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.\n\nMonitor for suspicious descendant process spawning from Microsoft Office and other productivity software.(Citation: Elastic - Koadiac Detection with EQL)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1566/001",
                    "external_id": "T1566.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/163.html",
                    "external_id": "CAPEC-163",
                    "source_name": "capec"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide",
                    "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
                    "source_name": "Microsoft Anti Spoofing"
                },
                {
                    "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf",
                    "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.",
                    "source_name": "ACSC Email Spoofing"
                },
                {
                    "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql",
                    "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.",
                    "source_name": "Elastic - Koadiac Detection with EQL"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Spearphishing Link",
            "x_mitre_data_sources": [
                "Application Log: Application Log Content",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.1",
            "modified": "2021-04-14T14:38:42.715Z",
            "created": "2020-03-02T19:15:44.182Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Office 365",
                "SaaS",
                "Google Workspace"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
            "description": "Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)",
            "x_mitre_contributors": [
                "Philip Winther",
                "Shailesh Tiwary (Indian Army)",
                "Mark Wee",
                "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)",
                "Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)"
            ],
            "x_mitre_detection": "URL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites. Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nBecause this technique usually involves user interaction on the endpoint, many of the possible detections take place once [User Execution](https://attack.mitre.org/techniques/T1204) occurs.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1566/002",
                    "external_id": "T1566.002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/163.html",
                    "external_id": "CAPEC-163",
                    "source_name": "capec"
                },
                {
                    "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks",
                    "description": "Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019.",
                    "source_name": "Trend Micro Pawn Storm OAuth 2017"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide",
                    "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
                    "source_name": "Microsoft Anti Spoofing"
                },
                {
                    "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf",
                    "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.",
                    "source_name": "ACSC Email Spoofing"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Query Registry",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Access",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-03-26T18:08:20.049Z",
            "created": "2017-05-31T21:30:25.584Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896",
            "description": "Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\n\nThe Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nInteraction with the Windows Registry may come from the command line using utilities such as [Reg](https://attack.mitre.org/software/S0075) or through running malware that may interact with the Registry through an API. Command-line invocation of utilities used to query the Registry may be detected through process and command-line monitoring. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1012",
                    "external_id": "T1012",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/647.html",
                    "external_id": "CAPEC-647",
                    "source_name": "capec"
                },
                {
                    "source_name": "Wikipedia Windows Registry",
                    "description": "Wikipedia. (n.d.). Windows Registry. Retrieved February 2, 2015.",
                    "url": "https://en.wikipedia.org/wiki/Windows_Registry"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Remote Desktop Protocol",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1021/001",
                    "external_id": "T1021.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/555.html",
                    "external_id": "CAPEC-555",
                    "source_name": "capec"
                },
                {
                    "source_name": "TechNet Remote Desktop Services",
                    "description": "Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016.",
                    "url": "https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx"
                },
                {
                    "source_name": "Alperovitch Malware",
                    "description": "Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014.",
                    "url": "http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/"
                }
            ],
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Flow",
                "Logon Session: Logon Session Creation"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-02-25T19:23:34.204Z",
            "x_mitre_system_requirements": [
                "RDP service enabled, account in the Remote Desktop Users group"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "lateral-movement"
                }
            ],
            "id": "attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Remote Desktop Users",
                "User"
            ],
            "description": "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.\n\nRemote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) \n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) technique for Persistence.(Citation: Alperovitch Malware)",
            "x_mitre_contributors": [
                "Matthew Demaske, Adaptforward"
            ],
            "x_mitre_detection": "Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.",
            "created": "2020-02-11T18:23:26.059Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Remote System Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Network Traffic: Network Connection Creation",
                "File: File Access"
            ],
            "x_mitre_version": "3.2",
            "modified": "2021-10-15T15:30:00.172Z",
            "created": "2017-05-31T21:30:28.187Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "id": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097) or <code>net view</code> using [Net](https://attack.mitre.org/software/S0039). Adversaries may also use local host files (ex: <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> or <code>/etc/hosts</code>) in order to discover the hostname to IP address mappings of remote systems. \n",
            "x_mitre_contributors": [
                "Daniel Stepanic, Elastic",
                "RedHuntLabs, @redhuntlabs"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nMonitor for processes that can be used to discover remote systems, such as <code>ping.exe</code> and <code>tracert.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1018",
                    "external_id": "T1018",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/292.html",
                    "external_id": "CAPEC-292",
                    "source_name": "capec"
                },
                {
                    "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql",
                    "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.",
                    "source_name": "Elastic - Koadiac Detection with EQL"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-12-30T14:26:44.730Z",
            "name": "Scheduled Task",
            "x_mitre_data_sources": [
                "Scheduled Job: Scheduled Job Creation",
                "Command: Command Execution",
                "File: File Modification",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.0",
            "created": "2019-11-27T14:58:00.429Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
            "description": "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The <code>schtasks</code> can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task.\n\nThe deprecated [at](https://attack.mitre.org/software/S0110) utility could also be abused by adversaries (ex: [At (Windows)](https://attack.mitre.org/techniques/T1053/002)), though <code>at.exe</code> can not access tasks created with <code>schtasks</code> or the Control Panel.\n\nAn adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Monitor process execution from the <code>svchost.exe</code> in Windows 10 and the Windows Task Scheduler <code>taskeng.exe</code> for older versions of Windows. (Citation: Twitter Leoloobeek Scheduled Task) If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete. Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc.\n\nConfigure event logging for scheduled task creation and changes by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service. (Citation: TechNet Forum Scheduled Task Operational Setting) Several events will then be logged on scheduled task activity, including: (Citation: TechNet Scheduled Task Events)(Citation: Microsoft Scheduled Task Events Win10)\n\n* Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered\n* Event ID 140 on Windows 7, Server 2008 R2 / 4702 on Windows 10, Server 2016 - Scheduled task updated\n* Event ID 141 on Windows 7, Server 2008 R2 / 4699 on Windows 10, Server 2016 - Scheduled task deleted\n* Event ID 4698 on Windows 10, Server 2016 - Scheduled task created\n* Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled\n* Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current scheduled tasks. (Citation: TechNet Autoruns)\n\nRemote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1053/005",
                    "external_id": "T1053.005",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Twitter Leoloobeek Scheduled Task",
                    "description": "Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved December 12, 2017.",
                    "url": "https://twitter.com/leoloobeek/status/939248813465853953"
                },
                {
                    "source_name": "TechNet Forum Scheduled Task Operational Setting",
                    "description": "Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017.",
                    "url": "https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen"
                },
                {
                    "source_name": "TechNet Scheduled Task Events",
                    "description": "Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017.",
                    "url": "https://technet.microsoft.com/library/dd315590.aspx"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events",
                    "description": "Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019.",
                    "source_name": "Microsoft Scheduled Task Events Win10"
                },
                {
                    "source_name": "TechNet Autoruns",
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-24T19:56:37.627Z",
            "name": "Screen Capture",
            "x_mitre_data_sources": [
                "Process: OS API Execution",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "created": "2017-05-31T21:31:25.060Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688",
            "description": "Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations. Taking a screenshot is also typically possible through native utilities or API calls, such as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)\n",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Monitoring for screen capture behavior will depend on the method used to obtain data from the operating system and write output files. Detection methods could include collecting information from unusual processes using API calls used to obtain image data, and monitoring for image files written to disk. The sensor data may need to be correlated with other events to identify malicious activity, depending on the legitimacy of this behavior within a given network environment.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1113",
                    "external_id": "T1113",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/648.html",
                    "external_id": "CAPEC-648",
                    "source_name": "capec"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen?view=netframework-4.8",
                    "description": "Microsoft. (n.d.). Graphics.CopyFromScreen Method. Retrieved March 24, 2020.",
                    "source_name": "CopyFromScreen .NET"
                },
                {
                    "source_name": "Antiquated Mac Malware",
                    "description": "Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017.",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Web Shell",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1505/003",
                    "external_id": "T1505.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/650.html",
                    "external_id": "CAPEC-650",
                    "source_name": "capec"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html",
                    "description": "Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015.",
                    "source_name": "Lee 2013"
                },
                {
                    "url": "https://github.com/nsacyber/Mitigating-Web-Shells",
                    "description": " NSA Cybersecurity Directorate. (n.d.). Mitigating Web Shells. Retrieved July 22, 2021.",
                    "source_name": "NSA Cyber Mitigating Web Shells"
                },
                {
                    "source_name": "US-CERT Alert TA15-314A Web Shells",
                    "description": "US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA15-314A"
                }
            ],
            "x_mitre_data_sources": [
                "File: File Creation",
                "File: File Modification",
                "Process: Process Creation",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-07-26T13:46:47.993Z",
            "x_mitre_system_requirements": [
                "Adversary access to Web server with vulnerability or account to upload and serve the Web shell file."
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "id": "attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb",
            "x_mitre_platforms": [
                "Linux",
                "Windows",
                "macOS"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "SYSTEM",
                "User"
            ],
            "description": "Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.\n\nIn addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013) ",
            "x_mitre_contributors": [
                "Arnim Rupp, Deutsche Lufthansa AG"
            ],
            "x_mitre_detection": "Web shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is the following short payload: (Citation: Lee 2013) \n\n<code>&lt;?php @eval($_POST['password']);&gt;</code>\n\nNevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as spawning cmd.exe or accessing files that are not in the Web directory.(Citation: NSA Cyber Mitigating Web Shells)\n\nFile monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script.(Citation: NSA Cyber Mitigating Web Shells)\n\nLog authentication attempts to the server and any unusual traffic patterns to or from the server and internal network. (Citation: US-CERT Alert TA15-314A Web Shells)",
            "created": "2019-12-13T16:46:18.927Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "System Network Configuration Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Script: Script Execution",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.3",
            "modified": "2021-10-08T00:17:37.881Z",
            "created": "2017-05-31T21:30:27.342Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
            "description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1016",
                    "external_id": "T1016",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/309.html",
                    "external_id": "CAPEC-309",
                    "source_name": "capec"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-08-12T13:34:34.153Z",
            "name": "System Owner/User Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.3",
            "created": "2017-05-31T21:30:35.733Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104",
            "description": "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nVarious utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1033",
                    "external_id": "T1033",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/577.html",
                    "external_id": "CAPEC-577",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Template Injection",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-04-29T14:37:59.462Z",
            "created": "2018-10-17T00:14:20.652Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--dc31fe1e-d722-49da-8f5f-92c7b5aff534",
            "x_mitre_defense_bypassed": [
                "Static File Analysis"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may create or modify references in Office document templates to conceal malicious code or force authentication attempts. Microsoft\u2019s Office Open XML (OOXML) specification defines an XML-based format for Office documents (.docx, xlsx, .pptx) to replace older binary formats (.doc, .xls, .ppt). OOXML files are packed together ZIP archives compromised of various XML files, referred to as parts, containing properties that collectively define how a document is rendered. (Citation: Microsoft Open XML July 2017)\n\nProperties within parts may reference shared public resources accessed via online URLs. For example, template properties reference a file, serving as a pre-formatted document blueprint, that is fetched when the document is loaded.\n\nAdversaries may abuse this technology to initially conceal malicious code to be executed via documents. Template references injected into a document may enable malicious payloads to be fetched and executed when the document is loaded. (Citation: SANS Brian Wiltse Template Injection) These documents can be delivered via other techniques such as [Phishing](https://attack.mitre.org/techniques/T1566) and/or [Taint Shared Content](https://attack.mitre.org/techniques/T1080) and may evade static detections since no typical indicators (VBA macro, script, etc.) are present until after the malicious payload is fetched. (Citation: Redxorblue Remote Template Injection) Examples have been seen in the wild where template injection was used to load malicious code containing an exploit. (Citation: MalwareBytes Template Injection OCT 2017)\n\nThis technique may also enable [Forced Authentication](https://attack.mitre.org/techniques/T1187) by injecting a SMB/HTTPS (or other credential prompting) URL and triggering an authentication attempt. (Citation: Anomali Template Injection MAR 2018) (Citation: Talos Template Injection July 2017) (Citation: ryhanson phishery SEPT 2016)",
            "x_mitre_contributors": [
                "Brian Wiltse @evalstrings",
                "Patrick Campbell, @pjcampbe11"
            ],
            "x_mitre_detection": "Analyze process behavior to determine if an Office application is performing actions, such as opening network connections, reading files, spawning abnormal child processes (ex: [PowerShell](https://attack.mitre.org/techniques/T1059/001)), or other suspicious actions that could relate to post-compromise behavior.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1221",
                    "external_id": "T1221",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Microsoft Open XML July 2017",
                    "description": "Microsoft. (2014, July 9). Introducing the Office (2007) Open XML File Formats. Retrieved July 20, 2018.",
                    "url": "https://docs.microsoft.com/previous-versions/office/developer/office-2007/aa338205(v=office.12)"
                },
                {
                    "url": "https://www.sans.org/reading-room/whitepapers/testing/template-injection-attacks-bypassing-security-controls-living-land-38780",
                    "description": "Wiltse, B.. (2018, November 7). Template Injection Attacks - Bypassing Security Controls by Living off the Land. Retrieved April 10, 2019.",
                    "source_name": "SANS Brian Wiltse Template Injection"
                },
                {
                    "source_name": "Redxorblue Remote Template Injection",
                    "description": "Hawkins, J. (2018, July 18). Executing Macros From a DOCX With Remote Template Injection. Retrieved October 12, 2018.",
                    "url": "http://blog.redxorblue.com/2018/07/executing-macros-from-docx-with-remote.html"
                },
                {
                    "source_name": "MalwareBytes Template Injection OCT 2017",
                    "description": "Segura, J. (2017, October 13). Decoy Microsoft Word document delivers malware through a RAT. Retrieved July 21, 2018.",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2017/10/decoy-microsoft-word-document-delivers-malware-through-rat/"
                },
                {
                    "source_name": "Anomali Template Injection MAR 2018",
                    "description": "Intel_Acquisition_Team. (2018, March 1). Credential Harvesting and Malicious File Delivery using Microsoft Office Template Injection. Retrieved July 20, 2018.",
                    "url": "https://forum.anomali.com/t/credential-harvesting-and-malicious-file-delivery-using-microsoft-office-template-injection/2104"
                },
                {
                    "source_name": "Talos Template Injection July 2017",
                    "description": "Baird, S. et al.. (2017, July 7). Attack on Critical Infrastructure Leverages Template Injection. Retrieved July 21, 2018.",
                    "url": "https://blog.talosintelligence.com/2017/07/template-injection.html"
                },
                {
                    "source_name": "ryhanson phishery SEPT 2016",
                    "description": "Hanson, R. (2016, September 24). phishery. Retrieved July 21, 2018.",
                    "url": "https://github.com/ryhanson/phishery"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-11T14:43:31.706Z",
            "name": "Malicious Link",
            "x_mitre_data_sources": [
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content",
                "File: File Creation"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-03-11T14:43:31.706Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9",
            "description": "An adversary may rely upon a user clicking a malicious link in order to gain execution. Users may be subjected to social engineering to get them to click on a link that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Links may also lead users to download files that require execution via [Malicious File](https://attack.mitre.org/techniques/T1204/002).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_detection": "Inspect network traffic for indications that a user visited a malicious site, such as links included in phishing campaigns directed at your organization.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded from a link and executed on the user's computer.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1204/001",
                    "external_id": "T1204.001",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Malicious File",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "File: File Creation"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-07-21T23:10:47.193Z",
            "created": "2020-03-11T14:49:36.954Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e",
            "description": "An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.\n\nAdversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it.\n\nWhile [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_detection": "Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain initial access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) in payloads.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1204/002",
                    "external_id": "T1204.002",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Valid Accounts",
            "x_mitre_data_sources": [
                "Logon Session: Logon Session Metadata",
                "User Account: User Account Authentication",
                "Logon Session: Logon Session Creation"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-10-19T03:29:48.018Z",
            "created": "2017-05-31T21:31:00.645Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "id": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81",
            "x_mitre_defense_bypassed": [
                "Firewall",
                "Host intrusion prevention systems",
                "Network intrusion detection system",
                "Application control",
                "System access controls",
                "Anti-virus"
            ],
            "x_mitre_platforms": [
                "Windows",
                "Azure AD",
                "Office 365",
                "SaaS",
                "IaaS",
                "Linux",
                "macOS",
                "Google Workspace",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)",
            "x_mitre_effective_permissions": [
                "User",
                "Administrator"
            ],
            "x_mitre_contributors": [
                "Jon Sternstein, Stern Security",
                "Yossi Weizman, Azure Defender Research Team",
                "Netskope",
                "Mark Wee",
                "Praetorian"
            ],
            "x_mitre_detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\n\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1078",
                    "external_id": "T1078",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/560.html",
                    "external_id": "CAPEC-560",
                    "source_name": "capec"
                },
                {
                    "source_name": "TechNet Credential Theft",
                    "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.",
                    "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"
                },
                {
                    "source_name": "TechNet Audit Policy",
                    "description": "Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.",
                    "url": "https://technet.microsoft.com/en-us/library/dn487457.aspx"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "CrackMapExec",
            "x_mitre_aliases": [
                "CrackMapExec"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-07-29T20:19:40.544Z",
            "created": "2020-07-17T14:23:05.958Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--c4810609-7da6-48ec-8057-1b70a7814db0",
            "description": "[CrackMapExec](https://attack.mitre.org/software/S0488), or CME, is a post-exploitation tool developed in Python and designed for penetration testing against networks. [CrackMapExec](https://attack.mitre.org/software/S0488) collects Active Directory information to conduct lateral movement through targeted networks.(Citation: CME Github September 2018)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0488",
                    "external_id": "S0488",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://github.com/byt3bl33d3r/CrackMapExec/wiki/SMB-Command-Reference",
                    "description": "byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.",
                    "source_name": "CME Github September 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Impacket",
            "x_mitre_aliases": [
                "Impacket"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-10-07T16:02:38.320Z",
            "created": "2019-01-31T01:39:56.283Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "id": "tool--26c87906-d750-42c5-946c-d4162c73fc7b",
            "description": "[Impacket](https://attack.mitre.org/software/S0357) is an open source collection of modules written in Python for programmatically constructing and manipulating network protocols. [Impacket](https://attack.mitre.org/software/S0357) contains several tools for remote service execution, Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks.(Citation: Impacket Tools)",
            "x_mitre_contributors": [
                "Jacob Wilkin, Trustwave, SpiderLabs"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0357",
                    "external_id": "S0357",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.secureauth.com/labs/open-source-tools/impacket",
                    "description": "SecureAuth. (n.d.).  Retrieved January 15, 2019.",
                    "source_name": "Impacket Tools"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "MCMD",
            "x_mitre_aliases": [
                "MCMD"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-08-20T14:52:23.369Z",
            "created": "2020-08-13T17:15:25.702Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--975737f1-b10d-476f-8bda-3ec26ea57172",
            "description": "[MCMD](https://attack.mitre.org/software/S0500) is a remote access tool that provides remote command shell capability used by [Dragonfly 2.0](https://attack.mitre.org/groups/G0074).(Citation: Secureworks MCMD July 2019)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0500",
                    "external_id": "S0500",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.secureworks.com/research/mcmd-malware-analysis",
                    "description": "Secureworks. (2019, July 24). MCMD Malware Analysis. Retrieved August 13, 2020.",
                    "source_name": "Secureworks MCMD July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Net",
            "x_mitre_aliases": [
                "Net",
                "net.exe"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-10-15T20:33:54.392Z",
            "created": "2017-05-31T21:32:31.601Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--03342581-f790-4f03-ba41-e82e67392e23",
            "description": "The [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.",
            "x_mitre_contributors": [
                "David Ferguson, CyberSponse"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0039",
                    "external_id": "S0039",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Microsoft Net Utility",
                    "description": "Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015.",
                    "url": "https://msdn.microsoft.com/en-us/library/aa939914"
                },
                {
                    "url": "http://windowsitpro.com/windows/netexe-reference",
                    "description": "Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.",
                    "source_name": "Savill 1999"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "netsh",
            "x_mitre_aliases": [
                "netsh",
                "netsh.exe"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-03-31T12:41:22.189Z",
            "created": "2017-05-31T21:33:06.083Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--5a63f900-5e7e-4928-a746-dd4558e1df71",
            "description": "[netsh](https://attack.mitre.org/software/S0108) is a scripting utility used to interact with networking components on local or remote systems. (Citation: TechNet Netsh)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0108",
                    "external_id": "S0108",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/library/bb490939.aspx",
                    "description": "Microsoft. (n.d.). Using Netsh. Retrieved February 13, 2017.",
                    "source_name": "TechNet Netsh"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "PsExec",
            "x_mitre_aliases": [
                "PsExec"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-06-24T13:47:24.660Z",
            "created": "2017-05-31T21:32:21.771Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db",
            "description": "[PsExec](https://attack.mitre.org/software/S0029) is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers. (Citation: Russinovich Sysinternals) (Citation: SANS PsExec)",
            "x_mitre_contributors": [
                "Janantha Marasinghe"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0029",
                    "external_id": "S0029",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Russinovich Sysinternals",
                    "description": "Russinovich, M. (2014, May 2). Windows Sysinternals PsExec v2.11. Retrieved May 13, 2015.",
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx"
                },
                {
                    "source_name": "SANS PsExec",
                    "description": "Pilkington, M.. (2012, December 17). Protecting Privileged Domain Accounts: PsExec Deep-Dive. Retrieved August 17, 2016.",
                    "url": "https://digital-forensics.sans.org/blog/2012/12/17/protecting-privileged-domain-accounts-psexec-deep-dive"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Reg",
            "x_mitre_aliases": [
                "Reg",
                "reg.exe"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-08-23T20:25:18.606Z",
            "created": "2017-05-31T21:32:49.000Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f",
            "description": "[Reg](https://attack.mitre.org/software/S0075) is a Windows utility used to interact with the Windows Registry. It can be used at the command-line interface to query, add, modify, and remove information. (Citation: Microsoft Reg)\n\nUtilities such as [Reg](https://attack.mitre.org/software/S0075) are known to be used by persistent threats. (Citation: Windows Commands JPCERT)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0075",
                    "external_id": "S0075",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx",
                    "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.",
                    "source_name": "Microsoft Reg"
                },
                {
                    "source_name": "Windows Commands JPCERT",
                    "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.",
                    "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "Trojan.Karagany",
            "x_mitre_aliases": [
                "Trojan.Karagany",
                "xFrost",
                "Karagany"
            ],
            "x_mitre_version": "2.0",
            "modified": "2020-10-14T22:38:11.328Z",
            "created": "2017-05-31T21:33:00.176Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--82cb34ba-02b5-432b-b2d2-07f55cbf674d",
            "description": "[Trojan.Karagany](https://attack.mitre.org/software/S0094) is a modular remote access tool used for recon and linked to [Dragonfly](https://attack.mitre.org/groups/G0035) and [Dragonfly 2.0](https://attack.mitre.org/groups/G0074). The source code for [Trojan.Karagany](https://attack.mitre.org/software/S0094) originated from Dream Loader malware which was leaked in 2010 and sold on underground forums. (Citation: Symantec Dragonfly)(Citation: Secureworks Karagany July 2019)(Citation: Dragos DYMALLOY )",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0094",
                    "external_id": "S0094",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Secureworks Karagany July 2019)",
                    "source_name": "xFrost"
                },
                {
                    "description": "(Citation: Secureworks Karagany July 2019)",
                    "source_name": "Karagany"
                },
                {
                    "url": "http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf",
                    "description": "Symantec Security Response. (2014, July 7). Dragonfly: Cyberespionage Attacks Against Energy Suppliers. Retrieved April 8, 2016.",
                    "source_name": "Symantec Dragonfly"
                },
                {
                    "url": "https://www.secureworks.com/research/updated-karagany-malware-targets-energy-sector",
                    "description": "Secureworks. (2019, July 24). Updated Karagany Malware Targets Energy Sector. Retrieved August 12, 2020.",
                    "source_name": "Secureworks Karagany July 2019"
                },
                {
                    "url": "https://www.dragos.com/threat/dymalloy/",
                    "description": "Dragos. (n.d.). DYMALLOY. Retrieved August 20, 2020.",
                    "source_name": "Dragos DYMALLOY "
                }
            ]
        },
        {
            "type": "relationship",
            "id": "relationship--0e09ac96-bd45-4243-9e4c-7c472dd6a1c0",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "originates-from",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--c5306215-789f-4844-88a8-7f7d5dc5ad63"
        },
        {
            "type": "relationship",
            "id": "relationship--0ab8a6ef-b0e0-4c31-a533-1f9dc89ca0dc",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "identity--9d06c6e7-4bb2-4a40-afce-3a51847ba128"
        },
        {
            "type": "relationship",
            "id": "relationship--cecc153d-45a8-4339-85f4-2fb99097df89",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--c5306215-789f-4844-88a8-7f7d5dc5ad63"
        },
        {
            "type": "relationship",
            "id": "relationship--dd8350b8-1a9a-4639-9226-c2346ce1189f",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--7ebdcb84-2242-498a-9e23-25fafa3069cf"
        },
        {
            "type": "relationship",
            "id": "relationship--b382f86e-deb8-4686-bdf8-2e0f1386534b",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--db70048f-7bb6-42d7-b826-7f7422f29ce6"
        },
        {
            "type": "relationship",
            "id": "relationship--b2dd41b7-899e-4ac1-868b-e8d53e57d573",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--e6e4a646-6504-43af-b43f-03b6379d3027"
        },
        {
            "type": "relationship",
            "id": "relationship--d82c5b2d-4924-48b4-b815-084cc1afbfa3",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--da23145d-8abe-40bf-9f8f-596562a3cb9f"
        },
        {
            "type": "relationship",
            "id": "relationship--9e81822c-3273-4d98-8a86-617123ac419a",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--04dfe533-d201-4ee8-bcad-e247c722024f"
        },
        {
            "type": "relationship",
            "id": "relationship--0772470c-b9c9-44e5-9bb7-bf4ef5ff0091",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--1459143e-a354-47bc-9754-1b50f37d319a"
        },
        {
            "type": "relationship",
            "id": "relationship--d49034c8-5036-4f49-98f8-e68506e576c1",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--2d94b5ee-b33c-420b-8a52-c4c231d2b9f6"
        },
        {
            "type": "relationship",
            "id": "relationship--79c6e86a-2fc9-4cb6-8756-e2767d6190e1",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--d3103127-bf9d-4c04-b9bf-8a53966b287a"
        },
        {
            "type": "relationship",
            "id": "relationship--8da3e150-144d-4dd3-aec9-45f0f6b2f0c7",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--e35fe4ea-44ba-4663-8639-1ebe3207524d"
        },
        {
            "type": "relationship",
            "id": "relationship--3d3081d8-8d43-486e-940b-540a40c1f4cc",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--4a392c29-881a-4d82-84f7-5341acc18ee6"
        },
        {
            "type": "relationship",
            "id": "relationship--58881b1f-78c1-456a-97c4-eb5c8fb14be7",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--ee993c53-ddff-4d64-b3d0-fe0b0f5965e5"
        },
        {
            "type": "relationship",
            "id": "relationship--3ea55c12-eaab-4ac3-a42a-1364d9d2ec0b",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--8b9cdfae-67fb-4939-85b3-956bb48c3851"
        },
        {
            "created": "2021-03-13T20:09:21.306875Z",
            "id": "identity--9d06c6e7-4bb2-4a40-afce-3a51847ba128",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Energy sector as a target",
            "sectors": [
                "energy"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--7ebdcb84-2242-498a-9e23-25fafa3069cf",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Belgium",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--db70048f-7bb6-42d7-b826-7f7422f29ce6",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Canada",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--e6e4a646-6504-43af-b43f-03b6379d3027",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "France",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--da23145d-8abe-40bf-9f8f-596562a3cb9f",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Germany",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--04dfe533-d201-4ee8-bcad-e247c722024f",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Italy",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--1459143e-a354-47bc-9754-1b50f37d319a",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Norway",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--c5306215-789f-4844-88a8-7f7d5dc5ad63",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Russia",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--2d94b5ee-b33c-420b-8a52-c4c231d2b9f6",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Singapore",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--7eac9bc3-6f7e-4c83-959c-fe7f3342389c",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Spain",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--d3103127-bf9d-4c04-b9bf-8a53966b287a",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Switzerland",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--4a392c29-881a-4d82-84f7-5341acc18ee6",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "United Kingdom",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--e35fe4ea-44ba-4663-8639-1ebe3207524d",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Turkey",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--ee993c53-ddff-4d64-b3d0-fe0b0f5965e5",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Ukraine",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--8b9cdfae-67fb-4939-85b3-956bb48c3851",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "United States",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "type": "relationship",
            "id": "relationship--28cac27e-b0b4-4aa0-adc5-8439bf15132c",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "targets",
            "source_ref": "intrusion-set--76d59913-1d24-4992-a8ac-05a3eb093f71",
            "target_ref": "location--7eac9bc3-6f7e-4c83-959c-fe7f3342389c"
        }
    ]
}