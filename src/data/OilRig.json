{
    "type": "bundle",
    "id": "bundle--380b4a72-d142-40ea-9d50-2c810e719ff1",
    "spec_version": "2.0",
    "objects": [
        {   "primary_motivation": "organizational-gain",
            "first_seen":"2014",
            "x_MISP-description": "OilRig is an Iranian threat group operating primarily in the Middle East by targeting organizations in this region that are in a variety of different industries; however, this group has occasionally targeted organizations outside of the Middle East as well. It also appears OilRig carries out supply chain attacks, where the threat group leverages the trust relationship between organizations to attack their primary targets. \r\n\r\nOilRig is an active and organized threat group, which is evident based on their systematic targeting of specific organizations that appear to be carefully chosen for strategic purposes. Attacks attributed to this group primarily rely on social engineering to exploit the human rather than software vulnerabilities; however, on occasion this group has used recently patched vulnerabilities in the delivery phase of their attacks. The lack of software vulnerability exploitation does not necessarily suggest a lack of sophistication, as OilRig has shown maturity in other aspects of their operations. Such maturities involve:\r\n\r\n-Organized evasion testing used the during development of their tools.\r\n-Use of custom DNS Tunneling protocols for command and control (C2) and data exfiltration.\r\n-Custom web-shells and backdoors used to persistently access servers.\r\n\r\nOilRig relies on stolen account credentials for lateral movement. After OilRig gains access to a system, they use credential dumping tools, such as Mimikatz, to steal credentials to accounts logged into the compromised system. The group uses these credentials to access and to move laterally to other systems on the network. After obtaining credentials from a system, operators in this group prefer to use tools other than their backdoors to access the compromised systems, such as remote desktop and putty. OilRig also uses phishing sites to harvest credentials to individuals at targeted organizations to gain access to internet accessible resources, such as Outlook Web Access.\n\n\n\nSince at least 2014, an Iranian threat group tracked by FireEye as APT34 has conducted reconnaissance aligned with the strategic interests of Iran. The group conducts operations primarily in the Middle East, targeting financial, government, energy, chemical, telecommunications and other industries. Repeated targeting of Middle Eastern financial, energy and government organizations leads FireEye to assess that those sectors are a primary concern of APT34. The use of infrastructure tied to Iranian operations, timing and alignment with the national interests of Iran also lead FireEye to assess that APT34 acts on behalf of the Iranian government.",
            "x_MISP-uuid": "42be2a84-5a5c-4c6d-9864-3f09d75bb0ba",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "modified": "2022-06-11T20:10:32.917Z",
            "name": "OilRig",
            "x_mitre_version": "3.0",
            "created": "2017-12-14T16:46:06.044Z",
            "type": "intrusion-set",
            "id": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014. The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications. It appears the group carries out supply chain attacks, leveraging the trust relationship between organizations to attack their primary targets. FireEye assesses that the group works on behalf of the Iranian government based on infrastructure details that contain references to Iran, use of Iranian infrastructure, and targeting that aligns with nation-state interests. (Citation: Palo Alto OilRig April 2017) (Citation: ClearSky OilRig Jan 2017) (Citation: Palo Alto OilRig May 2016) (Citation: Palo Alto OilRig Oct 2016) (Citation: Unit 42 Playbook Dec 2017) (Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 QUADAGENT July 2018)",
            "x_mitre_contributors": [
                "Robert Falcone",
                "Bryan Lee"
            ],
            "external_references": [
                {
                    "url": "https://attack.mitre.org/groups/G0049",
                    "external_id": "G0049",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Palo Alto OilRig April 2017) (Citation: ClearSky OilRig Jan 2017) (Citation: Palo Alto OilRig May 2016) (Citation: Palo Alto OilRig Oct 2016) (Citation: Unit 42 Playbook Dec 2017) (Citation: Unit 42 QUADAGENT July 2018)",
                    "source_name": "OilRig"
                },
                {
                    "description": "(Citation: Secureworks COBALT GYPSY Threat Profile)",
                    "source_name": "COBALT GYPSY"
                },
                {
                    "description": "(Citation: Crowdstrike Helix Kitten Nov 2018)",
                    "source_name": "IRN2"
                },
                {
                    "description": "(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)",
                    "source_name": "HELIX KITTEN"
                },
                {
                    "description": "This group was previously tracked under two distinct groups, APT34 and OilRig, but was combined due to additional reporting giving higher confidence about the overlap of the activity. (Citation: Unit 42 QUADAGENT July 2018) (Citation: FireEye APT34 Dec 2017)(Citation: Check Point APT34 April 2021)",
                    "source_name": "APT34"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2017/04/unit42-oilrig-actors-provide-glimpse-development-testing-efforts/",
                    "description": "Falcone, R.. (2017, April 27). OilRig Actors Provide a Glimpse into Development and Testing Efforts. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig April 2017"
                },
                {
                    "url": "http://www.clearskysec.com/oilrig/",
                    "description": "ClearSky Cybersecurity. (2017, January 5). Iranian Threat Agent OilRig Delivers Digitally Signed Malware, Impersonates University of Oxford. Retrieved May 3, 2017.",
                    "source_name": "ClearSky OilRig Jan 2017"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                },
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "url": "https://www.secureworks.com/research/threat-profiles/cobalt-gypsy",
                    "description": "Secureworks. (n.d.). COBALT GYPSY Threat Profile. Retrieved April 14, 2021.",
                    "source_name": "Secureworks COBALT GYPSY Threat Profile"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ],
            "aliases": [
                "OilRig",
                "COBALT GYPSY",
                "IRN2",
                "HELIX KITTEN",
                "APT34",
                "Twisted Kitten",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "IRN2",
                "Chrysene",
                "TA452",
                "ITG13",
                "ATK 40"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--0c03f2b4-a752-4d74-9c26-5306132a3329",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>hostname</code> and <code>systeminfo</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: FireEye APT34 July 2019)(Citation: Check Point APT34 April 2021)\t",
            "target_ref": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1",
            "modified": "2021-05-05T15:52:16.049Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--00c88cab-5cb9-492a-8dce-8eab92213bc3",
            "description": "(Citation: OilRig New Delivery Oct 2017)",
            "target_ref": "malware--5be33fef-39c0-4532-84ee-bea31e1b5324",
            "modified": "2019-09-04T22:55:41.899Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "OilRig New Delivery Oct 2017",
                    "description": "Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--0e6d61e2-7b61-4b6c-85c7-7779125c1d14",
            "description": "(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--7fcbc4e8-1989-441f-9ac5-e7b6ff5806f1",
            "modified": "2020-03-18T20:18:02.836Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--0fa0f5d6-be0b-4a48-938c-6d9bb8b1a170",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [Mimikatz](https://attack.mitre.org/software/S0002) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90",
            "modified": "2020-03-19T23:50:07.022Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--2dbed740-1b50-4d59-a729-a1d9e6a839df",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used web shells, often to maintain access to a victim network.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020)",
            "target_ref": "attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb",
            "modified": "2021-03-11T22:04:43.672Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf",
                    "description": "Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.",
                    "source_name": "Crowdstrike GTR2020 Mar 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--2ffc25c4-3939-40df-841c-91059c6879d4",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used .doc file extensions to mask malicious executables.(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0",
            "modified": "2021-10-13T13:30:46.939Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-05-05T15:52:15.799Z",
            "external_references": [
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--3beb0c09-e584-4fd8-92bb-d7a1ae9192e6",
            "description": "(Citation: Palo Alto OilRig May 2016)(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--2e45723a-31da-4a7e-aaa6-e01998a6788f",
            "modified": "2020-03-18T20:18:02.853Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--3c367277-6168-4df8-b982-e9949994123d",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has abused the Outlook Home Page feature for persistence. [OilRig](https://attack.mitre.org/groups/G0049) has also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.(Citation: FireEye Outlook Dec 2019)",
            "target_ref": "attack-pattern--bf147104-abf9-4221-95d1-e81585859441",
            "modified": "2020-06-24T00:26:37.174Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-06-24T00:26:37.174Z",
            "external_references": [
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/12/breaking-the-rules-tough-outlook-for-home-page-attacks.html",
                    "description": "McWhirt, M., Carr, N., Bienstock, D. (2019, December 4). Breaking the Rules: A Tough Outlook for Home Page Attacks (CVE-2017-11774). Retrieved June 23, 2020.",
                    "source_name": "FireEye Outlook Dec 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--3fb836b7-41cf-40d1-bd56-14e45e6bbd02",
            "description": "(Citation: Palo Alto OilRig May 2016)(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--03342581-f790-4f03-ba41-e82e67392e23",
            "modified": "2020-03-18T20:18:02.891Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--4fde23ab-b8db-4275-ac37-37e608cb00b0",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig New Delivery Oct 2017)(Citation: Crowdstrike Helix Kitten Nov 2018)",
            "target_ref": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
            "modified": "2020-03-18T20:18:02.553Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "OilRig New Delivery Oct 2017",
                    "description": "Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--5e39caf2-083b-4e4c-b04f-d83c512341cb",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain.(Citation: FireEye Targeted Attacks Middle East Banks)",
            "target_ref": "attack-pattern--b6075259-dba3-44e9-87c7-e954f37ec0d5",
            "modified": "2020-03-18T20:18:02.930Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html",
                    "description": "Singh, S., Yin, H. (2016, May 22). https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html. Retrieved April 5, 2018.",
                    "source_name": "FireEye Targeted Attacks Middle East Banks"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--5f5af879-c239-416b-99ec-b46e2f9926a2",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group \u201cdomain admins\u201d /domain</code>, and <code>net group \u201cExchange Trusted Subsystem\u201d /domain</code> to get account listings on a victim.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af",
            "modified": "2020-03-18T20:18:02.511Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--07a550a2-27c1-43f5-8b30-c288441ad5b0",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used custom DNS Tunneling protocols for C2.(Citation: Unit 42 Playbook Dec 2017)",
            "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00",
            "modified": "2019-09-04T22:55:40.675Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--7f80cb84-3cb5-4de3-a484-1c0a60e2dbcf",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used VBSscipt macros for execution on compromised hosts.(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67",
            "modified": "2021-10-13T13:30:46.576Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-10-13T13:30:46.576Z",
            "external_references": [
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--7f7226d7-6980-402a-b10e-e81b50c7ee09",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used brute force techniques to obtain credentials.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd",
            "modified": "2019-09-04T22:55:41.145Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8b42462a-0d66-4740-8f48-0857ab523370",
            "description": "(Citation: FireEye APT35 2018)",
            "target_ref": "tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b",
            "modified": "2019-09-04T22:55:41.872Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-01-30T17:04:29.735Z",
            "external_references": [
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8dd1ec07-e429-473d-84db-125fd22ab709",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used tools to identify if a mouse is connected to a targeted system.(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643",
            "modified": "2021-10-13T13:35:17.100Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-10-13T13:35:17.100Z",
            "external_references": [
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8dfb6f79-5a9a-4eb8-9b25-40d82ff0f668",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used DNS for C2 including the publicly available <code>requestbin.net</code> tunneling service.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72",
            "modified": "2021-05-05T16:05:44.234Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-17T02:02:46.920Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8e9f95f0-4939-4e74-9073-70efddddff50",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) can download remote files onto victims.(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add",
            "modified": "2020-03-18T20:18:02.907Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8edb0383-cae8-43ee-9241-b25e5068cc95",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>netstat -an</code> on a victim to get a listing of network connections.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475",
            "modified": "2019-09-04T22:55:41.139Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--12daddcc-b964-485e-8c2d-10f554d78bcc",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP.(Citation: OilRig ISMAgent July 2017)",
            "target_ref": "attack-pattern--f24faf46-3b26-4dbb-98f2-63460498e433",
            "modified": "2019-09-04T22:55:41.315Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/",
                    "description": "Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018.",
                    "source_name": "OilRig ISMAgent July 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--26cee727-2047-4ea9-b3bd-1115431aa633",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used macros to deliver malware such as [QUADAGENT](https://attack.mitre.org/software/S0269) and [OopsIE](https://attack.mitre.org/software/S0264).(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018) [OilRig](https://attack.mitre.org/groups/G0049) has used batch scripts.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018)",
            "target_ref": "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62",
            "modified": "2020-03-20T17:37:14.709Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-20T02:37:24.768Z",
            "external_references": [
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "source_name": "FireEye APT34 Dec 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/",
                    "description": "Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018.",
                    "source_name": "OilRig ISMAgent July 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "source_name": "Unit 42 QUADAGENT July 2018"
                },
                {
                    "source_name": "Unit42 OilRig Nov 2018",
                    "description": "Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig\u2019s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.",
                    "url": "https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "source_name": "FireEye APT34 Dec 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/",
                    "description": "Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018.",
                    "source_name": "OilRig ISMAgent July 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "source_name": "Unit 42 QUADAGENT July 2018"
                },
                {
                    "source_name": "Unit42 OilRig Nov 2018",
                    "description": "Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig\u2019s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.",
                    "url": "https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--27ead6bc-2bba-49d3-bcfe-667c7654a6fc",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020)",
            "target_ref": "attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf",
            "modified": "2020-12-22T18:05:30.596Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf",
                    "description": "Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.",
                    "source_name": "Crowdstrike GTR2020 Mar 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--39ce32d3-7721-4008-b74d-3549b7bb8fa7",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group \u201cdomain admins\u201d /domain</code>, and <code>net group \u201cExchange Trusted Subsystem\u201d /domain</code> to get account listings on a victim.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--25659dd6-ea12-45c4-97e6-381e3e4b593e",
            "modified": "2020-03-18T20:18:02.094Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-18T20:18:02.094Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--45cd89d8-68fd-42a2-94ba-7796a696bc47",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has a tool called CANDYKING to capture a screenshot of user's desktop.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688",
            "modified": "2019-09-04T22:55:40.729Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--51f1d23c-1ccd-4cc4-918c-39e9a66e510b",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has deleted files associated with their payload after execution.(Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 OopsIE! Feb 2018)",
            "target_ref": "attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c",
            "modified": "2020-03-18T20:18:02.230Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "Unit 42 OopsIE! Feb 2018",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--52d3e8a9-8801-497f-b1e1-6d45e196c79b",
            "description": "(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "malware--09b2cd76-c674-47cc-9f57-d2f2ad150a46",
            "modified": "2020-03-18T20:18:02.946Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--55e34506-746d-4895-928b-72c2e358161d",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) uses remote services such as VPN, Citrix, or OWA to persist in an environment.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d",
            "modified": "2019-09-04T22:55:41.005Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--65b58e05-916b-4840-b0a0-bb7fd8dc3f32",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
            "modified": "2020-03-19T23:50:06.540Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T23:50:06.540Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--72d6fe7e-ba33-4117-8153-64226f189ed2",
            "description": "(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "tool--294e2560-bd48-44b2-9da2-833b5588ad11",
            "modified": "2019-09-04T22:55:41.874Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--99ec87aa-5e07-4d47-8d29-6614850c88b5",
            "description": "(Citation: Check Point APT34 April 2021)",
            "target_ref": "malware--df4cd566-ff2f-4d08-976d-8c86e95782de",
            "modified": "2021-05-06T14:57:19.309Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-05-06T14:57:19.309Z",
            "external_references": [
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--352e990d-48be-4d1a-bd8a-bc27d641aa1f",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used a CHM payload to load and execute another malicious file once delivered to a victim.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--a6937325-9321-4e2e-bb2b-3ed2d40b2a9d",
            "modified": "2019-09-04T22:55:41.325Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--393a3ec4-9970-44ab-ae63-1e9c6bed0310",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88",
            "modified": "2019-09-04T22:55:40.870Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--431ec495-5f92-40e9-9955-58ca334ea3c8",
            "description": "(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--0a68f1f1-da74-4d28-8d9a-696c082706cc",
            "modified": "2020-03-18T20:18:02.878Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--557d3feb-0699-429e-bc83-ff114cf138ef",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has delivered macro-enabled documents that required targets to click the \"enable content\" button to execute the payload on the system.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e",
            "modified": "2021-05-05T15:32:45.441Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--596a70db-9d67-4d1e-8509-808fbb6168f3",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used port 80 to call back to the C2 server.(Citation: FireEye APT34 July 2019)\t",
            "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e",
            "modified": "2019-09-04T22:55:41.561Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-08-26T17:00:30.946Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--632ca9a0-a9f3-4b27-96e1-9fcb8bab11cb",
            "target_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "modified": "2018-10-17T00:14:20.652Z",
            "source_ref": "intrusion-set--68ba94ab-78b8-43e7-83e2-aed3466882c6",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "revoked-by",
            "created": "2018-10-17T00:14:20.652Z"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--952edf61-e906-4ab5-989f-1d6a5dd95dce",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has delivered malicious links to achieve execution on the target system.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)",
            "target_ref": "attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9",
            "modified": "2020-03-17T14:52:21.694Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-17T14:52:21.694Z",
            "external_references": [
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "source_name": "Unit 42 QUADAGENT July 2018"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--978d8c12-bf39-440f-ac17-b66970451152",
            "description": "(Citation: FireEye APT34 Dec 2017) (Citation: Palo Alto OilRig Sep 2018)",
            "target_ref": "malware--d5268dfb-ae2b-4e0e-ac07-02a460613d8a",
            "modified": "2020-03-18T20:18:02.875Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-02-18T20:17:17.641Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "Palo Alto OilRig Sep 2018",
                    "description": "Wilhoit, K. and Falcone, R. (2018, September 12). OilRig Uses Updated BONDUPDATER to Target Middle Eastern Government. Retrieved February 18, 2019.",
                    "url": "https://unit42.paloaltonetworks.com/unit42-oilrig-uses-updated-bondupdater-target-middle-eastern-government/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--1652bf3a-085a-4388-839a-04858b14affd",
            "description": "(Citation: Unit 42 QUADAGENT July 2018)",
            "target_ref": "malware--7e6c2a9d-9dc1-4eb0-b27c-91e8076a9d77",
            "modified": "2019-09-04T22:55:41.903Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--3127bcf3-3638-4c1b-9a95-156f6c78658a",
            "description": "(Citation: Unit 42 OopsIE! Feb 2018)",
            "target_ref": "malware--8e101fdd-9f7f-4916-bb04-6bd9e94c129c",
            "modified": "2019-09-04T22:55:41.892Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Unit 42 OopsIE! Feb 2018",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--4923be5e-dd24-4289-adca-e9dbf545b9c2",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>sc query</code> on a victim to gather information about services.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa",
            "modified": "2019-09-04T22:55:41.129Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--5744b31d-6633-44ca-8170-17489fec124c",
            "description": "(Citation: Palo Alto OilRig May 2016)(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--4664b683-f578-434f-919b-1c1aad2a1111",
            "modified": "2020-03-18T20:18:02.883Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--8272bde7-817f-4cb4-b073-67859002d310",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious links to potential victims.(Citation: Unit 42 OopsIE! Feb 2018)",
            "target_ref": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
            "modified": "2019-09-04T22:55:41.311Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Unit 42 OopsIE! Feb 2018",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--9779ccbc-c376-4a6e-a43f-56a782892302",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used compromised credentials to access other systems on a victim network.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike GTR2020 Mar 2020)",
            "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81",
            "modified": "2020-12-22T18:05:31.184Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf",
                    "description": "Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.",
                    "source_name": "Crowdstrike GTR2020 Mar 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--024593ae-03a1-4ffa-a5fc-fc2fe43e6ebf",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tool named VALUEVAULT to steal credentials from the Windows Credential Manager.(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--d336b553-5da9-46ca-98a8-0b23f49fb447",
            "modified": "2020-11-23T17:35:43.337Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-11-23T17:35:43.337Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--67469b79-67e2-4932-9776-b09a82871723",
            "description": "A [OilRig](https://attack.mitre.org/groups/G0049) macro has run a PowerShell command to decode file contents. [OilRig](https://attack.mitre.org/groups/G0049) has also used [certutil](https://attack.mitre.org/software/S0160) to decode base64-encoded files on victims.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig New Delivery Oct 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Crowdstrike GTR2020 Mar 2020)",
            "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c",
            "modified": "2021-03-12T16:36:07.554Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/",
                    "description": "Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018.",
                    "source_name": "OilRig New Delivery Oct 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "url": "https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf",
                    "description": "Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.",
                    "source_name": "Crowdstrike GTR2020 Mar 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--70495f42-0a81-485c-8f30-c75af61f1c6a",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has exfiltrated data over FTP separately from its primary C2 channel over DNS.(Citation: Palo Alto OilRig Oct 2016)",
            "target_ref": "attack-pattern--fb8d023d-45be-47e9-bc51-f56bcae6435b",
            "modified": "2020-03-16T18:04:34.423Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--99686b3a-1ca4-4b36-ad4d-a8876d8c65ba",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) used the Plink utility and other tools to create tunnels to C2 servers.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--bf176076-b789-408e-8cba-7275e81c0ada",
            "modified": "2020-03-21T00:14:24.136Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--166326b3-6864-4667-aee9-4d7b24cc75d8",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used HTTP for C2.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161",
            "modified": "2020-03-17T02:02:47.606Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--409581f2-270d-43ce-8044-34bc09874548",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>net group /domain</code>, <code>net group \u201cdomain admins\u201d /domain</code>, and <code>net group \u201cExchange Trusted Subsystem\u201d /domain</code> to find domain group permission settings.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c",
            "modified": "2020-03-18T22:50:09.035Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-18T22:50:09.035Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--0783831d-da64-4bb3-a54e-c5149e7e0d76",
            "description": "(Citation: Unit42 RDAT July 2020)",
            "target_ref": "malware--4b346d12-7f91-48d2-8f06-b26ffa0d825b",
            "modified": "2020-10-15T23:51:41.311Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-10-15T23:51:41.311Z",
            "external_references": [
                {
                    "url": "https://unit42.paloaltonetworks.com/oilrig-novel-c2-channel-steganography/",
                    "description": "Falcone, R. (2020, July 22). OilRig Targets Middle Eastern Telecommunications Organization and Adds Novel C2 Channel with Steganography to Its Inventory. Retrieved July 28, 2020.",
                    "source_name": "Unit42 RDAT July 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--49404706-aa42-4914-a273-2eeb217e6477",
            "description": "(Citation: Palo Alto OilRig May 2016)(Citation: FireEye APT34 Dec 2017)",
            "target_ref": "tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f",
            "modified": "2020-03-18T20:18:02.870Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a1e16836-d6d9-4d47-bb9a-35f31f369980",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has created scheduled tasks that run a VBScript to execute a payload on victim machines.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: FireEye APT34 July 2019)(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
            "modified": "2021-05-05T15:52:16.163Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a8d7e4da-53d8-45c2-8c87-70424d96a949",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used keylogging tools called KEYPUNCH and LONGWATCH.(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)\t\n",
            "target_ref": "attack-pattern--09a60ea3-a8d1-4ae5-976e-5783248b72a4",
            "modified": "2020-03-16T20:14:22.874Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a025d011-6e46-4d3a-a9f7-31324027b7cf",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Crowdstrike Helix Kitten Nov 2018)",
            "target_ref": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
            "modified": "2019-09-04T22:55:41.305Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Unit 42 OopsIE! Feb 2018",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--a24299ed-9735-453c-bd13-66269b2d5d16",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used automated collection.(Citation: Unit 42 Playbook Dec 2017)",
            "target_ref": "attack-pattern--30208d3e-0d6b-43c8-883e-44462a514619",
            "modified": "2019-09-04T22:55:40.734Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--ae1de9c5-6bc0-459a-b4ca-568139a5ee41",
            "description": "(Citation: Palo Alto OilRig May 2016)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: Crowdstrike Helix Kitten Nov 2018)",
            "target_ref": "malware--eff1a885-6f90-42a1-901f-eef6e7a1905e",
            "modified": "2019-09-04T22:55:41.897Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b3d6abc5-11da-4d0c-a699-8cafac03dfab",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used LinkedIn to send spearphishing links.(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--f6ad61ee-65f3-4bd0-a3f5-2f0accb36317",
            "modified": "2021-05-05T15:36:12.577Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-08-26T17:00:30.957Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 July 2019",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b6c44630-d1d0-467c-a84d-83564a3a0639",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used the Plink utility and other tools to create tunnels to C2 servers.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--4fe28b27-b13c-453e-a386-c2ef362a573b",
            "modified": "2020-03-17T02:02:46.878Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-17T02:02:46.878Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                },
                {
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "source_name": "FireEye APT34 Webinar Dec 2017"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--b22cebe6-129a-41a2-8a9e-70c222c88af6",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>whoami</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104",
            "modified": "2021-05-05T15:55:59.132Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--bd0cff5e-762e-4ba0-ab42-9bfe84e8db4f",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used WMI for execution.(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055",
            "modified": "2019-09-04T22:55:40.997Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--bd83109f-198a-43b0-a4c9-c13dd671c2da",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used Putty to access compromised systems.(Citation: Unit 42 Playbook Dec 2017)",
            "target_ref": "attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6",
            "modified": "2020-03-17T16:56:12.674Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--c27b0834-d1b8-440f-9b35-e15e78ecd715",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0",
            "modified": "2020-03-19T23:50:06.591Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T23:50:06.591Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--cd95d72d-033c-4881-b233-70983106cbfa",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530",
            "modified": "2020-03-19T23:50:06.570Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T23:50:06.570Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--cdbfa147-52be-411d-bcbd-f6dcbf91d7b5",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has encrypted and encoded data in its malware, including by using base64.(Citation: FireEye APT34 Dec 2017)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit 42 Playbook Dec 2017)(Citation: Crowdstrike Helix Kitten Nov 2018)(Citation: Unit42 OilRig Nov 2018)",
            "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a",
            "modified": "2020-03-18T20:18:02.573Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "Crowdstrike Helix Kitten Nov 2018",
                    "description": "Meyers, A. (2018, November 27). Meet CrowdStrike\u2019s Adversary of the Month for November: HELIX KITTEN. Retrieved December 18, 2018.",
                    "url": "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-november-helix-kitten/"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/",
                    "description": "Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig\u2019s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.",
                    "source_name": "Unit42 OilRig Nov 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d8e375a3-f455-4c66-bc63-251f320ec8b1",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>tasklist</code> on a victim's machine.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580",
            "modified": "2019-09-04T22:55:40.600Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d39e3775-9221-4020-b826-edc111e36c7c",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>net localgroup administrators</code> to find local administrators on compromised systems.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--a01bf75f-00b2-4568-a58f-565ff9bf202b",
            "modified": "2020-03-18T22:50:09.228Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--d705df92-50a0-4810-a893-979f73c6cdc8",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc",
            "modified": "2020-03-19T23:50:07.172Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2019-08-26T17:00:30.936Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--dafc7834-fbb5-426c-adce-957742078002",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access.(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)(Citation: FireEye APT34 July 2019) [OilRig](https://attack.mitre.org/groups/G0049) has also used tool named PICKPOCKET to dump passwords from web browsers.(Citation: FireEye APT34 July 2019)",
            "target_ref": "attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8",
            "modified": "2020-11-23T17:35:43.923Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2020-03-19T23:50:06.593Z",
            "external_references": [
                {
                    "source_name": "Unit 42 Playbook Dec 2017",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "url": "https://pan-unit42.github.io/playbook_viewer/"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2019/07/hard-pass-declining-apt34-invite-to-join-their-professional-network.html",
                    "description": "Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34\u2019s Invite to Join Their Professional Network. Retrieved August 26, 2019.",
                    "source_name": "FireEye APT34 July 2019"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e1a3f5df-963d-4211-931e-02ed9c567168",
            "description": "(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db",
            "modified": "2019-09-04T22:55:41.901Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e2def7f8-7c68-4ed6-b801-260b24a67409",
            "description": "(Citation: FireEye APT34 Webinar Dec 2017)",
            "target_ref": "malware--0998045d-f96e-4284-95ce-3c8219707486",
            "modified": "2019-09-04T22:55:41.552Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e8ce10b4-3b00-40c1-983a-1d87ff9a68ee",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used various types of scripting for execution.(Citation: FireEye APT34 Dec 2017)(Citation: OilRig ISMAgent July 2017)(Citation: Unit 42 OopsIE! Feb 2018)(Citation: Unit 42 QUADAGENT July 2018)(Citation: Unit42 OilRig Nov 2018)",
            "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830",
            "modified": "2020-03-20T17:37:14.727Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "source_name": "OilRig ISMAgent July 2017",
                    "description": "Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2017/07/unit42-oilrig-uses-ismdoor-variant-possibly-linked-greenbug-threat-group/"
                },
                {
                    "source_name": "Unit 42 OopsIE! Feb 2018",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/",
                    "description": "Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig\u2019s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.",
                    "source_name": "Unit42 OilRig Nov 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e30c24d3-d440-4395-88b3-3192a02c4364",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>reg query \u201cHKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u201d</code> on a victim to query the Registry.(Citation: Palo Alto OilRig May 2016)",
            "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896",
            "modified": "2019-09-04T22:55:41.133Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e0301b36-c339-49c5-b257-9ece19152922",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>ipconfig /all</code> on a victim.(Citation: Palo Alto OilRig May 2016)(Citation: Palo Alto OilRig Oct 2016)",
            "target_ref": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
            "modified": "2019-09-04T22:55:41.135Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "source_name": "Palo Alto OilRig May 2016",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--e94576ee-284c-4782-a6ef-b7dd8a780254",
            "description": "(Citation: Unit 42 Playbook Dec 2017)(Citation: FireEye APT34 Webinar Dec 2017)(Citation: FireEye APT35 2018)",
            "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60",
            "modified": "2019-09-04T22:55:41.562Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "https://pan-unit42.github.io/playbook_viewer/",
                    "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.",
                    "source_name": "Unit 42 Playbook Dec 2017"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf",
                    "description": "Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.",
                    "source_name": "FireEye APT35 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--eacf7d8c-c60c-4d4b-af28-57c015a54c55",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has used macros to verify if a mouse is connected to a compromised machine.(Citation: Check Point APT34 April 2021)",
            "target_ref": "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6",
            "modified": "2021-05-05T15:52:15.819Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2021-05-05T15:52:15.819Z",
            "external_references": [
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--fa224c64-2157-4c2f-9f9c-451a3923cc42",
            "description": "(Citation: Unit 42 RGDoor Jan 2018)",
            "target_ref": "malware--b9eec47e-98f4-4b3c-b574-3fa8a87ebe05",
            "modified": "2019-09-04T22:55:41.567Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-10-17T00:14:20.652Z",
            "external_references": [
                {
                    "source_name": "Unit 42 RGDoor Jan 2018",
                    "description": "Falcone, R. (2018, January 25). OilRig uses RGDoor IIS Backdoor on Targets in the Middle East. Retrieved July 6, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--fb6ffb5c-5405-4515-a120-7a34414933ea",
            "description": "[OilRig](https://attack.mitre.org/groups/G0049) has tested malware samples to determine AV detection and subsequently modified the samples to ensure AV evasion.(Citation: Palo Alto OilRig April 2017)(Citation: Unit42 OilRig Nov 2018)",
            "target_ref": "attack-pattern--b0533c6e-8fea-4788-874f-b799cacc4b92",
            "modified": "2019-09-04T22:55:41.337Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2017-12-14T16:46:06.044Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2017/04/unit42-oilrig-actors-provide-glimpse-development-testing-efforts/",
                    "description": "Falcone, R.. (2017, April 27). OilRig Actors Provide a Glimpse into Development and Testing Efforts. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig April 2017"
                },
                {
                    "source_name": "Unit42 OilRig Nov 2018",
                    "description": "Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig\u2019s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.",
                    "url": "https://unit42.paloaltonetworks.com/unit42-analyzing-oilrigs-ops-tempo-testing-weaponization-delivery/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "relationship",
            "id": "relationship--fd518b7a-b35d-4689-89f6-525efbeee18f",
            "description": "(Citation: Palo Alto OilRig Oct 2016)",
            "target_ref": "tool--cf23bf4a-e003-4116-bbae-1ea6c558d565",
            "modified": "2019-09-04T22:55:41.885Z",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "relationship_type": "uses",
            "created": "2018-01-16T16:13:52.465Z",
            "external_references": [
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/10/unit42-oilrig-malware-campaign-updates-toolset-and-expands-targets/",
                    "description": "Grunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig Oct 2016"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-07-28T18:05:24.567Z",
            "name": "Local Account",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "File: File Access"
            ],
            "x_mitre_version": "1.2",
            "created": "2020-02-21T21:07:55.393Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--25659dd6-ea12-45c4-97e6-381e3e4b593e",
            "description": "Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.\n\nCommands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code>on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS the <code>dscl . list /Users</code> command can be used to enumerate local accounts.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Daniel Stepanic, Elastic"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nMonitor for processes that can be used to enumerate user accounts, such as <code>net.exe</code> and <code>net1.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1087/001",
                    "external_id": "T1087.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql",
                    "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.",
                    "source_name": "Elastic - Koadiac Detection with EQL"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Domain Account",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-10-13T14:05:14.784Z",
            "created": "2020-02-21T21:08:26.480Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--21875073-b0ee-49e3-9077-1e2a885359af",
            "description": "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior.\n\nCommands such as <code>net user /domain</code> and <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscacheutil -q group</code>on macOS, and <code>ldapsearch</code> on Linux can list domain users and groups.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1087/002",
                    "external_id": "T1087.002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/575.html",
                    "external_id": "CAPEC-575",
                    "source_name": "capec"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-26T20:15:35.821Z",
            "name": "Web Protocols",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-03-15T16:13:46.151Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161",
            "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for web traffic to/from known-bad or suspicious domains. ",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1071/001",
                    "external_id": "T1071.001",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "DNS",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-10-21T16:26:34.196Z",
            "created": "2020-03-15T16:27:31.768Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--1996eef1-ced3-4d7f-bf94-33298cabbf72",
            "description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nThe DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.(Citation: PAN DNS Tunneling)(Citation: Medium DnsTunneling) ",
            "x_mitre_contributors": [
                "Jan Petrov, Citi"
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\n\nMonitor for DNS traffic to/from known-bad or suspicious domains.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1071/004",
                    "external_id": "T1071.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.paloaltonetworks.com/cyberpedia/what-is-dns-tunneling",
                    "description": "Palo Alto Networks. (n.d.). What Is DNS Tunneling?. Retrieved March 15, 2020.",
                    "source_name": "PAN DNS Tunneling"
                },
                {
                    "url": "https://medium.com/@galolbardes/learn-how-easy-is-to-bypass-firewalls-using-dns-tunneling-and-also-how-to-block-it-3ed652f4a000",
                    "description": "Galobardes, R. (2018, October 30). Learn how easy is to bypass firewalls using DNS tunneling (and also how to block it). Retrieved March 15, 2020.",
                    "source_name": "Medium DnsTunneling"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Automated Collection",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1119",
                    "external_id": "T1119",
                    "source_name": "mitre-attack"
                }
            ],
            "x_mitre_data_sources": [
                "File: File Access",
                "Command: Command Execution",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-31T22:18:43.019Z",
            "x_mitre_system_requirements": [
                "Permissions to access directories and files that store information of interest."
            ],
            "id": "attack-pattern--30208d3e-0d6b-43c8-883e-44462a514619",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059) to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools. \n\nThis technique may incorporate use of other techniques such as [File and Directory Discovery](https://attack.mitre.org/techniques/T1083) and [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570) to identify and move files.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Depending on the method used, actions could include common file system commands and parameters on the command-line interface within batch files or scripts. A sequence of actions like this may be unusual, depending on the system and network environment. Automated collection may occur along with other techniques such as [Data Staged](https://attack.mitre.org/techniques/T1074). As such, file access monitoring that shows an unusual process performing sequential file opens and potentially copy actions to another location on the file system for many files at once may indicate automated collection behavior. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created": "2017-05-31T21:31:27.985Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Brute Force",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "User Account: User Account Authentication",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-09-30T19:18:16.672Z",
            "created": "2017-05-31T21:31:22.767Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd",
            "x_mitre_platforms": [
                "Windows",
                "Azure AD",
                "Office 365",
                "SaaS",
                "IaaS",
                "Linux",
                "macOS",
                "Google Workspace",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained. Without knowledge of the password for an account or set of accounts, an adversary may systematically guess the password using a repetitive or iterative mechanism. Brute forcing passwords can take place via interaction with a service that will check the validity of those credentials or offline against previously acquired credential data, such as password hashes.\n\nBrute forcing credentials may take place at various points during a breach. For example, adversaries may attempt to brute force access to [Valid Accounts](https://attack.mitre.org/techniques/T1078) within a victim environment leveraging knowledge gathered from other post-compromise behaviors such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), [Account Discovery](https://attack.mitre.org/techniques/T1087), or [Password Policy Discovery](https://attack.mitre.org/techniques/T1201). Adversaries may also combine brute forcing activity with behaviors such as [External Remote Services](https://attack.mitre.org/techniques/T1133) as part of Initial Access.",
            "x_mitre_contributors": [
                "David Fiser, @anu4is, Trend Micro",
                "Alfredo Oliveira, Trend Micro",
                "Magno Logan, @magnologan, Trend Micro",
                "Yossi Weizman, Azure Defender Research Team",
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor authentication logs for system and application login failures of [Valid Accounts](https://attack.mitre.org/techniques/T1078). If authentication failures are high, then there may be a brute force attempt to gain access to a system using legitimate credentials. Also monitor for many failed authentication attempts across various accounts that may result from password spraying attempts. It is difficult to detect when hashes are cracked, since this is generally done outside the scope of the target network.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1110",
                    "external_id": "T1110",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/49.html",
                    "external_id": "CAPEC-49",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Command and Scripting Interpreter",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation",
                "Module: Module Load",
                "Script: Script Execution"
            ],
            "x_mitre_version": "2.2",
            "modified": "2021-08-16T21:03:21.700Z",
            "created": "2017-05-31T21:30:49.546Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "id": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830",
            "revoked": false,
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Network"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nThere are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).\n\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.\n\nIf scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059",
                    "external_id": "T1059",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.1",
                    "description": "Microsoft. (2020, August 21). Running Remote Commands. Retrieved July 26, 2021.",
                    "source_name": "Powershell Remote Commands"
                },
                {
                    "url": "https://tools.cisco.com/security/center/resources/integrity_assurance.html#23",
                    "description": "Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Command History. Retrieved October 21, 2020.",
                    "source_name": "Cisco IOS Software Integrity Assurance - Command History"
                },
                {
                    "url": "https://www.thepythoncode.com/article/executing-bash-commands-remotely-in-python",
                    "description": "Abdou Rockikz. (2020, July). How to Execute Shell Commands in a Remote Machine in Python. Retrieved July 26, 2021.",
                    "source_name": "Remote Shell Execution in Python"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-05-28T14:56:23.748Z",
            "name": "PowerShell",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Module: Module Load",
                "Process: Process Creation",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.1",
            "created": "2020-03-09T13:48:55.078Z",
            "x_mitre_contributors": [
                "Praetorian"
            ],
            "id": "attack-pattern--970a3432-3237-47ad-bcca-7d8cbb217736",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).\n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  [PowerSploit](https://attack.mitre.org/software/S0194), [PoshC2](https://attack.mitre.org/software/S0378), and PSAttack.(Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)(Citation: Microsoft PSfromCsharp APR 2014)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations).(Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features.(Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/001",
                    "external_id": "T1059.001",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "TechNet PowerShell",
                    "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016.",
                    "url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx"
                },
                {
                    "source_name": "Github PSAttack",
                    "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016.",
                    "url": "https://github.com/jaredhaight/PSAttack"
                },
                {
                    "url": "http://www.sixdub.net/?p=367",
                    "description": "Warner, J.. (2015, January 6). Inexorable PowerShell \u2013 A Red Teamer\u2019s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018.",
                    "source_name": "Sixdub PowerPick Jan 2016"
                },
                {
                    "url": "https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/",
                    "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018.",
                    "source_name": "SilentBreak Offensive PS Dec 2015"
                },
                {
                    "url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/",
                    "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019.",
                    "source_name": "Microsoft PSfromCsharp APR 2014"
                },
                {
                    "source_name": "Malware Archaeology PowerShell Cheat Sheet",
                    "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016.",
                    "url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf"
                },
                {
                    "source_name": "FireEye PowerShell Logging 2016",
                    "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016.",
                    "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-07-26T17:13:07.345Z",
            "name": "Windows Command Shell",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.2",
            "created": "2020-03-09T14:12:31.196Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--d1fcf083-a721-4223-aedf-bf8960798d62",
            "description": "Adversaries may abuse the Windows command shell for execution. The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [Remote Services](https://attack.mitre.org/techniques/T1021) such as [SSH](https://attack.mitre.org/techniques/T1021/004).(Citation: SSH in Windows)\n\nBatch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.\n\nAdversaries may leverage [cmd](https://attack.mitre.org/software/S0106) to execute various commands and payloads. Common uses include [cmd](https://attack.mitre.org/software/S0106) to execute a single command, or abusing [cmd](https://attack.mitre.org/software/S0106) interactively with input and output forwarded over a command and control channel.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Usage of the Windows command shell may be common on administrator, developer, or power user systems depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/003",
                    "external_id": "T1059.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/terminal/tutorials/ssh",
                    "description": "Microsoft. (2020, May 19). Tutorial: SSH in Windows Terminal. Retrieved July 26, 2021.",
                    "source_name": "SSH in Windows"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-08-16T21:03:21.051Z",
            "name": "Visual Basic",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation",
                "Module: Module Load",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.2",
            "created": "2020-03-09T14:29:51.508Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows",
                "macOS",
                "Linux"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--dfd7cc1d-e1d8-4394-a198-97c4cab8aa67",
            "description": "Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and the [Native API](https://attack.mitre.org/techniques/T1106) through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft)\n\nDerivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.(Citation: Microsoft VBA)(Citation: Wikipedia VBA) VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of [JavaScript](https://attack.mitre.org/techniques/T1059/007) on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).(Citation: Microsoft VBScript)\n\nAdversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_detection": "Monitor for events associated with VB execution, such as Office applications spawning processes, usage of the Windows Script Host (typically cscript.exe or wscript.exe), file activity involving VB payloads or scripts, or loading of modules associated with VB languages (ex: vbscript.dll). VB execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for execution and subsequent behavior. Actions may be related to network and system information [Discovery](https://attack.mitre.org/tactics/TA0007), [Collection](https://attack.mitre.org/tactics/TA0009), or other programable post-compromise behaviors and could be used as indicators of detection leading back to the source.\n\nUnderstanding standard usage patterns is important to avoid a high number of false positives. If VB execution is restricted for normal users, then any attempts to enable related components running on a system would be considered suspicious. If VB execution is not commonly used on a system, but enabled, execution running out of cycle from patching or other administrator functions is suspicious. Payloads and scripts should be captured from the file system when possible to determine their actions and intent.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1059/005",
                    "external_id": "T1059.005",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://devblogs.microsoft.com/vbteam/visual-basic-support-planned-for-net-5-0/",
                    "description": ".NET Team. (2020, March 11). Visual Basic support planned for .NET 5.0. Retrieved June 23, 2020.",
                    "source_name": "VB .NET Mar 2020"
                },
                {
                    "url": "https://docs.microsoft.com/dotnet/visual-basic/",
                    "description": "Microsoft. (n.d.). Visual Basic documentation. Retrieved June 23, 2020.",
                    "source_name": "VB Microsoft"
                },
                {
                    "url": "https://docs.microsoft.com/office/vba/api/overview/",
                    "description": "Microsoft. (2019, June 11). Office VBA Reference. Retrieved June 23, 2020.",
                    "source_name": "Microsoft VBA"
                },
                {
                    "url": "https://en.wikipedia.org/wiki/Visual_Basic_for_Applications",
                    "description": "Wikipedia. (n.d.). Visual Basic for Applications. Retrieved August 13, 2020.",
                    "source_name": "Wikipedia VBA"
                },
                {
                    "url": "https://docs.microsoft.com/previous-versions//1kw29xwf(v=vs.85)",
                    "description": "Microsoft. (2011, April 19). What Is VBScript?. Retrieved March 28, 2020.",
                    "source_name": "Microsoft VBScript"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Windows Credential Manager",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution",
                "File: File Access"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-04-29T21:00:18.973Z",
            "created": "2020-11-23T15:35:53.793Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--d336b553-5da9-46ca-98a8-0b23f49fb447",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may acquire credentials from the Windows Credential Manager. The Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos in Credential Lockers (previously known as Windows Vaults).(Citation: Microsoft Credential Manager store)(Citation: Microsoft Credential Locker)\n\nThe Windows Credential Manager separates website credentials from application or network credentials in two lockers. As part of [Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003), Internet Explorer and Microsoft Edge website credentials are managed by the Credential Manager and are stored in the Web Credentials locker. Application and network credentials are stored in the Windows Credentials locker.\n\nCredential Lockers store credentials in encrypted <code>.vcrd</code> files, located under <code>%Systemdrive%\\Users\\\\[Username]\\AppData\\Local\\Microsoft\\\\[Vault/Credentials]\\</code>. The encryption key can be found in a file named <code>Policy.vpol</code>, typically located in the same folder as the credentials.(Citation: passcape Windows Vault)(Citation: Malwarebytes The Windows Vault)\n\nAdversaries may list credentials managed by the Windows Credential Manager through several mechanisms. <code>vaultcmd.exe</code> is a native Windows executable that can be used to enumerate credentials stored in the Credential Locker through a command-line interface. Adversaries may gather credentials by reading files located inside of the Credential Lockers. Adversaries may also abuse Windows APIs such as <code>CredEnumerateA</code> to list credentials managed by the Credential Manager.(Citation: Microsoft CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager)\n\nAdversaries may use password recovery tools to obtain plain text passwords from the Credential Manager.(Citation: Malwarebytes The Windows Vault)",
            "x_mitre_contributors": [
                "Bernaldo Penas Antelo",
                "Mugdha Peter Bansode"
            ],
            "x_mitre_detection": "Monitor process and command-line parameters of <code>vaultcmd.exe</code> for suspicious activity, such as listing credentials from the Windows Credentials locker (i.e., <code>vaultcmd /listcreds:\u201cWindows Credentials\u201d</code>).(Citation: Malwarebytes The Windows Vault)\n\nConsider monitoring API calls such as <code>CredEnumerateA</code> that may list credentials from the Windows Credential Manager.(Citation: Microsoft CredEnumerate)(Citation: Delpy Mimikatz Crendential Manager)\n\nConsider monitoring file reads to Vault locations, <code>%Systemdrive%\\Users\\\\[Username]\\AppData\\Local\\Microsoft\\\\[Vault/Credentials]\\</code>, for suspicious activity.(Citation: Malwarebytes The Windows Vault)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1555/004",
                    "external_id": "T1555.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh994565(v=ws.11)#credential-manager-store",
                    "description": "Microsoft. (2016, August 31). Cached and Stored Credentials Technical Overview. Retrieved November 24, 2020.",
                    "source_name": "Microsoft Credential Manager store"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-8.1-and-8/jj554668(v=ws.11)?redirectedfrom=MSDN",
                    "description": "Microsoft. (2013, October 23). Credential Locker Overview. Retrieved November 24, 2020.",
                    "source_name": "Microsoft Credential Locker"
                },
                {
                    "url": "https://www.passcape.com/windows_password_recovery_vault_explorer",
                    "description": "Passcape. (n.d.). Windows Password Recovery - Vault Explorer and Decoder. Retrieved November 24, 2020.",
                    "source_name": "passcape Windows Vault"
                },
                {
                    "url": "https://blog.malwarebytes.com/101/2016/01/the-windows-vaults/ ",
                    "description": "Arntz, P. (2016, March 30). The Windows Vault . Retrieved November 23, 2020.",
                    "source_name": "Malwarebytes The Windows Vault"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/win32/api/wincred/nf-wincred-credenumeratea",
                    "description": "Microsoft. (2018, December 5). CredEnumarateA function (wincred.h). Retrieved November 24, 2020.",
                    "source_name": "Microsoft CredEnumerate"
                },
                {
                    "url": "https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials",
                    "description": "Delpy, B. (2017, December 12). howto ~ credential manager saved credentials. Retrieved November 23, 2020.",
                    "source_name": "Delpy Mimikatz Crendential Manager"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Credentials from Web Browsers",
            "x_mitre_data_sources": [
                "File: File Access",
                "Command: Command Execution",
                "Process: OS API Execution",
                "Process: Process Access"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-04-14T14:03:47.293Z",
            "created": "2020-02-12T18:57:36.041Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--58a3e6aa-4453-4cc8-a51f-4befe80b31a8",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.(Citation: Talos Olympic Destroyer 2018) Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.\n\nFor example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim\u2019s cached logon credentials as the decryption key. (Citation: Microsoft CryptUnprotectData April 2018)\n \nAdversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc.(Citation: Proofpoint Vega Credential Stealer May 2018)(Citation: FireEye HawkEye Malware July 2017) Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the [Windows Credential Manager](https://attack.mitre.org/techniques/T1555/004).\n\nAdversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.(Citation: GitHub Mimikittenz July 2016)\n\nAfter acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).",
            "x_mitre_contributors": [
                "Ryan Benson, Exabeam",
                "Barry Shteiman, Exabeam",
                "Sylvain Gil, Exabeam",
                "RedHuntLabs, @redhuntlabs"
            ],
            "x_mitre_detection": "Identify web browser files that contain credentials such as Google Chrome\u2019s Login Data database file: <code>AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data</code>. Monitor file read events of web browser files that contain credentials, especially when the reading process is unrelated to the subject web browser. Monitor process execution logs to include PowerShell Transcription focusing on those that perform a combination of behaviors including reading web browser process memory, utilizing regular expressions, and those that contain numerous keywords for common web applications (Gmail, Twitter, Office365, etc.).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1555/003",
                    "external_id": "T1555.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://blog.talosintelligence.com/2018/02/olympic-destroyer.html",
                    "description": "Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.",
                    "source_name": "Talos Olympic Destroyer 2018"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/desktop/api/dpapi/nf-dpapi-cryptunprotectdata",
                    "description": "Microsoft. (2018, April 12). CryptUnprotectData function. Retrieved June 18, 2019.",
                    "source_name": "Microsoft CryptUnprotectData April 2018"
                },
                {
                    "url": "https://www.proofpoint.com/us/threat-insight/post/new-vega-stealer-shines-brightly-targeted-campaign",
                    "description": "Proofpoint. (2018, May 10). New Vega Stealer shines brightly in targeted campaign . Retrieved June 18, 2019.",
                    "source_name": "Proofpoint Vega Credential Stealer May 2018"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2017/07/hawkeye-malware-distributed-in-phishing-campaign.html",
                    "description": "Swapnil Patil, Yogesh Londhe. (2017, July 25). HawkEye Credential Theft Malware Distributed in Recent Phishing Campaign. Retrieved June 18, 2019.",
                    "source_name": "FireEye HawkEye Malware July 2017"
                },
                {
                    "url": "https://github.com/putterpanda/mimikittenz",
                    "description": "Jamieson O'Reilly (putterpanda). (2016, July 4). mimikittenz. Retrieved June 20, 2019.",
                    "source_name": "GitHub Mimikittenz July 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Credentials from Password Stores",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "File: File Access",
                "Command: Command Execution",
                "Process: OS API Execution",
                "Process: Process Access"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-06-21T17:58:03.788Z",
            "created": "2020-02-11T18:48:28.456Z",
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--3fc9b85a-2862-4363-a64d-d692e3ffbee0",
            "description": "Adversaries may search for common password storage locations to obtain user credentials. Passwords are stored in several places on a system, depending on the operating system or application holding the credentials. There are also specific applications that store passwords to make it easier for users manage and maintain. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_detection": "Monitor system calls, file read events, and processes for suspicious activity that could indicate searching for a password  or other activity related to performing keyword searches (e.g. password, pwd, login, store, secure, credentials, etc.) in process memory for credentials. File read events should be monitored surrounding known password storage applications.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1555",
                    "external_id": "T1555",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Deobfuscate/Decode Files or Information",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "File: File Modification",
                "Script: Script Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-07-09T14:42:23.122Z",
            "created": "2017-12-14T16:46:06.044Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c",
            "x_mitre_defense_bypassed": [
                "Anti-virus",
                "Host intrusion prevention systems",
                "Signature-based detection",
                "Network intrusion detection system"
            ],
            "x_mitre_platforms": [
                "Windows",
                "Linux",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may use [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027) to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. Methods for doing that include built-in functionality of malware or by using utilities present on the system.\n\nOne such example is use of [certutil](https://attack.mitre.org/software/S0160) to decode a remote access tool portable executable file that has been hidden inside a certificate file. (Citation: Malwarebytes Targeted Attack against Saudi Arabia) Another example is using the Windows <code>copy /b</code> command to reassemble binary fragments into a malicious payload. (Citation: Carbon Black Obfuscation Sept 2016)\n\nSometimes a user's action may be required to open it for deobfuscation or decryption as part of [User Execution](https://attack.mitre.org/techniques/T1204). The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016)",
            "x_mitre_contributors": [
                "Matthew Demaske, Adaptforward",
                "Red Canary"
            ],
            "x_mitre_detection": "Detecting the action of deobfuscating or decoding files or information may be difficult depending on the implementation. If the functionality is contained within malware and uses the Windows API, then attempting to detect malicious behavior before or after the action may yield better results than attempting to perform analysis on loaded libraries or API calls. If scripts are used, then collecting the scripts for analysis may be necessary. Perform process and command-line monitoring to detect potentially malicious behavior related to scripts and system utilities such as [certutil](https://attack.mitre.org/software/S0160).\n\nMonitor the execution file paths and command-line arguments for common archive file applications and extensions, such as those for Zip and RAR archive tools, and correlate with other suspicious behavior to reduce false positives from normal user and administrator behavior.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1140",
                    "external_id": "T1140",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Malwarebytes Targeted Attack against Saudi Arabia",
                    "description": "Malwarebytes Labs. (2017, March 27). New targeted attack against Saudi Arabia Government. Retrieved July 3, 2017.",
                    "url": "https://blog.malwarebytes.com/cybercrime/social-engineering-cybercrime/2017/03/new-targeted-attack-saudi-arabia-government/"
                },
                {
                    "source_name": "Carbon Black Obfuscation Sept 2016",
                    "description": "Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018.",
                    "url": "https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/"
                },
                {
                    "source_name": "Volexity PowerDuke November 2016",
                    "description": "Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.",
                    "url": "https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-04-20T19:27:46.484Z",
            "name": "Asymmetric Cryptography",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-03-16T15:48:33.882Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--bf176076-b789-408e-8cba-7275e81c0ada",
            "description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiver\u2019s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.\n\nFor efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1573/002).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "SSL/TLS inspection is one way of detecting command and control traffic within some encrypted communication channels.(Citation: SANS Decrypting SSL) SSL/TLS inspection does come with certain risks that should be considered before implementing to avoid potential security issues such as incomplete certificate validation.(Citation: SEI SSL Inspection Risks)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1573/002",
                    "external_id": "T1573.002",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "SANS Decrypting SSL",
                    "description": "Butler, M. (2013, November). Finding Hidden Threats by Decrypting SSL. Retrieved April 5, 2016.",
                    "url": "http://www.sans.org/reading-room/whitepapers/analyst/finding-hidden-threats-decrypting-ssl-34840"
                },
                {
                    "source_name": "SEI SSL Inspection Risks",
                    "description": "Dormann, W. (2015, March 13). The Risks of SSL Inspection. Retrieved April 5, 2016.",
                    "url": "https://insights.sei.cmu.edu/cert/2015/03/the-risks-of-ssl-inspection.html"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1048/003",
                    "external_id": "T1048.003",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ],
            "x_mitre_data_sources": [
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Traffic Content",
                "File: File Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-10-15T22:49:28.421Z",
            "created": "2020-03-15T15:37:47.583Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "exfiltration"
                }
            ],
            "x_mitre_network_requirements": true,
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--fb8d023d-45be-47e9-bc51-f56bcae6435b",
            "description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. \n\nAdversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields. ",
            "x_mitre_contributors": [
                "William Cain"
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) ",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "External Remote Services",
            "x_mitre_data_sources": [
                "Application Log: Application Log Content",
                "Logon Session: Logon Session Metadata",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-08-19T16:57:27.209Z",
            "created": "2017-05-31T21:31:44.421Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "id": "attack-pattern--10d51417-ee35-4589-b1ff-b6df1c334e8d",
            "x_mitre_platforms": [
                "Windows",
                "Linux",
                "Containers",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) and [VNC](https://attack.mitre.org/techniques/T1021/005) can also be used externally.(Citation: MacOS VNC software for Remote Desktop)\n\nAccess to [Valid Accounts](https://attack.mitre.org/techniques/T1078) to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.(Citation: Volexity Virtual Private Keylogging) Access to remote services may be used as a redundant or persistent access mechanism during an operation.\n\nAccess may also be gained through an exposed service that doesn\u2019t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.(Citation: Trend Micro Exposed Docker Server)(Citation: Unit 42 Hildegard Malware)",
            "x_mitre_contributors": [
                "ExtraHop",
                "David Fiser, @anu4is, Trend Micro",
                "Alfredo Oliveira, Trend Micro",
                "Idan Frimark, Cisco",
                "Rory McCune, Aqua Security",
                "Yuval Avrahami, Palo Alto Networks",
                "Jay Chen, Palo Alto Networks",
                "Brad Geesaman, @bradgeesaman",
                "Magno Logan, @magnologan, Trend Micro",
                "Ariel Shuper, Cisco",
                "Yossi Weizman, Azure Defender Research Team",
                "Vishwas Manral, McAfee",
                "Daniel Oakley",
                "Travis Smith, Tripwire"
            ],
            "x_mitre_detection": "Follow best practices for detecting adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078) for authenticating to remote services. Collect authentication logs and analyze for unusual access patterns, windows of activity, and access outside of normal business hours.\n\nWhen authentication is not required to access an exposed remote service, monitor for follow-on activities such as anomalous external use of the exposed API or application.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1133",
                    "external_id": "T1133",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/555.html",
                    "external_id": "CAPEC-555",
                    "source_name": "capec"
                },
                {
                    "url": "https://support.apple.com/guide/remote-desktop/set-up-a-computer-running-vnc-software-apdbed09830/mac",
                    "description": "Apple Support. (n.d.). Set up a computer running VNC software for Remote Desktop. Retrieved August 18, 2021.",
                    "source_name": "MacOS VNC software for Remote Desktop"
                },
                {
                    "source_name": "Volexity Virtual Private Keylogging",
                    "description": "Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017.",
                    "url": "https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/"
                },
                {
                    "url": "https://www.trendmicro.com/en_us/research/20/f/xorddos-kaiji-botnet-malware-variants-target-exposed-docker-servers.html",
                    "description": "Remillano II, A., et al. (2020, June 20). XORDDoS, Kaiji Variants Target Exposed Docker Servers. Retrieved April 5, 2021.",
                    "source_name": "Trend Micro Exposed Docker Server"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/",
                    "description": "Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.",
                    "source_name": "Unit 42 Hildegard Malware"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-07-14T19:49:47.340Z",
            "name": "Fallback Channels",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1008",
                    "external_id": "T1008",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ],
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Connection Creation"
            ],
            "x_mitre_version": "1.0",
            "created": "2017-05-31T21:30:21.689Z",
            "x_mitre_network_requirements": true,
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--f24faf46-3b26-4dbb-98f2-63460498e433",
            "description": "Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)",
            "x_mitre_platforms": [
                "Linux",
                "Windows",
                "macOS"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "File Deletion",
            "x_mitre_data_sources": [
                "File: File Deletion",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-29T21:34:16.209Z",
            "created": "2020-01-31T12:35:36.479Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--d63a3fb8-9452-4e9d-a60a-54be68d5998c",
            "x_mitre_defense_bypassed": [
                "Host forensic analysis"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n\nThere are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)",
            "x_mitre_contributors": [
                "Walker Johnson"
            ],
            "x_mitre_detection": "It may be uncommon for events related to benign command-line functions such as DEL or third-party utilities or tools to be found in an environment, depending on the user base and how systems are typically used. Monitoring for command-line deletion functions to correlate with binaries or other files that an adversary may drop and remove may lead to detection of malicious activity. Another good practice is monitoring for known deletion and secure deletion tools that are not already on systems within an enterprise network that an adversary could introduce. Some monitoring tools may collect command-line arguments, but may not capture DEL commands since DEL is a native function within cmd.exe.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1070/004",
                    "external_id": "T1070.004",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Trend Micro APT Attack Tools",
                    "description": "Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015.",
                    "url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-20T15:42:48.595Z",
            "name": "Ingress Tool Transfer",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content",
                "File: File Creation"
            ],
            "x_mitre_version": "2.0",
            "created": "2017-05-31T21:31:16.408Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add",
            "description": "Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Monitor for file creation and files transferred into the network. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as FTP, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.(Citation: University of Birmingham C2)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1105",
                    "external_id": "T1105",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-10-21T01:30:56.227Z",
            "name": "Keylogging",
            "x_mitre_data_sources": [
                "Windows Registry: Windows Registry Key Modification",
                "Driver: Driver Load",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.1",
            "created": "2020-02-11T18:58:11.791Z",
            "x_mitre_permissions_required": [
                "Administrator",
                "root",
                "SYSTEM",
                "User"
            ],
            "x_mitre_platforms": [
                "Windows",
                "macOS",
                "Linux",
                "Network"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--09a60ea3-a8d1-4ae5-976e-5783248b72a4",
            "description": "Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured.\n\nKeylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes.(Citation: Adventures of a Keystroke) Some methods include:\n\n* Hooking API callbacks used for processing keystrokes. Unlike [Credential API Hooking](https://attack.mitre.org/techniques/T1056/004), this focuses solely on API functions intended for processing keystroke data.\n* Reading raw keystroke data from the hardware buffer.\n* Windows Registry modifications.\n* Custom drivers.\n* [Modify System Image](https://attack.mitre.org/techniques/T1601) may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions.(Citation: Cisco Blog Legacy Device Attacks) ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_detection": "Keyloggers may take many forms, possibly involving modification to the Registry and installation of a driver, setting a hook, or polling to intercept keystrokes. Commonly used API calls include `SetWindowsHook`, `GetKeyState`, and `GetAsyncKeyState`.(Citation: Adventures of a Keystroke) Monitor the Registry and file system for such changes, monitor driver installs, and look for common keylogging API calls. API calls alone are not an indicator of keylogging, but may provide behavioral data that is useful when combined with other information such as new files written to disk and unusual processes.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1056/001",
                    "external_id": "T1056.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/568.html",
                    "external_id": "CAPEC-568",
                    "source_name": "capec"
                },
                {
                    "source_name": "Adventures of a Keystroke",
                    "description": "Tinaztepe,  E. (n.d.). The Adventures of a Keystroke:  An in-depth look into keyloggers on Windows. Retrieved April 27, 2016.",
                    "url": "http://opensecuritytraining.info/Keylogging_files/The%20Adventures%20of%20a%20Keystroke.pdf"
                },
                {
                    "url": "https://community.cisco.com/t5/security-blogs/attackers-continue-to-target-legacy-devices/ba-p/4169954",
                    "description": "Omar Santos. (2020, October 19). Attackers Continue to Target Legacy Devices. Retrieved October 20, 2020.",
                    "source_name": "Cisco Blog Legacy Device Attacks"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Masquerading",
            "x_mitre_data_sources": [
                "Image: Image Metadata",
                "Command: Command Execution",
                "Service: Service Metadata",
                "Service: Service Creation",
                "Scheduled Job: Scheduled Job Metadata",
                "Scheduled Job: Scheduled Job Modification",
                "File: File Metadata",
                "Process: Process Metadata",
                "File: File Modification"
            ],
            "x_mitre_version": "1.4",
            "modified": "2021-10-18T13:24:52.973Z",
            "created": "2017-05-31T21:30:38.511Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "x_mitre_defense_bypassed": [
                "Application control by file name or path"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0",
            "description": "Adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools. Masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. This may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.\n\nRenaming abusable system utilities to evade security monitoring is also a form of [Masquerading](https://attack.mitre.org/techniques/T1036).(Citation: LOLBAS Main Site)",
            "x_mitre_contributors": [
                "Oleg Kolesnikov, Securonix",
                "Nick Carr, Mandiant",
                "David Lu, Tripwire",
                "Felipe Esp\u00f3sito, @Pr0teus",
                "Elastic",
                "Bartosz Jerzman"
            ],
            "x_mitre_detection": "Collect file hashes; file names that do not match their expected hash are suspect. Perform file monitoring; files with known names but in unusual locations are suspect. Likewise, files that are modified outside of an update or patch are suspect.\n\nIf file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)\n\nLook for indications of common characters that may indicate an attempt to trick users into misidentifying the file type, such as a space as the last character of a file name or the right-to-left override characters\"\\u202E\", \"[U+202E]\", and \"%E2%80%AE\u201d.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1036",
                    "external_id": "T1036",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/177.html",
                    "external_id": "CAPEC-177",
                    "source_name": "capec"
                },
                {
                    "url": "https://lolbas-project.github.io/",
                    "description": "LOLBAS. (n.d.). Living Off The Land Binaries and Scripts (and also Libraries). Retrieved February 10, 2020.",
                    "source_name": "LOLBAS Main Site"
                },
                {
                    "url": "http://pages.endgame.com/rs/627-YBU-612/images/EndgameJournal_The%20Masquerade%20Ball_Pages_R2.pdf",
                    "description": "Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.",
                    "source_name": "Elastic Masquerade Ball"
                },
                {
                    "url": "https://twitter.com/ItsReallyNick/status/1055321652777619457",
                    "description": "Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved April 22, 2019.",
                    "source_name": "Twitter ItsReallyNick Masquerading Update"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Network Service Scanning",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Cloud Service: Cloud Service Enumeration",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.2",
            "modified": "2021-04-09T14:56:26.562Z",
            "created": "2017-05-31T21:30:43.915Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "id": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88",
            "x_mitre_platforms": [
                "Windows",
                "IaaS",
                "Linux",
                "macOS",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "Administrator",
                "SYSTEM",
                "User"
            ],
            "description": "Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system. \n\nWithin cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.",
            "x_mitre_contributors": [
                "Praetorian"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1046",
                    "external_id": "T1046",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/300.html",
                    "external_id": "CAPEC-300",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Indicator Removal from Tools",
            "x_mitre_version": "1.0",
            "modified": "2020-03-29T21:03:09.766Z",
            "created": "2020-03-19T21:27:32.820Z",
            "x_mitre_defense_bypassed": [
                "Anti-virus",
                "Host intrusion prevention systems",
                "Log analysis",
                "Signature-based detection"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--b0533c6e-8fea-4788-874f-b799cacc4b92",
            "description": "Adversaries may remove indicators from tools if they believe their malicious tool was detected, quarantined, or otherwise curtailed. They can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems.\n\nA good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature, and then re-use the malware.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "x_mitre_detection": "The first detection of a malicious tool may trigger an anti-virus or other security tool alert. Similar events may also occur at the boundary through network IDS, email scanning appliance, etc. The initial detection should be treated as an indication of a potentially more invasive intrusion. The alerting system should be thoroughly investigated beyond that initial alert for activity that was not detected. Adversaries may continue with an operation, assuming that individual events like an anti-virus detect will not be investigated or that an analyst will not be able to conclusively link that event to other activity occurring on the network.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1027/005",
                    "external_id": "T1027.005",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Outlook Home Page",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-08-16T21:30:01.743Z",
            "created": "2019-11-07T20:09:56.536Z",
            "x_mitre_permissions_required": [
                "Administrator",
                "User"
            ],
            "x_mitre_platforms": [
                "Windows",
                "Office 365"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--bf147104-abf9-4221-95d1-e81585859441",
            "description": "Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.(Citation: SensePost Outlook Home Page)\n\nOnce malicious home pages have been added to the user\u2019s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.(Citation: SensePost Outlook Home Page)\n",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "x_mitre_detection": "Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.(Citation: Microsoft Detect Outlook Forms) SensePost, whose tool [Ruler](https://attack.mitre.org/software/S0358) can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.(Citation: SensePost NotRuler)\n\nCollect process execution information including process IDs (PID) and parent process IDs (PPID) and look for abnormal chains of activity resulting from Office processes. Non-standard process execution trees may also indicate suspicious or malicious behavior.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1137/004",
                    "external_id": "T1137.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/",
                    "description": "Stalmans, E. (2017, October 11). Outlook Home Page \u2013 Another Ruler Vector. Retrieved February 4, 2019.",
                    "source_name": "SensePost Outlook Home Page"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/office365/securitycompliance/detect-and-remediate-outlook-rules-forms-attack",
                    "description": "Fox, C., Vangel, D. (2018, April 22). Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365. Retrieved February 4, 2019.",
                    "source_name": "Microsoft Detect Outlook Forms"
                },
                {
                    "url": "https://github.com/sensepost/notruler",
                    "description": "SensePost. (2017, September 21). NotRuler - The opposite of Ruler, provides blue teams with the ability to detect Ruler usage against Exchange. Retrieved February 4, 2019.",
                    "source_name": "SensePost NotRuler"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "LSA Secrets",
            "x_mitre_data_sources": [
                "Windows Registry: Windows Registry Key Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-04-21T21:12:38.361Z",
            "created": "2020-02-21T16:22:09.493Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--1ecfdab8-7d59-4c98-95d4-dc41970f57fc",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "SYSTEM"
            ],
            "description": "Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets)\n\n[Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)",
            "x_mitre_contributors": [
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/004",
                    "external_id": "T1003.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.passcape.com/index.php?section=docsys&cmd=details&id=23",
                    "description": "Passcape. (n.d.). Windows LSA secrets. Retrieved February 21, 2020.",
                    "source_name": "Passcape LSA Secrets"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material?redirectedfrom=MSDN",
                    "description": "Microsoft. (2019, February 14). Active Directory administrative tier model. Retrieved February 21, 2020.",
                    "source_name": "Microsoft AD Admin Tier Model"
                },
                {
                    "url": "https://www.first.org/resources/papers/conf2017/Windows-Credentials-Attacks-and-Mitigation-Techniques.pdf",
                    "description": "Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.",
                    "source_name": "Tilbury Windows Credentials"
                },
                {
                    "url": "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsa-secrets",
                    "description": "Mantvydas Baranauskas. (2019, November 16). Dumping LSA Secrets. Retrieved February 21, 2020.",
                    "source_name": "ired Dumping LSA Secrets"
                },
                {
                    "source_name": "Powersploit",
                    "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
                    "url": "https://github.com/mattifestation/PowerSploit"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "LSASS Memory",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Process: Process Access",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-10-15T19:55:01.368Z",
            "created": "2020-02-11T18:41:44.783Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--65f2d882-3f41-4d48-8a06-29af77ec9f90",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator",
                "SYSTEM"
            ],
            "description": "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run using:\n\n* <code>sekurlsa::Minidump lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\nBuilt-in Windows tools such as comsvcs.dll can also be used:\n\n* <code>rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full</code>(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages</code> and <code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n",
            "x_mitre_contributors": [
                "Edward Millington",
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor for unexpected processes interacting with LSASS.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as Mimikatz access LSASS.exe by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.\n\nOn Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.\n\nMonitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/001",
                    "external_id": "T1003.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/",
                    "description": "Gruzweig, J. et al. (2021, March 2). Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities. Retrieved March 3, 2021.",
                    "source_name": "Volexity Exchange Marauder March 2021"
                },
                {
                    "url": "https://symantec.broadcom.com/hubfs/Attacks-Against-Government-Sector.pdf",
                    "description": "Symantec. (2021, June 10). Attacks Against the Government Sector. Retrieved September 28, 2021.",
                    "source_name": "Symantec Attacks Against Government Sector"
                },
                {
                    "source_name": "Graeber 2014",
                    "description": "Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.",
                    "url": "http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html"
                },
                {
                    "source_name": "TechNet Blogs Credential Protection",
                    "description": "Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018.",
                    "url": "https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/"
                },
                {
                    "source_name": "Medium Detecting Attempts to Steal Passwords from Memory",
                    "description": "French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.",
                    "url": "https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea"
                },
                {
                    "source_name": "Powersploit",
                    "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
                    "url": "https://github.com/mattifestation/PowerSploit"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-24T20:41:08.996Z",
            "name": "Cached Domain Credentials",
            "x_mitre_data_sources": [
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-02-21T15:42:25.991Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "x_mitre_permissions_required": [
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--6add2ab5-2711-4e9d-87c8-7a0be8531530",
            "description": "Adversaries may attempt to access cached domain credentials used to allow authentication to occur in the event a domain controller is unavailable.(Citation: Microsoft - Cached Creds)\n\nOn Windows Vista and newer, the hash format is DCC2 (Domain Cached Credentials version 2) hash, also known as MS-Cache v2 hash.(Citation: PassLib mscache) The number of default cached credentials varies and can be altered per system. This hash does not allow pass-the-hash style attacks, and instead requires [Password Cracking](https://attack.mitre.org/techniques/T1110/002) to recover the plaintext password.(Citation: ired mscache)\n\nWith SYSTEM access, the tools/utilities such as [Mimikatz](https://attack.mitre.org/software/S0002), [Reg](https://attack.mitre.org/software/S0075), and secretsdump.py can be used to extract the cached credentials.\n\nNote: Cached credentials for Windows Vista are derived using PBKDF2.(Citation: PassLib mscache)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Ed Williams, Trustwave, SpiderLabs"
            ],
            "x_mitre_detection": "Monitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nDetection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1003/005",
                    "external_id": "T1003.005",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh994565(v%3Dws.11)",
                    "description": "Microsfot. (2016, August 21). Cached and Stored Credentials Technical Overview. Retrieved February 21, 2020.",
                    "source_name": "Microsoft - Cached Creds"
                },
                {
                    "url": "https://passlib.readthedocs.io/en/stable/lib/passlib.hash.msdcc2.html",
                    "description": "Eli Collins. (2016, November 25). Windows' Domain Cached Credentials v2. Retrieved February 21, 2020.",
                    "source_name": "PassLib mscache"
                },
                {
                    "url": "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-and-cracking-mscash-cached-domain-credentials",
                    "description": "Mantvydas Baranauskas. (2019, November 16). Dumping and Cracking mscash - Cached Domain Credentials. Retrieved February 21, 2020.",
                    "source_name": "ired mscache"
                },
                {
                    "source_name": "Powersploit",
                    "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.",
                    "url": "https://github.com/mattifestation/PowerSploit"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-26T17:42:03.337Z",
            "name": "Peripheral Device Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.2",
            "created": "2017-05-31T21:31:28.471Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--348f1eef-964b-4eb6-bb53-69b3dcb0c643",
            "description": "Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1120",
                    "external_id": "T1120",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/646.html",
                    "external_id": "CAPEC-646",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Local Groups",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-03-26T17:48:27.871Z",
            "created": "2020-03-12T19:29:21.013Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--a01bf75f-00b2-4568-a58f-565ff9bf202b",
            "description": "Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.\n\nCommands such as <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility, <code>dscl . -list /Groups</code> on macOS, and <code>groups</code> on Linux can list local groups.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1069/001",
                    "external_id": "T1069.001",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-12T19:07:53.043Z",
            "name": "Domain Groups",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-02-21T21:15:06.561Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2aed01ad-3df3-4410-a8cb-11ea4ded587c",
            "description": "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.\n\nCommands such as <code>net group /domain</code> of the [Net](https://attack.mitre.org/software/S0039) utility,  <code>dscacheutil -q group</code> on macOS, and <code>ldapsearch</code> on Linux can list domain-level groups.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1069/002",
                    "external_id": "T1069.002",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-10-18T17:39:12.452Z",
            "name": "Spearphishing Attachment",
            "x_mitre_data_sources": [
                "File: File Creation",
                "Application Log: Application Log Content",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.2",
            "created": "2020-03-02T19:05:18.137Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_platforms": [
                "macOS",
                "Windows",
                "Linux"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2e34237d-8574-43f6-aace-ae2915de8597",
            "description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [User Execution](https://attack.mitre.org/techniques/T1204) to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nThere are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Philip Winther"
            ],
            "x_mitre_detection": "Network intrusion detection systems and email gateways can be used to detect spearphishing with malicious attachments in transit. Detonation chambers may also be used to identify malicious attachments. Solutions can be signature and behavior based, but adversaries may construct attachments in a way to avoid these systems.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nAnti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the attachment is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.\n\nMonitor for suspicious descendant process spawning from Microsoft Office and other productivity software.(Citation: Elastic - Koadiac Detection with EQL)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1566/001",
                    "external_id": "T1566.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/163.html",
                    "external_id": "CAPEC-163",
                    "source_name": "capec"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide",
                    "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
                    "source_name": "Microsoft Anti Spoofing"
                },
                {
                    "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf",
                    "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.",
                    "source_name": "ACSC Email Spoofing"
                },
                {
                    "url": "https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql",
                    "description": "Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.",
                    "source_name": "Elastic - Koadiac Detection with EQL"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Spearphishing Link",
            "x_mitre_data_sources": [
                "Application Log: Application Log Content",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.1",
            "modified": "2021-04-14T14:38:42.715Z",
            "created": "2020-03-02T19:15:44.182Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows",
                "Office 365",
                "SaaS",
                "Google Workspace"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2b742742-28c3-4e1b-bab7-8350d6300fa7",
            "description": "Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.\n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [User Execution](https://attack.mitre.org/techniques/T1204). The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [Steal Application Access Token](https://attack.mitre.org/techniques/T1528)s, like OAuth tokens, in order to gain access to protected applications and information.(Citation: Trend Micro Pawn Storm OAuth 2017)",
            "x_mitre_contributors": [
                "Philip Winther",
                "Shailesh Tiwary (Indian Army)",
                "Mark Wee",
                "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)",
                "Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)"
            ],
            "x_mitre_detection": "URL inspection within email (including expanding shortened links) can help detect links leading to known malicious sites. Detonation chambers can be used to detect these links and either automatically go to these sites to determine if they're potentially malicious, or wait and capture the content if a user visits the link.\n\nFiltering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.(Citation: Microsoft Anti Spoofing)(Citation: ACSC Email Spoofing)\n\nBecause this technique usually involves user interaction on the endpoint, many of the possible detections take place once [User Execution](https://attack.mitre.org/techniques/T1204) occurs.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1566/002",
                    "external_id": "T1566.002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/163.html",
                    "external_id": "CAPEC-163",
                    "source_name": "capec"
                },
                {
                    "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks",
                    "description": "Hacquebord, F.. (2017, April 25). Pawn Storm Abuses Open Authentication in Advanced Social Engineering Attacks. Retrieved October 4, 2019.",
                    "source_name": "Trend Micro Pawn Storm OAuth 2017"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spoofing-protection?view=o365-worldwide",
                    "description": "Microsoft. (2020, October 13). Anti-spoofing protection in EOP. Retrieved October 19, 2020.",
                    "source_name": "Microsoft Anti Spoofing"
                },
                {
                    "url": "https://www.cyber.gov.au/sites/default/files/2019-03/spoof_email_sender_policy_framework.pdf",
                    "description": "Australian Cyber Security Centre. (2012, December). Mitigating Spoofed Emails Using Sender Policy Framework. Retrieved October 19, 2020.",
                    "source_name": "ACSC Email Spoofing"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-10-18T01:55:02.988Z",
            "name": "Spearphishing via Service",
            "x_mitre_data_sources": [
                "Application Log: Application Log Content",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow"
            ],
            "x_mitre_version": "2.0",
            "created": "2020-03-02T19:24:00.951Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--f6ad61ee-65f3-4bd0-a3f5-2f0accb36317",
            "description": "Adversaries may send spearphishing messages via third-party services in an attempt to gain access to victim systems. Spearphishing via service is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels. \n\nAll forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries send messages through various social media services, personal webmail, and other non-enterprise controlled services. These services are more likely to have a less-strict security policy than an enterprise. As with most kinds of spearphishing, the goal is to generate rapport with the target or get the target's interest in some way. Adversaries will create fake social media accounts and message employees for potential job opportunities. Doing so allows a plausible reason for asking about services, policies, and software that's running in an environment. The adversary can then send malicious links or attachments through these services.\n\nA common example is to build rapport with a target via social media, then send content to a personal webmail service that the target uses on their work computer. This allows an adversary to bypass some email restrictions on the work account, and the target is more likely to open the file since it's something they were expecting. If the payload doesn't work as expected, the adversary can continue normal communications and troubleshoot with the target on how to get it working.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "x_mitre_detection": "Because most common third-party services used for spearphishing via service leverage TLS encryption, SSL/TLS inspection is generally required to detect the initial communication/delivery. With SSL/TLS inspection intrusion detection signatures or other security gateway appliances may be able to detect malware. \n\nAnti-virus can potentially detect malicious documents and files that are downloaded on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning Powershell.exe) for techniques such as [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203) or usage of malicious scripts.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1566/003",
                    "external_id": "T1566.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/163.html",
                    "external_id": "CAPEC-163",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Process Discovery",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1057",
                    "external_id": "T1057",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/573.html",
                    "external_id": "CAPEC-573",
                    "source_name": "capec"
                }
            ],
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-03-26T18:05:53.130Z",
            "x_mitre_system_requirements": [
                "Administrator, SYSTEM may provide better process ownership details"
            ],
            "id": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "description": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1057) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nIn Windows environments, adversaries could obtain details on running processes using the [Tasklist](https://attack.mitre.org/software/S0057) utility via [cmd](https://attack.mitre.org/software/S0106) or <code>Get-Process</code> via [PowerShell](https://attack.mitre.org/techniques/T1059/001). Information about processes can also be extracted from the output of [Native API](https://attack.mitre.org/techniques/T1106) calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events that look like process discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created": "2017-05-31T21:30:48.728Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-27T17:15:35.372Z",
            "name": "Protocol Tunneling",
            "x_mitre_data_sources": [
                "Network Traffic: Network Traffic Flow",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-03-15T16:03:39.082Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--4fe28b27-b13c-453e-a386-c2ef362a573b",
            "description": "Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet. \n\nThere are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.(Citation: SSH Tunneling) \n\n[Protocol Tunneling](https://attack.mitre.org/techniques/T1572) may also be abused by adversaries during [Dynamic Resolution](https://attack.mitre.org/techniques/T1568). Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.(Citation: BleepingComp Godlua JUL19) \n\nAdversaries may also leverage [Protocol Tunneling](https://attack.mitre.org/techniques/T1572) in conjunction with [Proxy](https://attack.mitre.org/techniques/T1090) and/or [Protocol Impersonation](https://attack.mitre.org/techniques/T1001/003) to further conceal C2 communications and infrastructure. ",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "x_mitre_detection": "Monitoring for systems listening and/or establishing external connections using ports/protocols commonly associated with tunneling, such as SSH (port 22). Also monitor for processes commonly associated with tunneling, such as Plink and the OpenSSH client. \n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1572",
                    "external_id": "T1572",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://www.ssh.com/ssh/tunneling",
                    "description": "SSH.COM. (n.d.). SSH tunnel. Retrieved March 15, 2020.",
                    "source_name": "SSH Tunneling"
                },
                {
                    "url": "https://www.bleepingcomputer.com/news/security/new-godlua-malware-evades-traffic-monitoring-via-dns-over-https/",
                    "description": "Gatlan, S. (2019, July 3). New Godlua Malware Evades Traffic Monitoring via DNS over HTTPS. Retrieved March 15, 2020.",
                    "source_name": "BleepingComp Godlua JUL19"
                },
                {
                    "source_name": "University of Birmingham C2",
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.",
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Query Registry",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Windows Registry: Windows Registry Key Access",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-03-26T18:08:20.049Z",
            "created": "2017-05-31T21:30:25.584Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896",
            "description": "Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\n\nThe Registry contains a significant amount of information about the operating system, configuration, software, and security.(Citation: Wikipedia Windows Registry) Information can easily be queried using the [Reg](https://attack.mitre.org/software/S0075) utility, though other means to access the Registry exist. Some of the information may help adversaries to further their operation within a network. Adversaries may use the information from [Query Registry](https://attack.mitre.org/techniques/T1012) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nInteraction with the Windows Registry may come from the command line using utilities such as [Reg](https://attack.mitre.org/software/S0075) or through running malware that may interact with the Registry through an API. Command-line invocation of utilities used to query the Registry may be detected through process and command-line monitoring. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1012",
                    "external_id": "T1012",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/647.html",
                    "external_id": "CAPEC-647",
                    "source_name": "capec"
                },
                {
                    "source_name": "Wikipedia Windows Registry",
                    "description": "Wikipedia. (n.d.). Windows Registry. Retrieved February 2, 2015.",
                    "url": "https://en.wikipedia.org/wiki/Windows_Registry"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Remote Desktop Protocol",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1021/001",
                    "external_id": "T1021.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/555.html",
                    "external_id": "CAPEC-555",
                    "source_name": "capec"
                },
                {
                    "source_name": "TechNet Remote Desktop Services",
                    "description": "Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016.",
                    "url": "https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx"
                },
                {
                    "source_name": "Alperovitch Malware",
                    "description": "Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014.",
                    "url": "http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/"
                }
            ],
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Flow",
                "Logon Session: Logon Session Creation"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-02-25T19:23:34.204Z",
            "x_mitre_system_requirements": [
                "RDP service enabled, account in the Remote Desktop Users group"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "lateral-movement"
                }
            ],
            "id": "attack-pattern--eb062747-2193-45de-8fa2-e62549c37ddf",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Remote Desktop Users",
                "User"
            ],
            "description": "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.\n\nRemote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) \n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) technique for Persistence.(Citation: Alperovitch Malware)",
            "x_mitre_contributors": [
                "Matthew Demaske, Adaptforward"
            ],
            "x_mitre_detection": "Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.",
            "created": "2020-02-11T18:23:26.059Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "type": "attack-pattern",
            "modified": "2021-10-15T14:15:06.853Z",
            "name": "SSH",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation",
                "Logon Session: Logon Session Creation"
            ],
            "x_mitre_version": "1.1",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_system_requirements": [
                "An SSH server is configured and running."
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--2db31dcd-54da-405d-acef-b9129b816ed6",
            "description": "Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user.\n\nSSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user\u2019s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "lateral-movement"
                }
            ],
            "x_mitre_detection": "Use of SSH may be legitimate depending on the environment and how it\u2019s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.\n\nOn macOS systems <code>log show --predicate 'process = \"sshd\"'</code> can be used to review incoming SSH connection attempts for suspicious activity. The command <code>log show --info --predicate 'process = \"ssh\" or eventMessage contains \"ssh\"'</code> can be used to review outgoing SSH connection activity.(Citation: Apple Unified Log Analysis Remote Login and Screen Sharing)\n\nOn Linux systems SSH activity can be found in the logs located in <code>/var/log/auth.log</code> or <code>/var/log/secure</code> depending on the distro you are using.",
            "created": "2020-02-11T18:27:15.774Z",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1021/004",
                    "external_id": "T1021.004",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/555.html",
                    "external_id": "CAPEC-555",
                    "source_name": "capec"
                },
                {
                    "url": "https://sarah-edwards-xzkc.squarespace.com/blog/2020/4/30/analysis-of-apple-unified-logs-quarantine-edition-entry-6-working-from-home-remote-logins",
                    "description": "Sarah Edwards. (2020, April 30). Analysis of Apple Unified Logs: Quarantine Edition [Entry 6] \u2013 Working From Home? Remote Logins. Retrieved August 19, 2021.",
                    "source_name": "Apple Unified Log Analysis Remote Login and Screen Sharing"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-12-30T14:26:44.730Z",
            "name": "Scheduled Task",
            "x_mitre_data_sources": [
                "Scheduled Job: Scheduled Job Creation",
                "Command: Command Execution",
                "File: File Modification",
                "Process: Process Creation"
            ],
            "x_mitre_version": "1.0",
            "created": "2019-11-27T14:58:00.429Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                }
            ],
            "x_mitre_permissions_required": [
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--005a06c6-14bf-4118-afa0-ebcd8aebb0c9",
            "description": "Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The <code>schtasks</code> can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task.\n\nThe deprecated [at](https://attack.mitre.org/software/S0110) utility could also be abused by adversaries (ex: [At (Windows)](https://attack.mitre.org/techniques/T1053/002)), though <code>at.exe</code> can not access tasks created with <code>schtasks</code> or the Control Panel.\n\nAn adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_remote_support": true,
            "x_mitre_detection": "Monitor process execution from the <code>svchost.exe</code> in Windows 10 and the Windows Task Scheduler <code>taskeng.exe</code> for older versions of Windows. (Citation: Twitter Leoloobeek Scheduled Task) If scheduled tasks are not used for persistence, then the adversary is likely to remove the task when the action is complete. Monitor Windows Task Scheduler stores in %systemroot%\\System32\\Tasks for change entries related to scheduled tasks that do not correlate with known software, patch cycles, etc.\n\nConfigure event logging for scheduled task creation and changes by enabling the \"Microsoft-Windows-TaskScheduler/Operational\" setting within the event logging service. (Citation: TechNet Forum Scheduled Task Operational Setting) Several events will then be logged on scheduled task activity, including: (Citation: TechNet Scheduled Task Events)(Citation: Microsoft Scheduled Task Events Win10)\n\n* Event ID 106 on Windows 7, Server 2008 R2 - Scheduled task registered\n* Event ID 140 on Windows 7, Server 2008 R2 / 4702 on Windows 10, Server 2016 - Scheduled task updated\n* Event ID 141 on Windows 7, Server 2008 R2 / 4699 on Windows 10, Server 2016 - Scheduled task deleted\n* Event ID 4698 on Windows 10, Server 2016 - Scheduled task created\n* Event ID 4700 on Windows 10, Server 2016 - Scheduled task enabled\n* Event ID 4701 on Windows 10, Server 2016 - Scheduled task disabled\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current scheduled tasks. (Citation: TechNet Autoruns)\n\nRemote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Tasks may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1053/005",
                    "external_id": "T1053.005",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Twitter Leoloobeek Scheduled Task",
                    "description": "Loobeek, L. (2017, December 8). leoloobeek Status. Retrieved December 12, 2017.",
                    "url": "https://twitter.com/leoloobeek/status/939248813465853953"
                },
                {
                    "source_name": "TechNet Forum Scheduled Task Operational Setting",
                    "description": "Satyajit321. (2015, November 3). Scheduled Tasks History Retention settings. Retrieved December 12, 2017.",
                    "url": "https://social.technet.microsoft.com/Forums/en-US/e5bca729-52e7-4fcb-ba12-3225c564674c/scheduled-tasks-history-retention-settings?forum=winserver8gen"
                },
                {
                    "source_name": "TechNet Scheduled Task Events",
                    "description": "Microsoft. (n.d.). General Task Registration. Retrieved December 12, 2017.",
                    "url": "https://technet.microsoft.com/library/dd315590.aspx"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-other-object-access-events",
                    "description": "Microsoft. (2017, May 28). Audit Other Object Access Events. Retrieved June 27, 2019.",
                    "source_name": "Microsoft Scheduled Task Events Win10"
                },
                {
                    "source_name": "TechNet Autoruns",
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.",
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-24T19:56:37.627Z",
            "name": "Screen Capture",
            "x_mitre_data_sources": [
                "Process: OS API Execution",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "created": "2017-05-31T21:31:25.060Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688",
            "description": "Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations. Taking a screenshot is also typically possible through native utilities or API calls, such as <code>CopyFromScreen</code>, <code>xwd</code>, or <code>screencapture</code>.(Citation: CopyFromScreen .NET)(Citation: Antiquated Mac Malware)\n",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "x_mitre_detection": "Monitoring for screen capture behavior will depend on the method used to obtain data from the operating system and write output files. Detection methods could include collecting information from unusual processes using API calls used to obtain image data, and monitoring for image files written to disk. The sensor data may need to be correlated with other events to identify malicious activity, depending on the legitimacy of this behavior within a given network environment.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1113",
                    "external_id": "T1113",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/648.html",
                    "external_id": "CAPEC-648",
                    "source_name": "capec"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen?view=netframework-4.8",
                    "description": "Microsoft. (n.d.). Graphics.CopyFromScreen Method. Retrieved March 24, 2020.",
                    "source_name": "CopyFromScreen .NET"
                },
                {
                    "source_name": "Antiquated Mac Malware",
                    "description": "Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017.",
                    "url": "https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Web Shell",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1505/003",
                    "external_id": "T1505.003",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/650.html",
                    "external_id": "CAPEC-650",
                    "source_name": "capec"
                },
                {
                    "url": "https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html",
                    "description": "Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015.",
                    "source_name": "Lee 2013"
                },
                {
                    "url": "https://github.com/nsacyber/Mitigating-Web-Shells",
                    "description": " NSA Cybersecurity Directorate. (n.d.). Mitigating Web Shells. Retrieved July 22, 2021.",
                    "source_name": "NSA Cyber Mitigating Web Shells"
                },
                {
                    "source_name": "US-CERT Alert TA15-314A Web Shells",
                    "description": "US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.",
                    "url": "https://www.us-cert.gov/ncas/alerts/TA15-314A"
                }
            ],
            "x_mitre_data_sources": [
                "File: File Creation",
                "File: File Modification",
                "Process: Process Creation",
                "Network Traffic: Network Traffic Content",
                "Network Traffic: Network Traffic Flow",
                "Application Log: Application Log Content"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-07-26T13:46:47.993Z",
            "x_mitre_system_requirements": [
                "Adversary access to Web server with vulnerability or account to upload and serve the Web shell file."
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "id": "attack-pattern--5d0d3609-d06d-49e1-b9c9-b544e0c618cb",
            "x_mitre_platforms": [
                "Linux",
                "Windows",
                "macOS"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "SYSTEM",
                "User"
            ],
            "description": "Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.\n\nIn addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013) ",
            "x_mitre_contributors": [
                "Arnim Rupp, Deutsche Lufthansa AG"
            ],
            "x_mitre_detection": "Web shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is the following short payload: (Citation: Lee 2013) \n\n<code>&lt;?php @eval($_POST['password']);&gt;</code>\n\nNevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as spawning cmd.exe or accessing files that are not in the Web directory.(Citation: NSA Cyber Mitigating Web Shells)\n\nFile monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script.(Citation: NSA Cyber Mitigating Web Shells)\n\nLog authentication attempts to the server and any unusual traffic patterns to or from the server and internal network. (Citation: US-CERT Alert TA15-314A Web Shells)",
            "created": "2019-12-13T16:46:18.927Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Compiled HTML File",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "File: File Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-06-20T22:32:24.589Z",
            "created": "2020-01-23T18:53:54.377Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "id": "attack-pattern--a6937325-9321-4e2e-bb2b-3ed2d40b2a9d",
            "x_mitre_defense_bypassed": [
                "Digital Certificate Validation",
                "Application control"
            ],
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program)\n\nA custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)",
            "x_mitre_contributors": [
                "Rahmat Nurfauzi, @infosecn1nja, PT Xynexis International"
            ],
            "x_mitre_detection": "Monitor and analyze the execution and arguments of hh.exe. (Citation: MsitPros CHM Aug 2017) Compare recent invocations of hh.exe with prior history of known good arguments to determine anomalous and potentially adversarial activity (ex: obfuscated and/or malicious commands). Non-standard process execution trees may also indicate suspicious or malicious behavior, such as if hh.exe is the parent process for suspicious processes and activity relating to other adversarial techniques.\n\nMonitor presence and use of CHM files, especially if they are not typically used within an environment.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1218/001",
                    "external_id": "T1218.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.microsoft.com/previous-versions/windows/desktop/htmlhelp/microsoft-html-help-1-4-sdk",
                    "description": "Microsoft. (2018, May 30). Microsoft HTML Help 1.4. Retrieved October 3, 2018.",
                    "source_name": "Microsoft HTML Help May 2018"
                },
                {
                    "url": "https://msdn.microsoft.com/windows/desktop/ms644670",
                    "description": "Microsoft. (n.d.). HTML Help ActiveX Control Overview. Retrieved October 3, 2018.",
                    "source_name": "Microsoft HTML Help ActiveX"
                },
                {
                    "url": "https://msdn.microsoft.com/windows/desktop/ms524405",
                    "description": "Microsoft. (n.d.). About the HTML Help Executable Program. Retrieved October 3, 2018.",
                    "source_name": "Microsoft HTML Help Executable Program"
                },
                {
                    "url": "https://msitpros.com/?p=3909",
                    "description": "Moe, O. (2017, August 13). Bypassing Device guard UMCI using CHM \u2013 CVE-2017-8625. Retrieved October 3, 2018.",
                    "source_name": "MsitPros CHM Aug 2017"
                },
                {
                    "url": "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8625",
                    "description": "Microsoft. (2017, August 8). CVE-2017-8625 - Internet Explorer Security Feature Bypass Vulnerability. Retrieved October 3, 2018.",
                    "source_name": "Microsoft CVE-2017-8625 Aug 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "System Information Discovery",
            "x_mitre_data_sources": [
                "Instance: Instance Metadata",
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-10-13T23:21:27.750Z",
            "created": "2017-05-31T21:31:04.307Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "id": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1",
            "x_mitre_platforms": [
                "Windows",
                "IaaS",
                "Linux",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User"
            ],
            "description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nTools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. [System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques)\n\nInfrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)",
            "x_mitre_contributors": [
                "Maril Vernon @shewhohacks",
                "Praetorian"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nIn cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1082",
                    "external_id": "T1082",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/312.html",
                    "external_id": "CAPEC-312",
                    "source_name": "capec"
                },
                {
                    "url": "https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/",
                    "description": "Phile Stokes. (2018, September 20). On the Trail of OSX.FairyTale | Adware Playing at Malware. Retrieved August 24, 2021.",
                    "source_name": "OSX.FairyTale"
                },
                {
                    "url": "https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/",
                    "description": "Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.",
                    "source_name": "20 macOS Common Tools and Techniques"
                },
                {
                    "url": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html",
                    "description": "Amazon. (n.d.). describe-instance-information. Retrieved March 3, 2020.",
                    "source_name": "Amazon Describe Instance"
                },
                {
                    "url": "https://cloud.google.com/compute/docs/reference/rest/v1/instances",
                    "description": "Google. (n.d.). Rest Resource: instance. Retrieved March 3, 2020.",
                    "source_name": "Google Instances Resource"
                },
                {
                    "source_name": "Microsoft Virutal Machine API",
                    "description": "Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019.",
                    "url": "https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "System Network Configuration Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Script: Script Execution",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "1.3",
            "modified": "2021-10-08T00:17:37.881Z",
            "created": "2017-05-31T21:30:27.342Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0",
            "description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [Arp](https://attack.mitre.org/software/S0099), [ipconfig](https://attack.mitre.org/software/S0100)/[ifconfig](https://attack.mitre.org/software/S0101), [nbtstat](https://attack.mitre.org/software/S0102), and [route](https://attack.mitre.org/software/S0103).\n\nAdversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1016",
                    "external_id": "T1016",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/309.html",
                    "external_id": "CAPEC-309",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "System Network Connections Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "2.2",
            "modified": "2021-03-08T10:33:01.083Z",
            "created": "2017-05-31T21:30:45.139Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "id": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475",
            "x_mitre_platforms": [
                "Windows",
                "IaaS",
                "Linux",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. \n\nAn adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.(Citation: Amazon AWS VPC Guide)(Citation: Microsoft Azure Virtual Network Overview)(Citation: Google VPC Overview)\n\nUtilities and commands that acquire this information include [netstat](https://attack.mitre.org/software/S0104), \"net use,\" and \"net session\" with [Net](https://attack.mitre.org/software/S0039). In Mac and Linux, [netstat](https://attack.mitre.org/software/S0104) and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to \"net session\".",
            "x_mitre_contributors": [
                "Praetorian"
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1049",
                    "external_id": "T1049",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html",
                    "description": "Amazon. (n.d.). What Is Amazon VPC?. Retrieved October 6, 2019.",
                    "source_name": "Amazon AWS VPC Guide"
                },
                {
                    "url": "https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-overview",
                    "description": "Annamalai, N., Casey, C., Almeida, M., et. al.. (2019, June 18). What is Azure Virtual Network?. Retrieved October 6, 2019.",
                    "source_name": "Microsoft Azure Virtual Network Overview"
                },
                {
                    "url": "https://cloud.google.com/vpc/docs/vpc",
                    "description": "Google. (2019, September 23). Virtual Private Cloud (VPC) network overview. Retrieved October 6, 2019.",
                    "source_name": "Google VPC Overview"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-08-12T13:34:34.153Z",
            "name": "System Owner/User Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.3",
            "created": "2017-05-31T21:30:35.733Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104",
            "description": "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nVarious utilities and commands may acquire this information, including <code>whoami</code>. In macOS and Linux, the currently logged in user can be identified with <code>w</code> and <code>who</code>. On macOS the <code>dscl . list /Users | grep -v '_'</code> command can also be used to enumerate user accounts. Environment variables, such as <code>%USERNAME%</code> and <code>$USER</code>, may also be used to access this information.",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1033",
                    "external_id": "T1033",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/577.html",
                    "external_id": "CAPEC-577",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "System Service Discovery",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-10-17T14:10:36.992Z",
            "created": "2017-05-31T21:30:21.315Z",
            "x_mitre_permissions_required": [
                "User",
                "Administrator",
                "SYSTEM"
            ],
            "x_mitre_platforms": [
                "Windows",
                "macOS"
            ],
            "x_mitre_is_subtechnique": false,
            "id": "attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa",
            "description": "Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are \"sc,\" \"tasklist /svc\" using [Tasklist](https://attack.mitre.org/software/S0057), and \"net start\" using [Net](https://attack.mitre.org/software/S0039), but adversaries may also use other tools as well. Adversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1007",
                    "external_id": "T1007",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/574.html",
                    "external_id": "CAPEC-574",
                    "source_name": "capec"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Credentials In Files",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1552/001",
                    "external_id": "T1552.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/639.html",
                    "external_id": "CAPEC-639",
                    "source_name": "capec"
                },
                {
                    "source_name": "CG 2014",
                    "description": "CG. (2014, May 20). Mimikatz Against Virtual Machine Memory Part 1. Retrieved November 12, 2014.",
                    "url": "http://carnal0wnage.attackresearch.com/2014/05/mimikatz-against-virtual-machine-memory.html"
                },
                {
                    "source_name": "SRD GPP",
                    "description": "Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015.",
                    "url": "http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/",
                    "description": "Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.",
                    "source_name": "Unit 42 Hildegard Malware"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/attackers-tactics-and-techniques-in-unsecured-docker-daemons-revealed/",
                    "description": "Chen, J.. (2020, January 29). Attacker's Tactics and Techniques in Unsecured Docker Daemons Revealed. Retrieved March 31, 2021.",
                    "source_name": "Unit 42 Unsecured Docker Daemons"
                },
                {
                    "url": "https://posts.specterops.io/head-in-the-clouds-bd038bb69e48",
                    "description": "Maddalena, C.. (2018, September 12). Head in the Clouds. Retrieved October 4, 2019.",
                    "source_name": "Specter Ops - Cloud Credential Storage"
                }
            ],
            "x_mitre_data_sources": [
                "File: File Access",
                "Command: Command Execution"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-04-12T18:32:32.803Z",
            "x_mitre_system_requirements": [
                "Access to files"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "credential-access"
                }
            ],
            "id": "attack-pattern--837f9164-50af-4ac0-8219-379d8a74cefc",
            "x_mitre_platforms": [
                "Windows",
                "IaaS",
                "Linux",
                "macOS",
                "Containers"
            ],
            "x_mitre_is_subtechnique": true,
            "x_mitre_permissions_required": [
                "Administrator",
                "SYSTEM",
                "User"
            ],
            "description": "Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.\n\nIt is possible to extract passwords from backups or saved virtual machines through [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). (Citation: CG 2014) Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. (Citation: SRD GPP)\n\nIn cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.(Citation: Unit 42 Hildegard Malware) They may also be found as parameters to deployment commands in container logs.(Citation: Unit 42 Unsecured Docker Daemons) In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.(Citation: Specter Ops - Cloud Credential Storage)",
            "x_mitre_contributors": [
                "Rory McCune, Aqua Security",
                "Jay Chen, Palo Alto Networks",
                "Yossi Weizman, Azure Defender Research Team",
                "Vishwas Manral, McAfee",
                "Microsoft Threat Intelligence Center (MSTIC)"
            ],
            "x_mitre_detection": "While detecting adversaries accessing these files may be difficult without knowing they exist in the first place, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). See [Valid Accounts](https://attack.mitre.org/techniques/T1078) for more information.",
            "created": "2020-02-04T12:52:13.006Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5"
        },
        {
            "type": "attack-pattern",
            "modified": "2020-03-11T14:43:31.706Z",
            "name": "Malicious Link",
            "x_mitre_data_sources": [
                "Network Traffic: Network Connection Creation",
                "Network Traffic: Network Traffic Content",
                "File: File Creation"
            ],
            "x_mitre_version": "1.0",
            "created": "2020-03-11T14:43:31.706Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--ef67e13e-5598-4adc-bdb2-998225874fa9",
            "description": "An adversary may rely upon a user clicking a malicious link in order to gain execution. Users may be subjected to social engineering to get them to click on a link that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Clicking on a link may also lead to other execution techniques such as exploitation of a browser or application vulnerability via [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203). Links may also lead users to download files that require execution via [Malicious File](https://attack.mitre.org/techniques/T1204/002).",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_detection": "Inspect network traffic for indications that a user visited a malicious site, such as links included in phishing campaigns directed at your organization.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded from a link and executed on the user's computer.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1204/001",
                    "external_id": "T1204.001",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Malicious File",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "File: File Creation"
            ],
            "x_mitre_version": "1.1",
            "modified": "2021-07-21T23:10:47.193Z",
            "created": "2020-03-11T14:49:36.954Z",
            "x_mitre_permissions_required": [
                "User"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--232b7f21-adf9-4b42-b936-b9d6f7df856e",
            "description": "An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.\n\nAdversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it.\n\nWhile [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_detection": "Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain initial access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) in payloads.\n\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1204/002",
                    "external_id": "T1204.002",
                    "source_name": "mitre-attack"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Valid Accounts",
            "x_mitre_data_sources": [
                "Logon Session: Logon Session Metadata",
                "User Account: User Account Authentication",
                "Logon Session: Logon Session Creation"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-10-19T03:29:48.018Z",
            "created": "2017-05-31T21:31:00.645Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "privilege-escalation"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "initial-access"
                }
            ],
            "id": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81",
            "x_mitre_defense_bypassed": [
                "Firewall",
                "Host intrusion prevention systems",
                "Network intrusion detection system",
                "Application control",
                "System access controls",
                "Anti-virus"
            ],
            "x_mitre_platforms": [
                "Windows",
                "Azure AD",
                "Office 365",
                "SaaS",
                "IaaS",
                "Linux",
                "macOS",
                "Google Workspace",
                "Containers"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)",
            "x_mitre_effective_permissions": [
                "User",
                "Administrator"
            ],
            "x_mitre_contributors": [
                "Jon Sternstein, Stern Security",
                "Yossi Weizman, Azure Defender Research Team",
                "Netskope",
                "Mark Wee",
                "Praetorian"
            ],
            "x_mitre_detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\n\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1078",
                    "external_id": "T1078",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://capec.mitre.org/data/definitions/560.html",
                    "external_id": "CAPEC-560",
                    "source_name": "capec"
                },
                {
                    "source_name": "TechNet Credential Theft",
                    "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.",
                    "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"
                },
                {
                    "source_name": "TechNet Audit Policy",
                    "description": "Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.",
                    "url": "https://technet.microsoft.com/en-us/library/dn487457.aspx"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "modified": "2021-10-18T14:57:07.973Z",
            "name": "System Checks",
            "x_mitre_data_sources": [
                "Process: Process Creation",
                "Command: Command Execution",
                "Process: OS API Execution"
            ],
            "x_mitre_version": "2.1",
            "created": "2020-03-06T20:57:37.959Z",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                },
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "x_mitre_defense_bypassed": [
                "Static File Analysis",
                "Signature-based detection",
                "Host forensic analysis",
                "Anti-virus"
            ],
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "x_mitre_is_subtechnique": true,
            "id": "attack-pattern--29be378d-262d-4e99-b00d-852d573628e6",
            "description": "Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behaviors based on the results of checks for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware to disengage from the victim or conceal the core functions of the implant. They may also search for VME artifacts before dropping secondary or additional payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) during automated discovery to shape follow-on behaviors.(Citation: Deloitte Environment Awareness)\n\nSpecific checks will vary based on the target and/or adversary, but may involve behaviors such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047), [PowerShell](https://attack.mitre.org/techniques/T1059/001), [System Information Discovery](https://attack.mitre.org/techniques/T1082), and [Query Registry](https://attack.mitre.org/techniques/T1012) to obtain system information and search for VME artifacts. Adversaries may search for VME artifacts in memory, processes, file system, hardware, and/or the Registry. Adversaries may use scripting to automate these checks  into one script and then have the program exit if it determines the system to be a virtual environment. \n\nChecks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. \n\nOther common checks may enumerate services running that are unique to these applications, installed programs on the system, manufacturer/product fields for strings relating to virtual machine applications, and VME-specific hardware/processor instructions.(Citation: McAfee Virtual Jan 2017) In applications like VMWare, adversaries can also use a special I/O port to send commands and receive output. \n \nHardware checks, such as the presence of the fan, temperature, and audio devices, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.(Citation: Unit 42 OilRig Sept 2018)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Deloitte Threat Library Team"
            ],
            "x_mitre_detection": "Virtualization/sandbox related system checks will likely occur in the first steps of an operation but may also occur throughout as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as lateral movement, based on the information obtained. Detecting actions related to virtualization and sandbox identification may be difficult depending on the adversary's implementation and monitoring required. Monitoring for suspicious processes being spawned that gather a variety of system information or perform other forms of Discovery, especially in a short period of time, may aid in detection.",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1497/001",
                    "external_id": "T1497.001",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://drive.google.com/file/d/1t0jn3xr4ff2fR30oQAUn_RsWSnMpOAQc",
                    "description": "Torello, A. & Guibernau, F. (n.d.). Environment Awareness. Retrieved May 18, 2021.",
                    "source_name": "Deloitte Environment Awareness"
                },
                {
                    "url": "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/stopping-malware-fake-virtual-machine/",
                    "description": "Roccia, T. (2017, January 19). Stopping Malware With a Fake Virtual Machine. Retrieved April 17, 2019.",
                    "source_name": "McAfee Virtual Jan 2017"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/",
                    "description": "Falcone, R., et al. (2018, September 04). OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE. Retrieved September 24, 2018.",
                    "source_name": "Unit 42 OilRig Sept 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "attack-pattern",
            "name": "Windows Management Instrumentation",
            "x_mitre_data_sources": [
                "Command: Command Execution",
                "Process: Process Creation",
                "Network Traffic: Network Connection Creation"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-10-15T23:58:07.715Z",
            "created": "2017-05-31T21:30:44.329Z",
            "x_mitre_remote_support": true,
            "id": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055",
            "x_mitre_platforms": [
                "Windows"
            ],
            "x_mitre_is_subtechnique": false,
            "x_mitre_permissions_required": [
                "User",
                "Administrator"
            ],
            "description": "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) (WinRM). (Citation: MSDN WMI) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS. (Citation: MSDN WMI) (Citation: FireEye WMI 2015)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015)",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "x_mitre_contributors": [
                "@ionstorm"
            ],
            "x_mitre_detection": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior. (Citation: FireEye WMI 2015)",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/techniques/T1047",
                    "external_id": "T1047",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "MSDN WMI",
                    "description": "Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016.",
                    "url": "https://msdn.microsoft.com/en-us/library/aa394582.aspx"
                },
                {
                    "source_name": "FireEye WMI 2015",
                    "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.",
                    "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"
                },
                {
                    "url": "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/sans-dfir-2015.pdf",
                    "description": "Devon Kerr. (2015). There's Something About WMI. Retrieved May 4, 2020.",
                    "source_name": "FireEye WMI SANS 2015"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "BONDUPDATER",
            "x_mitre_aliases": [
                "BONDUPDATER"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-02-09T14:06:12.720Z",
            "created": "2019-02-18T20:16:12.119Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--d5268dfb-ae2b-4e0e-ac07-02a460613d8a",
            "description": "[BONDUPDATER](https://attack.mitre.org/software/S0360) is a PowerShell backdoor used by [OilRig](https://attack.mitre.org/groups/G0049). It was first observed in November 2017 during targeting of a Middle Eastern government organization, and an updated version was observed in August 2018 being used to target a government organization with spearphishing emails.(Citation: FireEye APT34 Dec 2017)(Citation: Palo Alto OilRig Sep 2018)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0360",
                    "external_id": "S0360",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/unit42-oilrig-uses-updated-bondupdater-target-middle-eastern-government/",
                    "description": "Wilhoit, K. and Falcone, R. (2018, September 12). OilRig Uses Updated BONDUPDATER to Target Middle Eastern Government. Retrieved February 18, 2019.",
                    "source_name": "Palo Alto OilRig Sep 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "certutil",
            "x_mitre_aliases": [
                "certutil",
                "certutil.exe"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-08-16T17:50:50.307Z",
            "created": "2017-12-14T16:46:06.044Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--0a68f1f1-da74-4d28-8d9a-696c082706cc",
            "description": "[certutil](https://attack.mitre.org/software/S0160) is a command-line utility that can be used to obtain certificate authority information and configure Certificate Services. (Citation: TechNet Certutil)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0160",
                    "external_id": "S0160",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "TechNet Certutil",
                    "description": "Microsoft. (2012, November 14). Certutil. Retrieved July 3, 2017.",
                    "url": "https://technet.microsoft.com/library/cc732443.aspx"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "FTP",
            "x_mitre_aliases": [
                "FTP",
                "ftp.exe"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-03-30T16:25:40.125Z",
            "created": "2017-05-31T21:33:00.565Z",
            "x_mitre_platforms": [
                "Linux",
                "Windows",
                "macOS"
            ],
            "id": "tool--cf23bf4a-e003-4116-bbae-1ea6c558d565",
            "description": "[FTP](https://attack.mitre.org/software/S0095) is a utility commonly available with operating systems to transfer information over the File Transfer Protocol (FTP). Adversaries can use it to transfer other tools onto a system or to exfiltrate data. (Citation: Wikipedia FTP)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0095",
                    "external_id": "S0095",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://en.wikipedia.org/wiki/File_Transfer_Protocol",
                    "description": "Wikipedia. (2016, June 15). File Transfer Protocol. Retrieved July 20, 2016.",
                    "source_name": "Wikipedia FTP"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "Helminth",
            "x_mitre_aliases": [
                "Helminth"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-03-28T21:35:13.610Z",
            "created": "2018-01-16T16:13:52.465Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--eff1a885-6f90-42a1-901f-eef6e7a1905e",
            "description": "[Helminth](https://attack.mitre.org/software/S0170) is a backdoor that has at least two variants - one written in VBScript and PowerShell that is delivered via a macros in Excel spreadsheets, and one that is a standalone Windows executable. (Citation: Palo Alto OilRig May 2016)",
            "x_mitre_contributors": [
                "Robert Falcone"
            ],
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0170",
                    "external_id": "S0170",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Palo Alto OilRig May 2016)",
                    "source_name": "Helminth"
                },
                {
                    "url": "http://researchcenter.paloaltonetworks.com/2016/05/the-oilrig-campaign-attacks-on-saudi-arabian-organizations-deliver-helminth-backdoor/",
                    "description": "Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.",
                    "source_name": "Palo Alto OilRig May 2016"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "ipconfig",
            "x_mitre_aliases": [
                "ipconfig",
                "ipconfig.exe"
            ],
            "x_mitre_version": "1.0",
            "modified": "2018-10-17T00:14:20.652Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--294e2560-bd48-44b2-9da2-833b5588ad11",
            "description": "[ipconfig](https://attack.mitre.org/software/S0100) is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. (Citation: TechNet Ipconfig)",
            "labels": [
                "tool"
            ],
            "created": "2017-05-31T21:33:02.863Z",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0100",
                    "external_id": "S0100",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/bb490921.aspx",
                    "description": "Microsoft. (n.d.). Ipconfig. Retrieved April 17, 2016.",
                    "source_name": "TechNet Ipconfig"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "ISMInjector",
            "x_mitre_aliases": [
                "ISMInjector"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-03-31T12:38:41.115Z",
            "created": "2018-01-16T16:13:52.465Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--5be33fef-39c0-4532-84ee-bea31e1b5324",
            "description": "[ISMInjector](https://attack.mitre.org/software/S0189) is a Trojan used to install another [OilRig](https://attack.mitre.org/groups/G0049) backdoor, ISMAgent. (Citation: OilRig New Delivery Oct 2017)",
            "x_mitre_contributors": [
                "Robert Falcone"
            ],
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0189",
                    "external_id": "S0189",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: OilRig New Delivery Oct 2017)",
                    "source_name": "ISMInjector"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/",
                    "description": "Falcone, R. and Lee, B. (2017, October 9). OilRig Group Steps Up Attacks with New Delivery Documents and New Injector Trojan. Retrieved January 8, 2018.",
                    "source_name": "OilRig New Delivery Oct 2017"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "LaZagne",
            "x_mitre_aliases": [
                "LaZagne"
            ],
            "x_mitre_version": "1.3",
            "modified": "2021-10-15T16:56:52.156Z",
            "created": "2019-01-30T16:44:59.887Z",
            "x_mitre_platforms": [
                "Linux",
                "macOS",
                "Windows"
            ],
            "id": "tool--b76b2d94-60e4-4107-a903-4a3a7622fb3b",
            "description": "[LaZagne](https://attack.mitre.org/software/S0349) is a post-exploitation, open-source tool used to recover stored passwords on a system. It has modules for Windows, Linux, and OSX, but is mainly focused on Windows systems. [LaZagne](https://attack.mitre.org/software/S0349) is publicly available on GitHub.(Citation: GitHub LaZagne Dec 2018)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "S0349",
                    "url": "https://attack.mitre.org/software/S0349"
                },
                {
                    "description": "(Citation: GitHub LaZange Dec 2018)",
                    "source_name": "LaZagne"
                },
                {
                    "source_name": "GitHub LaZagne Dec 2018",
                    "description": "Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.",
                    "url": "https://github.com/AlessandroZ/LaZagne"
                }
            ]
        },
        {
            "type": "tool",
            "modified": "2021-05-20T14:25:59.596Z",
            "name": "Mimikatz",
            "x_mitre_aliases": [
                "Mimikatz"
            ],
            "x_mitre_version": "1.4",
            "created": "2017-05-31T21:32:11.544Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60",
            "description": "[Mimikatz](https://attack.mitre.org/software/S0002) is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks. (Citation: Deply Mimikatz) (Citation: Adsecurity Mimikatz Guide)",
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "x_mitre_contributors": [
                "Vincent Le Toux"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0002",
                    "external_id": "S0002",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://github.com/gentilkiwi/mimikatz",
                    "description": "Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.",
                    "source_name": "Deply Mimikatz"
                },
                {
                    "source_name": "Adsecurity Mimikatz Guide",
                    "description": "Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015.",
                    "url": "https://adsecurity.org/?page_id=1821"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Net",
            "x_mitre_aliases": [
                "Net",
                "net.exe"
            ],
            "x_mitre_version": "2.3",
            "modified": "2021-10-15T20:33:54.392Z",
            "created": "2017-05-31T21:32:31.601Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--03342581-f790-4f03-ba41-e82e67392e23",
            "description": "The [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.",
            "x_mitre_contributors": [
                "David Ferguson, CyberSponse"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0039",
                    "external_id": "S0039",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Microsoft Net Utility",
                    "description": "Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015.",
                    "url": "https://msdn.microsoft.com/en-us/library/aa939914"
                },
                {
                    "url": "http://windowsitpro.com/windows/netexe-reference",
                    "description": "Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.",
                    "source_name": "Savill 1999"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "netstat",
            "x_mitre_aliases": [
                "netstat",
                "netstat.exe"
            ],
            "x_mitre_version": "1.0",
            "modified": "2018-10-17T00:14:20.652Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_platforms": [
                "Windows",
                "Linux",
                "macOS"
            ],
            "id": "tool--4664b683-f578-434f-919b-1c1aad2a1111",
            "description": "[netstat](https://attack.mitre.org/software/S0104) is an operating system utility that displays active TCP connections, listening ports, and network statistics. (Citation: TechNet Netstat)",
            "labels": [
                "tool"
            ],
            "created": "2017-05-31T21:33:04.545Z",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0104",
                    "external_id": "S0104",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/bb490947.aspx",
                    "description": "Microsoft. (n.d.). Netstat. Retrieved April 17, 2016.",
                    "source_name": "TechNet Netstat"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "OopsIE",
            "x_mitre_aliases": [
                "OopsIE"
            ],
            "x_mitre_version": "1.2",
            "modified": "2020-03-30T02:36:44.945Z",
            "created": "2018-10-17T00:14:20.652Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--8e101fdd-9f7f-4916-bb04-6bd9e94c129c",
            "description": "[OopsIE](https://attack.mitre.org/software/S0264) is a Trojan used by [OilRig](https://attack.mitre.org/groups/G0049) to remotely execute commands as well as upload/download files to/from victims. (Citation: Unit 42 OopsIE! Feb 2018)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0264",
                    "external_id": "S0264",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Unit 42 OopsIE! Feb 2018) (Citation: Unit 42 OilRig Sept 2018)",
                    "source_name": "OopsIE"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/02/unit42-oopsie-oilrig-uses-threedollars-deliver-new-trojan/",
                    "description": "Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.",
                    "source_name": "Unit 42 OopsIE! Feb 2018"
                },
                {
                    "url": "https://researchcenter.paloaltonetworks.com/2018/09/unit42-oilrig-targets-middle-eastern-government-adds-evasion-techniques-oopsie/",
                    "description": "Falcone, R., et al. (2018, September 04). OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE. Retrieved September 24, 2018.",
                    "source_name": "Unit 42 OilRig Sept 2018"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "POWRUNER",
            "x_mitre_aliases": [
                "POWRUNER"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-07-06T16:11:56.562Z",
            "created": "2018-01-16T16:13:52.465Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--09b2cd76-c674-47cc-9f57-d2f2ad150a46",
            "description": "[POWRUNER](https://attack.mitre.org/software/S0184) is a PowerShell script that sends and receives commands to and from the C2 server. (Citation: FireEye APT34 Dec 2017)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0184",
                    "external_id": "S0184",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: FireEye APT34 Dec 2017)",
                    "source_name": "POWRUNER"
                },
                {
                    "source_name": "FireEye APT34 Dec 2017",
                    "description": "Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.",
                    "url": "https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "PsExec",
            "x_mitre_aliases": [
                "PsExec"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-06-24T13:47:24.660Z",
            "created": "2017-05-31T21:32:21.771Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db",
            "description": "[PsExec](https://attack.mitre.org/software/S0029) is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers. (Citation: Russinovich Sysinternals) (Citation: SANS PsExec)",
            "x_mitre_contributors": [
                "Janantha Marasinghe"
            ],
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0029",
                    "external_id": "S0029",
                    "source_name": "mitre-attack"
                },
                {
                    "source_name": "Russinovich Sysinternals",
                    "description": "Russinovich, M. (2014, May 2). Windows Sysinternals PsExec v2.11. Retrieved May 13, 2015.",
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx"
                },
                {
                    "source_name": "SANS PsExec",
                    "description": "Pilkington, M.. (2012, December 17). Protecting Privileged Domain Accounts: PsExec Deep-Dive. Retrieved August 17, 2016.",
                    "url": "https://digital-forensics.sans.org/blog/2012/12/17/protecting-privileged-domain-accounts-psexec-deep-dive"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "QUADAGENT",
            "x_mitre_aliases": [
                "QUADAGENT"
            ],
            "x_mitre_version": "1.1",
            "modified": "2020-03-28T21:38:43.793Z",
            "created": "2018-10-17T00:14:20.652Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--7e6c2a9d-9dc1-4eb0-b27c-91e8076a9d77",
            "description": "[QUADAGENT](https://attack.mitre.org/software/S0269) is a PowerShell backdoor used by [OilRig](https://attack.mitre.org/groups/G0049). (Citation: Unit 42 QUADAGENT July 2018)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0269",
                    "external_id": "S0269",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Unit 42 QUADAGENT July 2018)",
                    "source_name": "QUADAGENT"
                },
                {
                    "source_name": "Unit 42 QUADAGENT July 2018",
                    "description": "Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-oilrig-targets-technology-service-provider-government-agency-quadagent/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "RDAT",
            "x_mitre_aliases": [
                "RDAT",
                "RDAT "
            ],
            "x_mitre_version": "1.0",
            "modified": "2020-10-15T23:59:45.815Z",
            "created": "2020-07-28T17:26:36.168Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--4b346d12-7f91-48d2-8f06-b26ffa0d825b",
            "description": "[RDAT](https://attack.mitre.org/software/S0495) is a backdoor used by the suspected Iranian threat group [OilRig](https://attack.mitre.org/groups/G0049). [RDAT](https://attack.mitre.org/software/S0495) was originally identified in 2017 and targeted companies in the telecommunications sector.(Citation: Unit42 RDAT July 2020)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0495",
                    "external_id": "S0495",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://unit42.paloaltonetworks.com/oilrig-novel-c2-channel-steganography/",
                    "description": "Falcone, R. (2020, July 22). OilRig Targets Middle Eastern Telecommunications Organization and Adds Novel C2 Channel with Steganography to Its Inventory. Retrieved July 28, 2020.",
                    "source_name": "Unit42 RDAT July 2020"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Reg",
            "x_mitre_aliases": [
                "Reg",
                "reg.exe"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-08-23T20:25:18.606Z",
            "created": "2017-05-31T21:32:49.000Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f",
            "description": "[Reg](https://attack.mitre.org/software/S0075) is a Windows utility used to interact with the Windows Registry. It can be used at the command-line interface to query, add, modify, and remove information. (Citation: Microsoft Reg)\n\nUtilities such as [Reg](https://attack.mitre.org/software/S0075) are known to be used by persistent threats. (Citation: Windows Commands JPCERT)",
            "labels": [
                "tool"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0075",
                    "external_id": "S0075",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx",
                    "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.",
                    "source_name": "Microsoft Reg"
                },
                {
                    "source_name": "Windows Commands JPCERT",
                    "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.",
                    "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "RGDoor",
            "x_mitre_aliases": [
                "RGDoor"
            ],
            "x_mitre_version": "1.2",
            "modified": "2021-09-10T18:59:39.228Z",
            "created": "2018-10-17T00:14:20.652Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--b9eec47e-98f4-4b3c-b574-3fa8a87ebe05",
            "description": "[RGDoor](https://attack.mitre.org/software/S0258) is a malicious Internet Information Services (IIS) backdoor developed in the C++ language. [RGDoor](https://attack.mitre.org/software/S0258) has been seen deployed on webservers belonging to the Middle East government organizations. [RGDoor](https://attack.mitre.org/software/S0258) provides backdoor access to compromised IIS servers. (Citation: Unit 42 RGDoor Jan 2018)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0258",
                    "external_id": "S0258",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: Unit 42 RGDoor Jan 2018)",
                    "source_name": "RGDoor"
                },
                {
                    "source_name": "Unit 42 RGDoor Jan 2018",
                    "description": "Falcone, R. (2018, January 25). OilRig uses RGDoor IIS Backdoor on Targets in the Middle East. Retrieved July 6, 2018.",
                    "url": "https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "SEASHARPEE",
            "x_mitre_aliases": [
                "SEASHARPEE"
            ],
            "x_mitre_version": "2.0",
            "modified": "2021-04-23T20:29:59.216Z",
            "created": "2018-01-16T16:13:52.465Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--0998045d-f96e-4284-95ce-3c8219707486",
            "description": "[SEASHARPEE](https://attack.mitre.org/software/S0185) is a Web shell that has been used by [OilRig](https://attack.mitre.org/groups/G0049). (Citation: FireEye APT34 Webinar Dec 2017)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0185",
                    "external_id": "S0185",
                    "source_name": "mitre-attack"
                },
                {
                    "description": "(Citation: FireEye APT34 Webinar Dec 2017)",
                    "source_name": "SEASHARPEE"
                },
                {
                    "source_name": "FireEye APT34 Webinar Dec 2017",
                    "description": "Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.",
                    "url": "https://www.brighttalk.com/webcast/10703/296317/apt34-new-targeted-attack-in-the-middle-east"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "malware",
            "name": "SideTwist",
            "x_mitre_aliases": [
                "SideTwist"
            ],
            "x_mitre_version": "1.0",
            "modified": "2021-10-13T13:53:26.301Z",
            "created": "2021-05-06T14:44:50.494Z",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "malware--df4cd566-ff2f-4d08-976d-8c86e95782de",
            "description": "[SideTwist](https://attack.mitre.org/software/S0610) is a C-based backdoor that has been used by [OilRig](https://attack.mitre.org/groups/G0049) since at least 2021.(Citation: Check Point APT34 April 2021)",
            "labels": [
                "malware"
            ],
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0610",
                    "external_id": "S0610",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://research.checkpoint.com/2021/irans-apt34-returns-with-an-updated-arsenal/",
                    "description": "Check Point. (2021, April 8). Iran\u2019s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.",
                    "source_name": "Check Point APT34 April 2021"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Systeminfo",
            "x_mitre_aliases": [
                "systeminfo.exe",
                "Systeminfo"
            ],
            "x_mitre_version": "1.0",
            "modified": "2018-10-17T00:14:20.652Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--7fcbc4e8-1989-441f-9ac5-e7b6ff5806f1",
            "description": "[Systeminfo](https://attack.mitre.org/software/S0096) is a Windows utility that can be used to gather detailed information about a computer. (Citation: TechNet Systeminfo)",
            "labels": [
                "tool"
            ],
            "created": "2017-05-31T21:33:00.969Z",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0096",
                    "external_id": "S0096",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/bb491007.aspx",
                    "description": "Microsoft. (n.d.). Systeminfo. Retrieved April 8, 2016.",
                    "source_name": "TechNet Systeminfo"
                }
            ]
        },
        {
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ],
            "type": "tool",
            "name": "Tasklist",
            "x_mitre_aliases": [
                "Tasklist"
            ],
            "x_mitre_version": "1.0",
            "modified": "2018-10-17T00:14:20.652Z",
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5",
            "x_mitre_platforms": [
                "Windows"
            ],
            "id": "tool--2e45723a-31da-4a7e-aaa6-e01998a6788f",
            "description": "The [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)",
            "labels": [
                "tool"
            ],
            "created": "2017-05-31T21:32:39.233Z",
            "external_references": [
                {
                    "url": "https://attack.mitre.org/software/S0057",
                    "external_id": "S0057",
                    "source_name": "mitre-attack"
                },
                {
                    "url": "https://technet.microsoft.com/en-us/library/bb491010.aspx",
                    "description": "Microsoft. (n.d.). Tasklist. Retrieved December 23, 2015.",
                    "source_name": "Microsoft Tasklist"
                }
            ]
        },
        {
            "type": "relationship",
            "id": "relationship--99f74d30-56f8-4a16-bf60-8a8ce0c1dc3a",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "originates-from",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--036a483f-27e7-48f0-9e75-b44f99c3c531"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--036a483f-27e7-48f0-9e75-b44f99c3c531",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Iran",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.298321Z",
            "id": "identity--4f5ed6f0-39b9-4079-918d-ad9294735a22",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Aerospace sector as a target",
            "sectors": [
                "aerospace"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.300517Z",
            "id": "identity--0ead7b25-814f-41b3-8c19-4f5194d3b165",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Chemical sector as a target",
            "sectors": [
                "chemical"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.305825Z",
            "id": "identity--4f4306a6-c059-4518-a5df-9e71a2ac31d7",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Education sector as a target",
            "sectors": [
                "education"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.306875Z",
            "id": "identity--9d06c6e7-4bb2-4a40-afce-3a51847ba128",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Energy sector as a target",
            "sectors": [
                "energy"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.308954Z",
            "id": "identity--944ebdb0-97ef-463b-a3a9-52da871fcf64",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Financial Services sector as a target",
            "sectors": [
                "financial-services"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.309978Z",
            "id": "identity--7119e085-8c5a-4153-bb5c-10c9eb919305",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Government sector as a target",
            "sectors": [
                "government"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.329303Z",
            "id": "identity--71c4726c-f45e-4e22-8616-2081a536c6bc",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Technology sector as a target",
            "sectors": [
                "technology"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.317437Z",
            "id": "identity--03e23f6c-0ac9-4b47-9c84-f718132adb21",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Hospitality Leisure sector as a target",
            "sectors": [
                "hospitality-leisure"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.302614Z",
            "id": "identity--dcf3b77d-e949-4afe-b620-613a230aafdf",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Oil sector as a target",
            "sectors": [
                "Oil industries"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.330327Z",
            "id": "identity--ef1f53f1-ec2b-4c2e-bcac-d1f70b1e89be",
            "identity_class": "class",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Telecommunications sector as a target",
            "sectors": [
                "telecommunications"
            ],
            "spec_version": "2.1",
            "type": "identity"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--78fd28bb-43cd-489a-aebe-f9eb0da326a3",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Israel",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--7f50592d-cbdf-48a5-8bc2-ca1d29ea821c",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Kuwait",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--0af20877-77ce-4f6f-b002-960316463df9",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Lebanon",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--b9235e9d-2ab7-44e4-9f80-5f31f0f5abd0",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Pakistan",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--2b189dac-f6f5-4b88-8492-838141db0e75",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Qatar",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--b00d9eeb-8a49-4a56-b431-20de2eace60d",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Saudi Arabia",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--e35fe4ea-44ba-4663-8639-1ebe3207524d",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "Turkey",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--c182377c-3b51-40c9-8b83-2f8d5bdb4b37",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "UAE",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--8b9cdfae-67fb-4939-85b3-956bb48c3851",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "United States",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "created": "2021-03-13T20:09:21.204979Z",
            "id": "location--4a392c29-881a-4d82-84f7-5341acc18ee6",
            "modified": "2021-12-01T16:19:51.601791Z",
            "name": "United Kingdom",
            "spec_version": "2.1",
            "type": "location"
        },
        {
            "type": "relationship",
            "id": "relationship--cd1115b2-2dc7-44de-a1c2-69f2be572fdf",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--4a392c29-881a-4d82-84f7-5341acc18ee6"
        },
        {
            "type": "relationship",
            "id": "relationship--331c4d4d-6c90-4c1f-bf5f-e61d6bdaa525",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--78fd28bb-43cd-489a-aebe-f9eb0da326a3"
        },
        {
            "type": "relationship",
            "id": "relationship--d9850505-8b63-4b07-8fcd-fa50b90702eb",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--7f50592d-cbdf-48a5-8bc2-ca1d29ea821c"
        },
        {
            "type": "relationship",
            "id": "relationship--2eb47d76-cd3c-43a9-b2a1-cb63a63b809c",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--0af20877-77ce-4f6f-b002-960316463df9"
        },
        {
            "type": "relationship",
            "id": "relationship--b2ded61b-14cc-4ce3-9a3e-c81b91c15264",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--b9235e9d-2ab7-44e4-9f80-5f31f0f5abd0"
        },
        {
            "type": "relationship",
            "id": "relationship--ab63768c-a6a9-4ebe-8289-87b688a74952",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--2b189dac-f6f5-4b88-8492-838141db0e75"
        },
        {
            "type": "relationship",
            "id": "relationship--b4b6c0de-313e-4225-b542-1f361594fd8b",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--b00d9eeb-8a49-4a56-b431-20de2eace60d"
        },
        {
            "type": "relationship",
            "id": "relationship--32f25228-ad7f-4671-9d0e-2b8ba85e7037",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--e35fe4ea-44ba-4663-8639-1ebe3207524d"
        },
        {
            "type": "relationship",
            "id": "relationship--f9bcf1a8-34ee-4a72-b750-1820e30032d7",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--c182377c-3b51-40c9-8b83-2f8d5bdb4b37"
        },
        {
            "type": "relationship",
            "id": "relationship--ca7275de-958c-4552-ba37-f6d9187b99dc",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--8b9cdfae-67fb-4939-85b3-956bb48c3851"
        },
        {
            "type": "relationship",
            "id": "relationship--a7ad0d9a-8fe0-417d-bc9c-fc480e0d274a",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--4f5ed6f0-39b9-4079-918d-ad9294735a22"
        },
        {
            "type": "relationship",
            "id": "relationship--3cd48035-ef3f-4c83-a2ba-179ef19196c8",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--0ead7b25-814f-41b3-8c19-4f5194d3b165"
        },
        {
            "type": "relationship",
            "id": "relationship--bdc497c8-65e6-4bcb-b0f2-492c57b5dcaa",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--4f4306a6-c059-4518-a5df-9e71a2ac31d7"
        },
        {
            "type": "relationship",
            "id": "relationship--d13c418f-ceb2-4e0f-ad73-cf806cacdacf",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--9d06c6e7-4bb2-4a40-afce-3a51847ba128"
        },
        {
            "type": "relationship",
            "id": "relationship--6306ee6b-afc9-4544-b190-605d8aed63dd",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--944ebdb0-97ef-463b-a3a9-52da871fcf64"
        },
        {
            "type": "relationship",
            "id": "relationship--d8de5bf9-a3a1-4f42-8c60-71589b730aec",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--7119e085-8c5a-4153-bb5c-10c9eb919305"
        },
        {
            "type": "relationship",
            "id": "relationship--d7fc9a0f-e940-49d8-bbc1-b04021b433a9",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--71c4726c-f45e-4e22-8616-2081a536c6bc"
        },
        {
            "type": "relationship",
            "id": "relationship--6fb5bda8-fd45-4a0f-bd85-91c0fda04c5d",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--03e23f6c-0ac9-4b47-9c84-f718132adb21"
        },
        {
            "type": "relationship",
            "id": "relationship--9f8d7bb2-9ade-4e3f-86e5-7f1fc84305f8",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--dcf3b77d-e949-4afe-b620-613a230aafdf"
        },
        {
            "type": "relationship",
            "id": "relationship--1410d240-d29c-477f-9d57-99a9b0cf2c33",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "identity--ef1f53f1-ec2b-4c2e-bcac-d1f70b1e89be"
        },
        {
            "type": "relationship",
            "id": "relationship--fdb76d15-4cbf-4ffb-b727-10e5dc7b60a7",
            "created": "2022-04-17T22:00:30.408Z",
            "modified": "2022-06-14T22:00:30.408Z",
            "relationship_type": "target",
            "source_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d",
            "target_ref": "location--6716cd01-ac92-4e5a-bf06-8ab1fdb9695a"
        }                                                                                      
        ,   {
           "created": "2021-03-13T20:09:21.204979Z",
           "id": "location--6716cd01-ac92-4e5a-bf06-8ab1fdb9695a",
           "modified": "2021-12-01T16:19:51.601791Z",
           "name": "Azerbaijan",
           "spec_version": "2.1",
           "type": "location"
       }
    ]
}